HOT KNIVES THROUGH BUTTER: Evading File-based Sandboxes As much as sandboxes try to mimic the physical computers they are protecting , these virtual environments are configured to a defined set of parameters .		others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others
Cyber attackers , aware of these configurations , have learned to sidestep them .		others others others others others others others others others others others others others others
With a multitude of file samples to examine , file-based sandboxes typically monitor files for a few minutes and , in the absence of any suspicious behavior , move on to the next file .		others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others
That provides malware makers a simple evasion strategy : wait out the sandbox .		others others others others others others others others others others others others others others
By adding extended sleep calls , the malware refrains from any suspicious behavior throughout the monitoring process .		others others others others others others others others others others others others others others others others others others
Trojan Nap , uncovered in February 2013,8 takes this approach .		vulnerability_cve vulnerability_cve others others others time others others others others others
The trojan is tied to the Kelihos Botnet , which Microsoft and Kaspersky had declared dismantled in 2011 .		others vulnerability_cve others others others others malware malware others others company others company others counter_measure counter_measure others others others
File-based sandboxes spot suspicious malware activity by monitoring all of the processes occurring in the operating system .		others threatActor_name others others others others others others others others others others others others others others others others
Many sandboxes are configured to do this using a Microsoft-provided kernel routine called PsSetCreateProcessNotifyRoutine .		others threatActor_name others others others others others others others others others others others tool others