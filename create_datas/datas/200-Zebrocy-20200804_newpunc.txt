Zebrocy’s Multilanguage Malware Salad .		threatActor_name others others others others others others
Rlease_Time : 2019-06-03 .		others others others others
Report_URL : https://securelist.com/zebrocys-multilanguage-malware-salad/90680/ .		others others others others others others
Zebrocy is Russian speaking APT that presents a strange set of stripes .		threatActor_name others others others others others others others others others others others others
To keep things simple , there are three things to know about Zebrocy .		others others others others others others others others others others others others threatActor_name others
Zebrocy is an active sub-group of victim profiling and access specialists .		threatActor_name others others others others others others others others others others others
Zebrocy maintains a lineage back through 2013 , sharing malware artefacts and similarities with BlackEnergy .		threatActor_name others others others others others time others others others others others others others malware others
The past five years of Zebrocy infrastructure , malware set , and targeting have similarities and overlaps with both the Sofacy and BE .		others others others others others threatActor_name others others others others others others others others others others others others others others threatActor_name others malware others
Zebrocy shares data points and crosses lines with other clusters of activity in unique and unexpected ways .		threatActor_name sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others
Zebrocy initially shared limited infrastructure , targets , and interests with Sofacy .		threatActor_name others others others others others others others others others others threatActor_name others
Zebrocy also shared malware code with past BlackEnergy/Sandworm ; and targeting , and later very limited infrastructure with more recent BlackEnergy/GreyEnergy .		threatActor_name others others others others others others others others others others others others others others others others others others others others others
Turla deployed spearphish macros almost identical to previous , non-public Zebrocy code in 2018 .		threatActor_name others others others others others others others others others threatActor_name others others time others
It ’s fantastic to see some of these same points being repeated publicly by other research teams .		others others others others others others others others others others others others others others others others others others others
A previous claim that Zebrocy distributed Sofacy ’s XAgent as a second stage implant remains unsubstantiated but now is replaced with findings identical to these following the SAS2019 presentation , so it seems we are all slowly getting on the same page .		others others others others threatActor_name others threatActor_name others others malware others others others others others others others others others others others others others others others others others others security_team others others others others others others others others others others others others others others others
When we originally documented a Zebrocy malware incident in late 2015 , we noted an Oct 2015 AutoIT downloader and a Delphi backdoor payload .		others others others others others threatActor_name others others others others time others others others others time time others others others others others others others others
Since then , we have noted a virtual salad of Zebrocy code tossed together , built with a handful of languages , often ripped from various code sharing sites .		others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others
Zebrocy activity initiates with spearphishing operations delivering various target profilers and downloaders without the use of any 0day exploits .		threatActor_name others others others others others others others others others others others others others others others others others others others
Browser credential theft , keylogging , and Windows credential theft , along with some incidents of file and communications theft , are all on the list of Zebrocy second stage implant specials .		others others others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others others others others
This Zebrocy dish is served before the main course – gaining and maintaining access is not an easy job .		others threatActor_name others others others others others others others others others others others others others others others others others others
And , because the group seems to maintain lineage in both the 0day capable and destructive BlackEnergy/Sandworm APT and the prolific and 0day capable Sofacy APT , this course is very interesting .		others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others others others others others others others
Let ’s take a more intelligent perspective on the Zebrocy malware set and activity and its lineage , based on reporting provided to our .		others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others
Since the SAS2019 presentation , we have identified a new Zebrocy backdoor family , deployed with a new downloader .		others others others others others others others others others others threatActor_name others others others others others others others others others
So Zebrocy continues to expand its malware set .		others threatActor_name others others others others others others others
There appears to be both a return to C coding for the group , and also an expansion with the .		others others others others others others others others others others others others others others others others others others others others others
A set of Zebrocy related events best characterize years of the activity and help to carve out the group ’s own profile , its lineage , malware set , infrastructure , and modus operandi .		others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Zebrocy lineage – early Sofacy infrastructure overlap ( late 2015/early 2016 ) for the Zebrocy Delphi backdoor .		threatActor_name others others others threatActor_name others others others time others time others others others threatActor_name others others others
Zebrocy lineage – Delphocy Delphi deployment and abrupt conclusion ( 2013 – late 2015 ) , and start of Zebrocy Delphi timeline ( late 2015 ) .		threatActor_name others others others tool others others others others others time others time time others others others others others threatActor_name others others others others others others others
Zebrocy lineage – shared , unique kernel code between BlackEnergy and Delphocy bootkit ( 2013 – 2015 ) .		threatActor_name others others others others others others others others malware others others others others others others others others others
Zebrocy unique malware set – vintage Delphi programming coupled with unusual and agile development capabilities with new managed languages like Python , C# , and Go all perform screengrab anchor , volume serial number id , systeminfo and process list collection .		threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Zebrocy ongoing targeting and infrastructure overlap – fairly recent .		threatActor_name others others others others others others others others others
The full 2018 decline of SPLM/XAgent for the more traditional"Sofacy "activity .		others others others others others others others others others others others threatActor_name others others others
A coincidental new increase in Zebrocy activity .		others others others others others threatActor_name others others
Shared build-id format with BlackEnergy modules .		others others others others malware others others
An expansion in Zebrocy spearphishing .		others others others threatActor_name others others
An expansion in the managed languages the Zebrocy malware set is built on .		others others others others others others others malware others others others others others others
These predictions later turned into global events , as lighter targeting turned into a massive global surge of Zebrocy activity , sometimes sharing targets between both Sofacy and Zebrocy .		others others others others others others others others others others others others others others others others others others threatActor_name others others others others others others others threatActor_name others threatActor_name others
Also later that year , the Zebrocy malware set expanded with C# , Python , and Go .		others others others others others others threatActor_name others others others others others others others others others others others others
This wouldn’t be the first or last time we reported on this group ’s innovative malware set .		others others others others others others others others others others others others others others others others others others others others others
The limited set of 2013-2015 Delphocy intrusions in Ukraine and Poland deployed a Delphi backdoor both with and without a bootkit loader .		others others others others time others others others others others others others others others others others others others others others others others others
This bootkit loader included a routine that shares the same compiled code with only the BlackEnergy kernel loaders , helping to tie Zebrocy malware to the BlackEnergy malware set .		others others others others others others others others others others others others others others others malware others others others others others others threatActor_name others others others malware others others others
This unique encryption implementation was shared between BlackEnergy ’s kernel loader , and Delphocy ’s bootkit kernel loader code .		others others others others others others others malware others others others others others others others others others others others others others others
The appearance of this code overlap coincides with several project events :  End of Delphocy/BlackEnergy overlapped code use , while BlackEnergy moved forward with other code  End of Delphocy ’s user-mode Delphi payload ( October 2015 )  Start of Zebrocy ’s Delphi payload ( October 2015 ) .		others others others others others others others others others others others others others others others others others others others others malware others others others others others others others others others others others others others others time time others others others threatActor_name others others others others others time time others others
A particular chunk of kernel mode code for a custom encryption routine was shared across the older Delphocy bookit and the BlackEnergy malware platform in 2013 .		others others others others others others others others others others others others others others others others others others others others others malware others others others others others
While Delphocy replaced this bootkit with a simplified user-mode persistence technique , BlackEnergy malware continued using this code until late 2015 .		others others others others others others others others others others others others malware others others others others others others others time others
Then , these APTs discontinued both the Delphi-based Delphocy project and the use of this mysterious chunk of code within BlackEnergy malware .		others others others others others others others others others others others others others others others others others others others others malware others others
Almost immediately , Delphi-based Zebrocy backdoors began to be deployed .		others others others others threatActor_name others others others others others others
Several months later , a Zebrocy backdoor connected back to a domain that was registered by a particular email address .		others others others others others threatActor_name others others others others others others others others others others others others others others others
This address had been used to register another Sofacy domain hosted on a well-known Sofacy IP at the time ( rammatica.com/raveston.com ) .		others others others others others others others others threatActor_name others others others others others threatActor_name others others others others others others others others
Note that both Delphocy 's and BlackEnergy 's kernel mode code appropriated unique content in 2013 from the Carberp codebase – hashing,injection,bootkit functionality .		others others others others others others malware others others others others others others others others time others others others others others others others others others others others others
Surprisingly , this same unique encryption cipher was seen pasted again into 2018 VPNFilter code as well .		others others others others others others others others others others others others time others others others others others
Clearly it happens with other malware , but Zebrocy ’s consistent copy/paste tendency is something not frequently seen in other APT malware with a“ best use ”date spanning five years or more .		others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others
Portions of its AutoIT code were copied from code sharing forums and pasted into their own code .		others others others others others others others others others others others others others others others others others others
This is different from Sofacy 's disappeared and exhaustive SPLM/XAgent codebase .		others others others others threatActor_name others others others others others others others
It was used for at least six years and was entirely custom-built .		others others others others others others others others others others others others others
The Zebrocy malware set is tossed together from a wide set of languages and technologies , including both legitimate and malicious code shared on online forums and sites like Github and Pastebin .		others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This repeated “ copy/paste ” practice is not frequently seen in Russian speaking APT malware sets .		others others others others others others others others others others others others others others others others others
Zebrocy pushed a C# backdoor that maintains much the same functionality as its other assortment of backdoor implementations .		threatActor_name others others others others others others others others others others others others others others others others others others others
Most interesting in this implementation is its consistent collection of screengrab and system information , and a list of running processes .		others others others others others others others others others others others others others others others others others others others others others others
Again , with this first stage backdoor , it is profiling its targets and looking for unexpected sources of credential collection to develop bespoke second stage credential harvesters against .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
These findings were particularly interesting in the light of past claims about SPLM/XAgent being the second stage of choice for Zebrocy , for which there was a lot of monitoring on our part , but never any data support .		others others others others others others others others others others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others
Some guesses were made about why that was , perhaps Zebrocy downloaders were all mitigated prior to attempting to download further stages ?		others others others others others others others others others others threatActor_name others others others others others others others others others others others others
But never any answers .		others others others others others
Instead , we arrived at the answers ourselves .		others others others others others others others others others
In order to account for unexpected software installations at victim systems , no matter which language , each first stage backdoor implementation collects a “ system information ” listing , screengrab , and enumerates running processes .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This malware behavior was included in Zebrocy backdoors from the very first backdoor that we reported on , and continued into 2019 with the latest rounds of Go backdoors .		others others others others others others threatActor_name others others others others others others others others others others others others others others time others others others others others others others others
After collected information is POSTed to the C2 , a long delay ensues .		others others others others others others others others others others others others others others
Eventually , target systems may receive a custom built second stage implant to retrieve credentials from those unexpected software sources .		others others others others others others others others others others others others others others others others others others others others others
More unusual software packages included little-known customized Chromium builds like CentBrowser and 7Star from Asian studios .		others others others others others others others others others others others others others others others others others
In some cases , malware password stealers are deployed to address more common software .		others others others others others others others others others others others others others others others
Zebrocy version 2.2 called back to a domain sharing Whois and hosting resources with Sofacy in early 2016 , and later versions used naming and URL constructs very similar to BlackEnergy resources .		threatActor_name others others others others others others others others others others others others others threatActor_name others time time others others others others others others others others others others others others malware others others
And since then , just like BlackEnergy , mostly all of the Zebrocy C2 used no domain registrations .		others others others others others others malware others others others others others threatActor_name others others others others others others
Communications directly to the host over IPv4 with no domain resolution are common behavior for the group ’s malware .		others others others others others others others others others others others others others others others others others others others others others
However , every now and then , Zebrocy malware calls back to servers located by hardcoded domain names .		others others others others others others others threatActor_name others others others others others others others others others others others
Its ongoing activity demonstrates a long game commitment to gaining access to targeted networks .		others others others others others others others others others others others others others others others
And as we predicted at SAS2018 and SAS2019 , this latest new Nim coding adds to the growing list of languages for this malware set .		others others others others others security_team others security_team others others others others others others others others others others others others others others others others others others
We will see more from Zebrocy into 2019 on government and military related organizations .		others others others others others threatActor_name others time others others others others others others others