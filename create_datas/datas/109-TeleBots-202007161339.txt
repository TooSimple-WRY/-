TeleBots are back : Supply‑chain attacks against Ukraine .		threatActor_name others others others others others others location others
Release_time : 2017-06-30 Report_URL : https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/ The latest Petya-like outbreak has gathered a lot of attention from the media .		others others others others others others others others others others others others others others others others others others others others others others
However , it should be noted that this was not an isolated incident : this is the latest in a series of similar attacks in Ukraine .		others others others others others others others others others others others others others others others others others others others others others others others others others location others
This blogpost reveals many details about the Diskcoder.C ( aka ExPetr , PetrWrap , Petya , or NotPetya ) outbreak and related information about previously unpublished attacks .		others others others others others others others malware others others malware others malware others malware others others malware others others others others others others others others others others
In December 2016 we published two detailed blogposts about disruptive attacks conducted by the group ESET researchers call TeleBots , specifically about attacks against financial institutions and a Linux version of the KillDisk malware used by this group .		others time time others others others others others others others others others others others others company person others threatActor_name others others others others others industry industry others others OS_name others others others malware others others others others reference_word others
The group mounted cyberattacks against various computer systems in Ukraine ; systems that can be defined as critical infrastructure .		others reference_word others others others others OS_name OS_name others location others others others others others others others OS_name OS_name others
Moreover , this group has connections with the infamous BlackEnergy group that was responsible for the December 2015 power outages in Ukraine .		others others others reference_word others others others others others malware others others others others others others time time attack_activity attack_activity others location others
In the final stage of its attacks , the TeleBots group always used the KillDisk malware to overwrite files with specific file extensions on the victims ’ disks .		others others others others others others others others others threatActor_name others others others others malware others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Putting the cart before the horse : collecting ransom money was never the top priority for the TeleBots group .		others others others others others others others others others others others others others others others others others threatActor_name others others
The KillDisk malware used in the first wave of December 2016 attacks , instead of encrypting , simply overwrites targeted files .		others malware others others others others others others others time time others others others others others others others attack_activity attack_activity attack_activity others
Further , it did not provide contact information for communicating with the attacker ; it just displayed an image from the Mr .		others others others others others others others others others others others others others others others others others others others others others others others
Robot TV show .		others others others others
In the second wave of attacks , the cybersaboteurs behind the KillDisk malware added contact information to the malware , so it would look like a typical ransomware attack .		others others others others others others others others person others others malware others others others others others others others others others others others others others others others others others others
However , the attackers asked for an extraordinary number of bitcoins : 222 BTC ( about $250,000 at that time ) .		others others others reference_word others others others others others others others others others string others others others others others others others others others
This might indicate that they were not interested in bitcoins , but their actual aim was to cause damage to attacked companies .		others others others others others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal others
In 2017 , the TeleBots group didn’t stop their cyberattacks ; in fact , they became more sophisticated .		others time others others threatActor_name others others others others others others others others others others others others others others others others
In the period between January and March 2017 the TeleBots attackers compromised a software company in Ukraine ( not related to M.E.Doc ) , and , using VPN tunnels from there , gained access to the internal networks of several financial institutions .		others others others others time time time time others threatActor_name others others others company company others location others others others others company others others others others others tool tool others others others others others others others others others others others industry industry others
During that attack , those behind TeleBots enhanced their arsenal with two pieces of ransomware and updated versions of tools mentioned in the previously-linked blogposts .		others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others
The first backdoor that the TeleBots group relied heavily on was Python/TeleBot.A , which was rewritten from Python in the Rust programming language .		others others malware others others threatActor_name others others others others others program_language others others others others others program_language others others program_language others others others
The functionality remains the same : it is a standard backdoor that uses the Telegram Bot API in order to receive commands from , and send responses to , the malware operator .		others others others others others others others others others others malware others others others malware malware malware others others others others others others others others others others others others others others others others
The second backdoor , which was written in VBS and packaged using the script2exe program , was heavily obfuscated but the functionality remained the same as in previous attacks .		others others malware others others others others others program_language others others others others program_language others others others others others others others others others others others others others others others others
This time the VBS backdoor used the C&C server at 130.185.250.171 .		others others others program_language malware others others protocol protocol protocol others others IP_evil others
To make connections less suspicious for those who check firewall logs , the attackers registered the domain transfinance.com.ua and hosted it on that IP address .		others others others others others others others others others others others others others others others others others domain_evil others others others others others others others others
In addition , the attacker used the following tools : CredRaptor ( password stealer ) , Plainpwd ( modified Mimikatz used for recovering Windows credentials from memory ) , SysInternals ’ PsExec ( used for lateral movement ) .		others others others others reference_word others others others others others tool others others others others others tool others others others others others others others others others others others others tool tool tool others others others others others others others
As mentioned above , in the final stage of their attacks , the TeleBots attackers pushed ransomware using stolen Windows credentials and SysInternals ’ PsExec .		others others others others others others others others others others others others others threatActor_name others others others others tool tool tool others tool tool tool others
This new ransomware was detected by ESET products as Win32/Filecoder.NKH .		others others others others others others company others others malware others
Once executed , this ransomware encrypts all files ( except files located in the C:\Windows directory ) using AES-128 and RSA-1024 algorithms .		others others others others reference_word others others attack_goal others others others others others others others others others others others others encryption_algo others encryption_algo others others
The malware adds the .xcrypted file extension to already-encrypted files .		others reference_word sub_activity sub_activity sample_name sub_activity sub_activity sub_activity sub_activity sub_activity others
When encryption is done , this filecoder malware creates a text file !readme.txt with the following content :  Please contact us : openy0urm1nd@protonmail.ch In addition to Windows malware , the TeleBots group used Linux ransomware on non-Windows servers .		others others others others others others malware malware sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others email_evil email_evil email_evil others others others others others others others threatActor_name others others OS_name others others others others others
This ransomware is detected by ESET products as Python/Filecoder.R and , predictably , it is written in the Python programming language .		others others others others others company others others malware others others others others others others others others others program_language others others others
This time attackers execute third-party utilities such as openssl in order to encrypt files .		others others reference_word others others others others others others others others others others others others
The encryption is done using the RSA-2048 and AES-256 algorithms .		others others others others others others encryption_algo others encryption_algo others others
In the code of Python script , attackers left their comment which had following text :  feedback : openy0urm1nd@protonmail.ch .		others others others others others others others others others others others others others others others others others others email_evil email_evil email_evil others
On 18 May 2017 , we noticed new activity on the part of another ransomware family Win32/Filecoder.AESNI.C ( also referred to as XData ) .		others time time time others others others others others others others others others others others others malware others others others others others reference_word others others
This ransomware was spread mostly in Ukraine , because of an interesting initial vector .		others others others others others others location others others others others others others others others
According to our LiveGrid® telemetry , the malware was created right after execution of the M.E.Doc software that is widely used by accounting personnel in Ukraine .		others others others others others others others others others others others others others others others company others others others others others others others others others location others
The Win32/Filecoder.AESNI.C ransomware had a spreading mechanism that allowed it to perform lateral movement automatically , inside a compromised company LAN .		others malware others others others others others others others others others others others others others others others others others others others others
Specifically , the malware had an embedded Mimikatz DLL that it used to extract Windows account credentials from the memory of a compromised PC .		others others others reference_word others others others tool tool others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
With these credentials , the malware started to spread inside its host network using SysInternals ’ PsExec utility .		others others others others others others others others others others others others others others tool tool tool others others
It seems that the attackers either did not reach their goal on that occasion , or it was the test before a more effective strike .		others others others others others others others others others others others others others others others others others others others others others others others others others others
The attackers posted master decryption keys on the BleepingComputer forum , along with the assertion that this was done because the original author claimed that the source was stolen and used in the Ukraine incident .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others location others others
ESET published a decryption tool for Win32/Filecoder.AESNI ransomware , and this event didn’t gain much media attention .		company counter_measure counter_measure counter_measure counter_measure others malware others others others others others others others others others others others others others
What did gain a lot of media attention , however , was the Petya-like outbreak of 27 June , 2017 , because it successfully compromised a lot of systems in critical infrastructure and other businesses in Ukraine , and further afield .		others others others others others others others others others others others others others others others others time time time time others others others others others others others others others others others others others others others others location others others others others others
The malware in this attack has the ability to replace the Master Boot Record ( MBR ) with its own malicious code .		others others others others others others others others others others others others others others others string others others others others others others others
This code was borrowed from Win32/Diskcoder.Petya ransomware .		others others others others others malware others others
That ’s why some other malware researchers have named this threat as ExPetr , PetrWrap , Petya , or NotPetya .		others others others others others others others others others others others others others reference_word others reference_word others reference_word others others reference_word others
However , unlike the original Petya ransomware , Diskcoder.C ’s authors modified the MBR code in such a way that recovery won’t be possible .		others others others others others malware others others malware others others others others others string others others others others others others others others others others others others others
Specifically , the attacker cannot provide a decryption key and the decryption key cannot be typed in the ransom screen , because the generated key contains non-acceptable characters .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Visually this MBR part of Diskcoder.C looks like a slightly modified version of Petya : at first it displays a message that impersonates CHKDSK , Microsoft ’s disk checking utility .		others others string others others malware others others others others others others others malware others others others others others others others others others tool others company others others others others others others
During the faux CHKDISK scan Diskcoder.C actually encrypts the data .		others others others tool others malware others others others others others
When encryption is complete , the MBR code displays the next message with payment instructions , but as noted before this information is useless .		others others others others others others string others others others others others others others others others others others others others others others others others others
The remainder of the code , other than the borrowed MBR , was implemented by the authors themselves .		others others others others others others others others others others string others others others others others others others others
This includes file encryption that can be used as a complement to the disk-encrypting MBR .		others others others others others others others others others others others others others others string others
For file encryption , the malware uses the AES-128 and RSA-2048 algorithms .		others others others others others others others others encryption_algo others encryption_algo others others
It should be noted that the authors made mistakes that make decryption of files less possible .		others others others others others others others others others others others others others others others others others
Specifically , the malware encrypts only the first 1MB of data and it does not write any header or footer , only raw encrypted data and does not rename encrypted files , so it ’s hard to say which files are encrypted and which are not .		others others others reference_word others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
In addition to that , files that are larger than 1MB after encryption do not contain padding , so there is no way to verify the key .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Interestingly , the list of target file extensions is not identical but is very similar to the file extensions list from the KillDisk malware used in the December 2016 attacks .		others others others others others others others others others others others others others others others others others others others others others others malware others others others others time time others others
Once the malware is executed it attempts to spread using the infamous EternalBlue exploit , leveraging the DoublePulsar kernel-mode backdoor .		others others reference_word others others others others others others others others others vulnerability_cve others others others others tool tool others others
Exactly the same method was used in the WannaCryptor.D ransomware .		others others others others others others others others malware others others
Diskcoder.C also adopted the method from the Win32/Filecoder.AESNI.C ( aka XData ) ransomware : it uses a lightweight version of Mimikatz to obtain credentials and then executes the malware using SysInternals ’ PsExec on other machines on the LAN .		malware others others others others others others malware others others reference_word others others others others others others others others others tool others others others others others others others others others tool tool tool others others others others others others others
In addition to that , the attackers implemented a third method of spreading using a WMI mechanism .		others others others others others others others others others others others others others others others others others others
All three of these methods have been used to spread malware inside LANs .		others others others others others others others others others others others others others others
Unlike the infamous WannaCryptor malware , the EternalBlue exploit is used by Diskcoder.C only against computers within the local network address space .		others others others malware others others others vulnerability_cve others others others others malware others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Why are there infections in other countries than Ukraine?		others others others others others others others others location others
Our investigation revealed that affected companies in other countries had VPN connections to their branches , or to business partners , in Ukraine .		others others others others others others others others others others string others others others others others others others others others others others location others
Both Diskcoder.C and Win32/Filecoder.AESNI.C used a supply-chain attack as the initial infection vector .		others malware others malware others tool tool tool others others others others others others
These malware families were spread using Ukrainian accounting software called M.E.Doc .		others others others others others others others others others others malware others
There are several options for how this attack can be implemented .		others others others others others others others others others others others others
The M.E.Doc has an internal messaging and document exchange system so attackers could send spearphishing messages to victims .		others company others others others others others others others others others reference_word others others attack_activity others others others others
User interaction is required in order to execute something malicious in this way .		others others others others others others others others others others others others others others
Thus , social engineering techniques would be involved .		others others others others others others others others others
Since Win32/Filecoder.AESNI.C didn’t spread so widely , we mistakenly assumed that these techniques were used in this case .		others malware others others others others others others others others others others others others others others others others others others others
However , the subsequent Diskcoder.C outbreak suggests that the attackers had access to the update server of the legitimate software .		others others others others malware others others others others others others others others others others others others others others others others
Using access to this server , attackers pushed a malicious update that was applied automatically without user interaction .		sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
That ’s why so many systems in Ukraine were affected by this attack .		others others others others others others others others location others others others others others others
However , it seems like the malware authors underestimated the spreading capabilities of Diskcoder.C .		others others others others others others others others others others others others others malware others
ESET researchers found evidence that supports this theory .		company others others others others others others others others
Specifically , we identified a malicious PHP backdoor that was deployed under medoc_online.php in one of the FTP directories on M.E.Doc ’s server .		others others others counter_measure counter_measure counter_measure tool counter_measure others others others others domain_evil others others others others protocol others others malware others others others others
This backdoor was accessible from HTTP ; however , it was encrypted , so the attacker would have to have the password in order to use it .		others others others others others protocol others others others others others others others others others others others others others others others others others others others others others others
We should say that there are signs that suggest that Diskcoder.C and Win32/Filecoder.AESNI.C were not the only malware families that were deployed using that infection vector .		others others others others others others others others others others malware others malware others others others others others others others others others others others others others others
We can speculate that these malicious updates were deployed in a stealthy way to computer networks that belong to high-value targets .		others others others others others others others others others others others others others others others others others others others others others others
One such malware that was deployed via this possible compromised M.E.Doc update server mechanism was the VBS backdoor used by the TeleBots group .		others others others others others others others others others others company others others others others others tool others others others others threatActor_name others others
This time the attacker again used a financially-themed domain name : bankstat.kiev.ua .		others others others others others others others others others others others domain_evil others
On the day of the Diskcoder.C outbreak , the A-record of this domain was changed to 10.0.0.1 The TeleBots group continues to evolve in order to conduct disruptive attacks against Ukraine .		others others others others others malware others others others others others others others others others others IP_evil others threatActor_name others others others others others others others others others others others location others
Instead of spearphishing emails with documents containing malicious macros , they used a more sophisticated scheme known as a supply-chain attack .		others others attack_activity attack_activity others others others others others others others others others others others others others others others others others others
Prior to the outbreak , the Telebots group targeted mainly the financial sector .		others others others others others others threatActor_name others others others others industry others others
The latest outbreak was directed against businesses in Ukraine , but they apparently underestimated the malware ’ spreading capabilities .		others others others others others others attack_goal attack_goal location others others others others others others others others others others others
That ’s why the malware went out of control .		others others others others others others others others others others others
TeleBots : Win32/TeleBot trojan .		threatActor_name others malware malware others
TeleBots : VBS/Agent.BB trojan .		threatActor_name others malware malware others
TeleBots : VBS/Agent.BD trojan .		threatActor_name others malware malware others
TeleBots : VBS/Agent.BE trojan .		threatActor_name others malware malware others
TeleBots : Win32/PSW.Agent.ODE trojan .		threatActor_name others malware malware others
TeleBots : Win64/PSW.Agent.K trojan .		threatActor_name others malware malware others
TeleBots : Python/Filecoder.R trojan .		threatActor_name others malware malware others
TeleBots : Win32/Filecoder.AESNI.C trojan .		threatActor_name others malware malware others
TeleBots : Win32/Filecoder.NKH trojan .		threatActor_name others malware malware others
TeleBots : Win32/Diskcoder.C trojan .		threatActor_name others malware malware others
TeleBots : Win64/Riskware.Mimikatz application .		threatActor_name others malware malware others
TeleBots : Win32/RiskWare.Mimikatz application .		threatActor_name others malware malware others
TeleBots : transfinance.com.ua ( IP : 130.185.250.171 ) .		threatActor_name others domain_evil others others others IP_evil others others
TeleBots : bankstat.kiev.ua ( IP : 82.221.128.27 ) .		threatActor_name others domain_evil others others others IP_evil others others
TeleBots : www.capital-investing.com.ua ( IP : 82.221.131.52 ) .		threatActor_name others domain_evil others others others IP_evil others others
TeleBots : api.telegram.org ( IP : 149.154.167.200 , 149.154.167.197 , 149.154.167.198 , 149.154.167.199 ) .		threatActor_name others domain others others others IP others IP others IP others IP others others
TeleBots : 1557E59985FAAB8EE3630641378D232541A8F6F9 .		threatActor_name others sha2 others
TeleBots : 31098779CE95235FED873FF32BB547FFF02AC2F5 .		threatActor_name others sha2 others
TeleBots : CF7B558726527551CDD94D71F7F21E2757ECD109 .		threatActor_name others sha2 others
TeleBots : 91D955D6AC6264FBD4324DB2202F68D097DEB241 .		threatActor_name others sha2 others
TeleBots : DCF47141069AECF6291746D4CDF10A6482F2EE2B .		threatActor_name others sha2 others
TeleBots : 4CEA7E552C82FA986A8D99F9DF0EA04802C5AB5D .		threatActor_name others sha2 others
TeleBots : 4134AE8F447659B465B294C131842009173A786B .		threatActor_name others sha2 others
TeleBots : 698474A332580464D04162E6A75B89DE030AA768 .		threatActor_name others sha2 others
TeleBots : 00141A5F0B269CE182B7C4AC06C10DEA93C91664 .		threatActor_name others sha2 others
TeleBots : 271023936A084F52FEC50130755A41CD17D6B3B1 .		threatActor_name others sha2 others
TeleBots : D7FB7927E19E483CD0F58A8AD4277686B2669831 .		threatActor_name others sha2 others
TeleBots : 56C03D8E43F50568741704AEE482704A4F5005AD .		threatActor_name others sha2 others
TeleBots : 38E2855E11E353CEDF9A8A4F2F2747F1C5C07FCF .		threatActor_name others sha2 others
TeleBots : 4EAAC7CFBAADE00BB526E6B52C43A45AA13FD82B .		threatActor_name others sha2 others
TeleBots : F4068E3528D7232CCC016975C89937B3C54AD0D1 .		threatActor_name others sha2 others
TeleBots : A4F2FF043693828A46321CCB11C5513F73444E34 .		threatActor_name others sha2 others
TeleBots : 5251EDD77D46511100FEF7EBAE10F633C1C5FC53 .		threatActor_name others sha2 others
TeleBots : 8D379585E0A9DB4C65450622CED26C108DC694AB .		threatActor_name others sha2 others
TeleBots : 759DCDDDA26CF2CC61628611CF14CFABE4C27423 .		threatActor_name others sha2 others
TeleBots : 77C1C31AD4B9EBF5DB77CC8B9FE9782350294D70 .		threatActor_name others sha2 others
TeleBots : EAEDC201D83328AF6A77AF3B1E7C4CAC65C05A88 .		threatActor_name others sha2 others
TeleBots : EE275908790F63AFCD58E6963DC255A54FD7512A .		threatActor_name others sha2 others
TeleBots : EE9DC32621F52EDC857394E4F509C7D2559DA26B .		threatActor_name others sha2 others
TeleBots : FC68089D1A7DFB2EB4644576810068F7F451D5AA .		threatActor_name others sha2 others
TeleBots : 1C69F2F7DEE471B1369BF2036B94FDC8E4EDA03E .		threatActor_name others sha2 others
TeleBots : AF07AB5950D35424B1ECCC3DD0EEBC05AE7DDB5E .		threatActor_name others sha2 others
TeleBots : BDD2ECF290406B8A09EB01016C7658A283C407C3 .		threatActor_name others sha2 others
TeleBots : 9C694094BCBEB6E87CD8DD03B80B48AC1041ADC9 .		threatActor_name others sha2 others
TeleBots : D2C8D76B1B97AE4CB57D0D8BE739586F82043DBD .		threatActor_name others sha2 others
TeleBots : 34F917AABA5684FBE56D3C57D48EF2A1AA7CF06D .		threatActor_name others sha2 others
TeleBots : D297281C2BF03CE2DE2359F0CE68F16317BF0A86 .		threatActor_name others sha2 others