Seduploader : Target Confirmation .		malware others others others others
Release_Time : unknown .		others others others others
Report_URL : https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part1.pdf .		others others others others others others
Seduploader serves as reconnaissance malware .		malware others others others others others
It is made up of two distinct components : a dropper and the per-sistent payload installed by this dropper .		others others others others others others others others others others tool others others tool tool others others others others others
Seduploader ’ s payload is a downloader used by Sednit ' s operators as reconnaissance malware .		malware others others tool others others others others others threatActor_name others others others others others others others
If the victim is considered interesting , Seduploader is instructed to download a spying backdoor , like Sedreco or Xagent .		others others others others others others others malware others others others others others others malware others others malware others malware others
March 2015 to August 2016 ( the time of this writing ) .		time time time time time others others others others others others others others
Probably still in use .		others others others others others
Downloaded by Sedkit .		others others malware others
Dropped by Microsoft Office exploits attached to targeted phishing emails .		others others company company others others others others malware malware others
The Seduploader payload borrows parts of its code from Carberp—an infamous malware family whose partial source code was made public—as documented by F-Secure in September 2015 .		others malware malware others others others others others others others others others others others others others others others others others others others tool others time time others
Seduploader has been compiled for Windows and OS X ( at least ) .		malware others others others others OS_name others OS_name OS_name others others others others others
Older Seduploader dropper samples contain an unusual anti-analysis trick based on large temporary files ( named jhuhugit.temp , jhuhugit.tmp or jkeyskw.temp depending on the version ) .		others malware malware others others others others others others others others others others others others others sample_name others sample_name others sample_name others others others others others others
The Seduploader payload implements three different methods to contact its C&C server .		others malware malware others others others others others others others tool tool tool tool others
The dates posited in the timeline mainly rely on the compilation timestamps of the Seduploader payloads.We believe that the payloads ’ timestamps were not tampered with , because they match our telemetry data , as opposed to the droppers ’ timestamps .		others others others others others others others others others others others others others others malware others others others others tool others others others others others others others others others others others others others others others others others others malware others others others
The dates in the timeline may be later than the actual events though , as we do not have all Seduploader samples—but enough are present to give a good approximation .		others others others others others others others others others others others others others others others others others others others others malware others others others others others others others others others others
We define Seduploader as a two-binary component , comprising a dropper and the payload usually contained in this dropper.While those two have sometimes been used independently of each other , they usually are deployed together and remain the most-used first-stage malware of the Sednit group since the beginning of 2015 .		others others malware others others others others others others others malware others others tool others others others others others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others time time time time others
The payload component of Seduploader has been compiled forWindows and OS X , but our analysis is based solely on the Windows version .		others tool others others malware others others others others others OS_name OS_name others others others others others others others others others OS_name others others
Nevertheless , the OS X version is very similar , and has been described by BAE Systems in June 2015 .		others others others OS_name OS_name others others others others others others others others others others company company others time time others
While pretty straightforward , it has some interesting details that we will describe in this section .		others others others others others others others others others others others others others others others others others
This code allocates a small memory buffer B and sets its tenth byte to the value 42 .		others others others others others others others others others others others others others others others others others others
It then writes and reads one million times into a newly created temporary file1 .		others others others others others others others others others others others others others others others
After that operation , it checks whether the tenth byte of B still contains the value 42 .		others others others others others others others others others others others others others others others others others others
If this is not the case , Seduploader terminates its execution .		others others others others others others others malware others others others others
This code primarily serves to delay execution with I/O intensive operations , in order to exhaust security products ’ analysis limits .		others others others others others others others others tool others others others others others others others others others others others others others
It may also detect security software emulators that wrongly implement memory management , and hence are unable to maintain the correct state of B due to the number of operations performed .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This technique was present in another dropper employed by the Sednit group in 2014 , which we have not seen since then .		others others others others others others others others others others threatActor_name others others time others others others others others others others others others
This trick disappeared from Seduploader in December 2015—probably because it was easy to spot and could be used to detect the malware .		others others others others malware others time others others others others others others others others others others others others others others others others
It was then replaced by a more common anti-analysis technique based on time measurement .		others others others others others others others others others others others others others others others
Additionally , important strings in Seduploader ’ s dropper are encrypted with a simple XOR-based algorithm , and the addresses of important Windows API functions are resolved dynamically .		others others others others others malware others others malware others others others others others tool tool others others others others others others OS_name tool others others others others others
The core logic of Seduploader ’ s dropper is implemented in a C++ class named UpLoader by its developers .		others others others others malware others others others others others others others tool tool others tool others others others others
This class has evolved several times since Seduploader ’ s first appearance , and its last known version contains the eight methods described in Table 4 .		others others others others others others others malware others others others others others others others others others others others others others others others others others others others
decrypt_in_place Decrypts the given data using a simple XOR-based algorithm and a 10-byte key .		malware others others others others others others others tool tool others others tool tool others
decrypt_in_new_memory Decrypts the given data using the same algorithm as decrypt_in_place , except that the result is written into a newly allocated memory buffer .		malware others others others others others others others others others others others others others others others others others others others others others others others others
get_env_var Retrieves the value of an environment variable .		malware others others others others others others others others
decrypt_embedded_files Decrypts one or more embedded files , with some metadata ( names and location in which to drop them ) .		malware others others others others others others others others others others others others others others others others others others others others others
decompress Decompresses a given memory area using Windows API function RtlDecompressBuffer .		others others others others others others others OS_name tool others function others
drop Writes the content of a given memory area into a file on disk .		others others others others others others others others others others others others others others others
execute_file Executes a given file , which can be either a Windows library , whose export named init will then be called , or an executable .		malware others others others others others others others others others others OS_name others others others others others others others others others others others others others others others
If the current process runs at system integrity level , it ensures that the child process runs at the same integrity level .		others others others others others others others others others others others others others others others others others others others others others others others
delete_file Deletes a given file from the system .		malware others others others others others others others others
Using those C++ methods , the dropper decrypts and decompresses its embedded payload , which consists of one or more files .		others others tool others others others malware others others others others others others others others others others others others others others others
It then drops the files on disk and executes them .		others others others others others others others others others others others
Finally , before removing itself from the machine , the dropper makes the payload persistent , as we will describe in the following sections .		others others others others others others others others others others malware others others tool others others others others others others others others others others others
We know the developers named this class UpLoader because they left Run-Time Type Information ( RTTI ) in some Seduploader samples .		others others others others others others others tool others others others others others others others tool others others others malware others others
Additionally , the following program database ( PDB ) path overlooked by the developers in one sample , indicates that the binary itself is named Uploader : D:\REDMINE\JOINER\HEADER_PAYLOAD\header_payload\Uploader\Release\Uploader.pdb .		others others others others others others others tool others others others others others others others others others others others others others others others others others others others others others others others
The significance of other parts of this PDB path remain obscure , except for the REDMINE part , which may refer to a project management web application .		others others others others others others others tool others others others others others others others tool others others others others others others others others others tool others others
Before making the payload persistent on the system , Seduploader may execute local privilege escalation exploits .		others others others others others others others others others malware others others others others others others others
Since Seduploader ’ s first appearance , the two vulnerabilities described in Table 5 have been exploited , and both were unpatched when first used by the Sednit group .		others malware others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others
CVE-2015-1701 Microsoft Windows <= Windows 7 March-April 2015 .		vulnerability_cve company OS_name others others OS_name OS_name time time others
CVE-2015-2387 Microsoft Windows all versions July 2015 .		vulnerability_cve company OS_name others others time time others
Since its inception , Seduploader ’ s dropper has employed a variety of persistence methods for its payload , some of them only when running with SYSTEM privileges ( thanks to the previously mentioned exploits ) .		others others others others malware others others malware others others others others others others others others others others others others others others others others others others tool others others others others others others others others others others
Here are the most common persistence methods we observed ( details are given in the IOC section ) :  Register the payload under the Run registry key .While this is essentially a classic method , Seduploader employs a uncommon trick to write into the registry by executing JavaScript code within the rundll32.exe process .		others others others others others others others others others others others others others others others tool others others others others others others others others tool others others others others others others others others others others malware others others others others others others others others others others others tool others others others sample_name others others
This technique was first seen in the Win32/Poweliks malware in mid-2014 , and has since been documented in detail .		others others others others others others others malware others others time others others others others others others others others others
Register the payload as a Windows service that will run at startup .		others others others others others OS_name others others others others others others others
This method is used only when running with SYSTEM privileges .		others others others others others others others others tool others others
Register the payload as a scheduled task that will run each time the current user logs in .		others others others others others others others others others others others others others others others others others others
This method is used only when running with SYSTEM privileges .		others others others others others others others others tool others others
Replace a legitimateWindows COM object with the payload , so that it will be loaded in any process using that COM object .		others others others tool others others others others others others others others others others others others others others others others tool others others
The exact hijacked object is a class named MMDeviceEnumerator .		others others others others others others others others tool others
This technique has also been seen in the malware Win32/COMpfun .		others others others others others others others others others malware others
Register the payload as a Shell Icon Overlay handler COM object , so that the payload will be loaded each time a user logs in .		others others tool others others tool tool tool others tool others others others others others tool others others others others others others others others others others
The chosen CLSID of this object ( {3543619C-D563-43f7-95EA-4DA7E1CC396A} ) is already legitimately used in an Internet Explorer plug-in open-source project named “ BHOinCPP ” , probably to confuse defenders .		others others tool others others others others others md5 others others others others others others others others tool tool others others others others others tool others others others others others others others
Register a Windows shell script under the registry key HKCU\Environment\UserInitMprLogonScript , which will run the payload at startup .		others others OS_name others others others others others others others others others others others others others others others others
This is also a documented technique , yet not well known .		others others others others others others others others others others others others
This method is usually the preferred one when Seduploader does not run with SYSTEM privileges .		others others others others others others others others malware others others others others tool others others
The diversity of these persistence methods shows the intensity of the development effort behind Seduploader , and that its developers have a good grasp of the current literature , as several of these techniques seem to have been inspired by other malware .		others others others others others others others others others others others others others others malware others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This binary can be roughly described as a first-stage reconnaissance tool , probably used to distinguish security researchers performing analysis from real targets .		others others others others others others others others others others others others others others others others others others others others others others others others
In this section we describe the workflow of this payload as found in the most recent version .		others others others others others others others others others others others others others others others others others others
The first operation of the Seduploader payload is to find a reliable way to reach its C&C server on the Internet , which may be difficult depending on the network setup of the compromised organization .		others others others others others malware tool others others others others others others others others others tool tool tool tool others others tool others others others others others others others others others others others others others others others
To test whether the compromised machine is connected to the Internet without attracting attention , Seduploader tries to reach Google servers over HTTP , usually google.com or google.ru .		others others others others others others others others others others tool others others others others malware others others others company others others tool others others domain others domain others
This part of the Seduploader code changed several times over the last year and currently contains three possible means of communication .		others others others others malware others others others others others others others others others others others others others others others others others