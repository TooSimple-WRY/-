Spear Phishing Techniques Used in Attacks Targeting the Mongolian Government Release_Time :  2017-02-22 Report_URL :  https://www.fireeye.com/blog/threat-research/2017/02/spear_phishing_techn.html FireEye recently observed a sophisticated campaign targeting individuals within the Mongolian government .		others others others others others others others others others others others others others others others others others others security_team others others attack_activity attack_activity attack_activity others others others others government government others
Targeted individuals that enabled macros in a malicious Microsoft Word document may have been infected with Poison Ivy , a popular remote access tool ( RAT ) that has been used for nearly a decade for key logging , screen and video capture , file transfers , password theft , system administration , traffic relaying , and more .		others target_crowd others others malware malware malware malware malware malware malware others others others others others malware malware others others others tool tool tool others tool others others others others others others others others others others function function others function function function function others function function others function function others function function others function function others others others others
The threat actors behind this attack demonstrated some interesting techniques , including :  Customized evasion based on victim profile – The campaign used a publicly available technique to evade AppLocker application whitelisting applied to the targeted systems .		threatActor_aliases threatActor_aliases threatActor_aliases others reference_word reference_word others others others others others others others tool tool tool tool tool tool others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Fileless execution and persistence – In targeted campaigns , threat actors often attempt to avoid writing an executable to the disk to avoid detection and forensic examination .		tool tool tool tool others others others others others threatActor_aliases threatActor_aliases others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal attack_goal attack_goal others
The campaign we observed used four stages of PowerShell scripts without writing the the payloads to individual files .		reference_word reference_word others others others tool tool tool tool tool others others others others others others others others others
Decoy documents – This campaign used PowerShell to download benign documents from the Internet and launch them in a separate Microsoft Word instance to minimize user suspicion of malicious activity .		tool tool others others others others tool others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
The threat actors used social engineering to convince users to run an embedded macro in a Microsoft Word document that launched a malicious PowerShell payload .		threatActor_aliases threatActor_aliases threatActor_aliases others tool tool others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others tool tool tool others sub_activity sub_activity sub_activity sub_activity sub_activity others
The threat actors used two publicly available techniques , an AppLocker whitelisting bypass and a script to inject shellcode into the userinit.exe process .		threatActor_aliases threatActor_aliases threatActor_aliases others others others others others others others tool tool tool others others tool others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
The malicious payload was spread across multiple PowerShell scripts , making its execution difficult to trace .		others malware malware others others others tool tool tool others others others others others others others others
Rather than being written to disk as individual script files , the PowerShell payloads were stored in the registry .		others others others others others others others others others others others others tool tool others others others others tool others
Targets of the campaign received Microsoft Word documents via email that claimed to contain instructions for logging into webmail or information regarding a state law proposal .		others others reference_word reference_word others tool tool tool tool tool others others others function function function function function function others function function function function function function others
Microsoft application whitelisting solution AppLocker prevents unknown executables from running on a system .		company tool tool tool tool function function function function function function function function others
In April 2016 , a security researcher demonstrated a way to bypass this using regsvr32.exe , a legitimate Microsoft executable permitted to execute in many AppLocker policies .		others time time others person person person others others others others sub_activity reference_word sub_activity sub_activity others others tool tool tool others others sample_function sample_function sample_function sample_function sample_function others
The regsvr32.exe executable can be used to download a Windows Script Component file ( SCT file ) by passing the URL of the SCT file as an argument .		others sample_name others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others others others others others others
This technique bypasses AppLocker restrictions and permits the execution of code within the SCT file .		others others others tool others others others others others others others others others others others others
In the decrypted shellcode , we also observed content and configuration related to Poison Ivy .		others others others others others others others others others others others others others others others others
Correlating these bytes to the standard configuration of Poison Ivy , we can observe the following :  Active setup : StubPath .		others others others others others others others others vul_aliases vul_aliases others others others others others others others others others others string others
Encryption/Decryption key : version2013 .		others others others string others
Mutex name : 20160509 .		others others others string others
Although Poison Ivy has been a proven threat for some time , the delivery mechanism for this backdoor uses recent publicly available techniques that differ from previously observed campaigns .		others vul_aliases vul_aliases others others others others others others others others others others others others others others others others others others others others others others others others others others others
Through the use of PowerShell and publicly available security control bypasses and scripts , most steps in the attack are performed exclusively in memory and leave few forensic artifacts on a compromised host .		others others others others tool others tool tool tool tool tool tool tool others others others others others others others others others others others others others others others others others others others others others
FireEye HX Exploit Guard is a behavior-based solution that is not affected by the tricks used here .		security_team tool tool tool others others tool tool others function function function function function function function function others
It detects and blocks this threat at the initial level of the attack cycle when the malicious macro attempts to invoke the first stage PowerShell payload .		reference_word counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others
HX also contains generic detections for the registry persistence , AppLocker bypasses and subsequent stages of PowerShell abuse used in this attack .		reference_word others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others