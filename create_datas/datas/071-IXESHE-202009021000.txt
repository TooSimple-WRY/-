IXESHE An APT Campaign .		threatActor_name others others others others
Release_Time :  2012 Report_URL :  https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf .		others others others others others others others others others
The majority of the IXESHE campaign ’s C&C servers were based in Taiwan and the United States .		others others others others threatActor_name others others others tool tool tool others others others others location others others location location others
This is , however , not an indicator of attribution .		others others others others others others others others others others others
It is not possible to determine where the attackers are based solely on where their C&C infrastructures are located .		others others others others others others others others person others others others others others others tool tool tool others others others others
In addition , not all of the C&C servers are currently active .		others others others others others others others tool tool tool others others others others others
Many , if not all of them , appear to be compromised machines .		others others others others others others reference_word others others others others others others others
In fact , at least 11 of the C&C servers were hosted on the compromised machines of an East Asian government , which made these very useful for launching targeted attacks against it .		others others others others others others others others tool tool tool others others others others others others others others others government government government others others others reference_word others others others sample_function sample_function sample_function others reference_word others
Most of the malware samples directly accessed an IP address as a C&C server .		others others others others others others others others tool others others others tool tool tool others others
Connections to domains did exist in some cases .		others others others others others others others others others
The domains were usually registered using free dynamic DNS service providers or compromised websites .		others others others others others others others tool protocol tool tool others tool tool others
Overall , this strategy was part of the attackers ’ modus operandi .		others others others others others others others others person others others others others
By choosing compromised machines to act as C&C servers , fewer clues were left for investigators to follow in an attempt to find out who is behind the attacks compared with those using bulletproof hosting services and registered domain names .		others others others others others others others tool tool tool others others others others others others others person others others others others others others others others others others others others others others others others others others others others others others others others others
To conduct research on these servers , investigators need to differentiate between information related to malicious and legitimate use .		others others others others others others others person others others others others others others others others others others others others
One very interesting error revealed more insights into the C&C network ’s setup .		others others others others others others others others others tool tool tool others others others others others
One of the malware samples we tested was designed to access xxx.xxawan.com via port 443 , which , at that time , resolved to xx.xxx.114.87:443 , a server located in the United States .		others others others others others others others others others others others domain others others others others others others others others others others others others IP others others others others others others location location others
The sample , however , received the following error message from the server :  This indicated that the front-end servers actually functioned as proxy servers and that the true C&C servers were hidden behind this initial group of C&C servers .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others tool tool tool others others others others others others others others tool tool tool others others
This made the network more resistant to takedown and analysis .		others others others others others others others others others others others
Due to a server error , however , the attackers revealed the location of one of their back-end servers .		others others others others others others others others others person others others others others others others others others others others
We discovered that the IP address , xx.xx.x2.202 , is located in Guangdong , China .		others others others others others others others IP others others others others location others location others
The particular error returned looked very similar to errors generated by a tool called “ HTran.		others others others others others others others others others others others others others others others tool others
” HTran stands for “ HUC Packet Transmit Tool , ” a connection bouncer that redirects TCP traffic destined for one host to an alternate host , keeping the real host hidden from view .		others tool others others others tool tool tool tool others others others others others others others protocol others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function others others others
“ HUC , ” in this case , stands for the hacking group , “ Honker Union of China.		others tool others others others others others others others others others others others others others tool tool tool tool others
” It was coded by a hacker who goes by the handle “ lion.		others others others others others others others others others others others others others tool others
” This tool ’s error-checking code , however , is flawed .		others reference_word reference_word others others others others others others others others others others
Assuming that everything properly works , the tool functions very well as a proxy server but if the real server is currently inaccessible , HTran will send an error message , revealing its whereabouts .		others others others others others others others others others others others others others others others others others others others others others others others others tool others others others sub_activity sub_activity others sample_function sample_function sample_function others
Running a port scan on this server revealed some open ports shown in the table below .		others others others others others others others others others others others others others others others others others
80/tcp Open HTTP .		others others protocol others
8080/tcp Open HTTP Alternative .		others others protocol others others
Based on OS fingerprinting , the server appears to be running Windows 7 Enterprise Server .		others others others others others others others others others others others others others others others others
With only a few open ports , however , it was very difficult to confirm this .		others others others others others others others others others others others others others others others others others
In addition , we did not receive a response when we tried to connect to these ports .		others others others others others others others others others others others others others others others others others others
Previous research on the IXESHE campaign indicated several connections to groups possibly from China .		others others others others threatActor_name others others others others others person others others location others
In addition , the IP address hiding behind the HTran instance was an IP range assigned to China .		others others others others others others others others others tool others others others others others others others location others
Upon further investigation of the “ manufact ” campaign , however , it appears that the gang behind it may be English speakers .		others others others others others others others others others others others others others others others others others others others others others others others others
The name of the campaign , for one , is most likely a shortened form of “ manufacturing.		others others others others others others others others others others others others others others others others others others others
” The OS the C&C server uses is also an English install of Microsoft XP .		others others others others tool tool tool others others others others others others others others tool tool others
It is also likely , of course , that the C&C server is a compromised machine so it does not use the attackers ’ first language .		others others others others others others others others others others tool tool tool others others others others others others others others others others others others others others others others
The malware samples , which appear to have been developed using C++ , had a number of strings and error codes in English such as “ Enter command ” and “ Receive command error!		others others others others others others others others others others others program_language others others others others others others others others others others others others others others others others others others others others others others others
”  The date format used in the campaign codes ( i.e.		others others tool tool others others others tool tool others others others
, MMDD ) also provided us a clue as to where the attackers may be from .		others others others others others others others others others others others others others others others others others
This date format is only commonly used in China , Korea , Iran , Japan , Hungary , Lithuania , and the United States .		others tool tool others others others others others location others location others location others location others location others location others others others location location others
Based on the limited amount of information we gathered about the attackers , it was very difficult to pinpoint their exact location .		others others others others others others others others others others others others others others others others others others others others others others others
An attack can be considered associated with the gang behind the IXESHE campaign if it exhibits the following characteristics :  Uses a specially crafted targeted email with a malicious file attachment .		others person others others others others others others others others others threatActor_name others others others others others others others others others others others others tool tool others others tool tool tool others
Uses document exploits , primarily .PDF files , to drop malware into target systems .		others tool tool others others others tool others others sample_function sample_function sample_function sample_function sample_function others
Uses malware detected by security vendors as IXESHE variants .		others malware others others others others others threatActor_name others others
Uses a malware that sends a GET request to the C&C server in the following format :  http://[C&C Server]/[ACD] [EW]S[Some Numbers].jsp?		others others malware others sample_function sample_function sample_function sample_function others others tool tool tool others others others others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil
[Encrypted Base64 Blob] .		others others others others others others
Uses dynamic DNS services for or compromised machines as C&C servers .		others tool tool tool others others others others others tool tool tool others others
The IXESHE campaign has been successfully executing targeted attacks since 2009 .		others threatActor_name others others others others others others others others time others
The attackers primarily use malicious .PDF files that exploit vulnerabilities in Adobe Reader , Acrobat , and Flash Player , including the use of two zero-day exploits—one in 2009 and another in 2011 .		others person others others others others tool others others others others tool tool others tool others others tool tool others others others others others others attack_activity others others time others others others time others
While the attackers primarily targeted East Asian governments in the past , they have also started targeting a telecommunications company and electronics manufacturers .		others others person others others government government government others others others others others others others others others others company company others company company others
They kept track of their targeted attacks by embedding a “ campaign tag ” in the malware that appears to describe when each attack was launched and , in some cases , the nature of its target .		reference_word others others others others others others others others others others tool tool others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others others
We found more than 40 of these campaign tags .		others others others others others others others others others others
The IXESHE attackers are notable for their use of compromised machines within a target ’s internal network as C&C servers .		others person person others others others others others others tool tool others others others others others others others others tool tool tool others others
This helped disguise their activities .		others others sample_function sample_function sample_function others
In addition , the attackers ’ use of the proxy tool , HTran , also helped mask their true location .		others others others others person others others others others tool tool others tool others others others sample_function sample_function sample_function sample_function others
While their identities remain unknown , the attackers behind the IXESHE campaign demonstrated that they were both determined and capable .		others others others others others others others others others others threatActor_name others others others others others others others others others others
While the malware used in the attacks were not very complicated by nature , these proved very effective .		others others others others others others others others others others others others others others others others others others others
This campaign remains an active threat .		others others others others others others others
Sufficiently motivated threat actors can penetrate even networks that use moderately advanced security measures .		others others person person others others others others others others tool tool tool tool others
As such , apart from standard and relevant attack prevention measures and mechanisms such as solid patch management ; endpoint and network security ; firewall use ; and the like , enterprises should also focus on detecting and mitigating attacks .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Moreover , data loss prevention ( DLP ) strategies that identify the data an organization is protecting and take into account the context of data use should be employed .		others others tool tool tool others tool others others others sample_function sample_function sample_function others others others others others others others others others sample_function sample_function sample_function others others others others others
Threat intelligence refers to indicators that can be used to identify the tools , tactics , and procedures threat actors engaging in targeted attacks utilize .		tool tool others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others
Both external and local threat intelligence is crucial for developing the ability to detect attacks early .		others tool tool tool tool tool others others others others others others others sample_function sample_function others others
The following are the core components of this defense strategy :  Enhanced visibility : Logs from endpoint , server , and network monitoring are an important and often underused resource that can be aggregated to provide a view of the activities within an organization that can be processed for anomalous behaviors that can indicate a targeted attack .		others others others others others others others others others others others sub_activity sub_activity others tool others others others others others others others others others others others others others others others others others others others others sample_function sample_function sample_function others others others others others others others others others others others others others others others others others others others others
Integrity checks : In order to maintain persistence , malware will make modifications to the file system and registry .		sub_activity sub_activity others others others others sample_function sample_function others others others others others others others others others others others others
Monitoring such changes can indicate the presence of malware .		sub_activity sub_activity sub_activity others others others others others others others
Empowering the human analyst : Humans are best positioned to identify anomalous behaviors when presented with a view of aggregated logs from across a network .		sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others others others
This information is used in conjunction with custom alerts based on the local and external threat intelligence available .		others others others others others others others others others others others others tool tool tool tool tool others others
Technologies available today such as Deep Discovery provide visibility , insight , and control over networks to defend against targeted threats .		sub_activity sub_activity others others others sub_activity sub_activity others others others others others others others others others others sample_function sample_function sample_function sample_function others
Deep Discovery uniquely detects and identifies evasive threats in real time and provides in-depth analysis and actionable intelligence to prevent , discover , and reduce risks .		sub_activity sub_activity others sample_function sample_function sample_function sample_function sample_function others others others others sample_function sample_function sample_function others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Once an attack is identified , the cleanup strategy should focus on the following objectives :  Determine the attack vector and cut off communications with the C&C server .		others others others others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others others others others others others others
Determine the scope of the compromise .		sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Assess the damage by analyzing the data and forensic artifacts available on compromised machines .		others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others
Remediation should be applied soon afterward , which includes steps to fortify affected servers , machines , or devices into secure states , informed in part by how the compromised machines were infiltrated .		tool others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others
Security-related policies and procedures combined with education and training programs are essential components of defense .		others others others others others others others others others others others others others others others others
Traditional training methods can be fortified by simulations and exercises using real spear-phishing attempts sent to test employees .		others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others sample_function sample_function others
Employees trained to expect targeted attacks are better positioned to report potential threats and constitute an important source of threat intelligence .		person others others others others others others others others others others others others others others others others others others others others others
The ultimate objective of targeted attacks is to acquire sensitive data .		others others others others others others others others sample_function sample_function sample_function others
As such , DLP strategies that focus on identifying and protecting confidential information are critical .		others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity others others others
Enhanced data protection and visibility across an enterprise provides the ability to control access to sensitive data as well as monitor and log successful and unsuccessful attempts to access it .		sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others sample_function sample_function sample_function sample_function sample_function others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others
Enhanced access control and logging capabilities allow security analysts to locate and investigate anomalies , respond to incidents , and initiate remediation strategies and damage assessment .		sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others sample_function sample_function sample_function sample_function others sample_function sample_function sample_function others others sample_function sample_function sample_function others sample_function sample_function others
The following table summarizes the Trend Micro solutions for the components of the IXESHE campaign .		others others others others others company company others others others others others others threatActor_name others others
Trend Micro recommends a comprehensive security risk management strategy that goes further than advanced protection to meet the real-time threat management requirements of dealing with targeted attacks .		company company others others others others others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others
Predetermined C&C communication format : http://[C&C Server]/ [ACD] [EW]S[Some Numbers] .		others tool tool tool others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil others
jsp?		others others
[Encrypted Base64 Blob] Web Reputation Endpoint ( Titanium , Worry-Free Business Security , OfficeScan ) Server ( Deep Security ) Messaging ( InterScan Messaging Security , ScanMail Suite for Microsoft Exchange ) Network ( Deep Discovery ) Gateway ( InterScan Web Security , InterScan Messaging Security ) Mobile ( Mobile Security ) .		others others others others others others others sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity others sub_activity others sub_activity sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity others sub_activity sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others sub_activity others sub_activity sub_activity others others
TROJ_PIDIEF , BKDR_PROXY , TROJ_ DROPR , and TROJ_DEMTRANC variants File Reputation ( Antivirus/Anti-malware ) Endpoint ( Titanium , Worry-Free Business Security , OfficeScan ) Server ( Deep Security ) Messaging ( InterScan Messaging Security , ScanMail Suite for Microsoft Exchange ) Network ( Deep Discovery ) Gateway ( InterScan Web Security , InterScan Messaging Security ) Mobile ( Mobile Security ) .		tool others tool others tool tool others others tool others others others others others others sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity others sub_activity others sub_activity sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity others sub_activity sub_activity others sub_activity others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others sub_activity others sub_activity sub_activity others others
CVE-2009-4324 CVE-2009-0927 CVE-2011-0609 CVE-2011-0611 CVE-2009-3129 Vulnerability Shielding/Virtual Patching Server ( Deep Security ) Endpoint ( OfficeScan with Intrusion Defense Firewall Plug-In ) For CVE-2009-4324: Rule #1004008 ( Adobe Reader and Acrobat ‘ newplayer() ’ JavaScript Method Code Execution ) For CVE-2009-0927: Rule # 1003405 ( Adobe Acrobat JavaScript getIcon Method Buffer Overflow ) For CVE-2011-0609: Rule #1004615 ( Adobe Flash Player XLS Remote Code Execution ) For CVE-2011-0611: Rule # 1004647 ( Restrict Microsoft Office File with Embedded SWF ) For CVE-2009-3129: Rule #1003817 ( Excel Featheader Record Memory Corruption Vulnerability ) .		vulnerability_cve vulnerability_cve vulnerability_cve vulnerability_cve vulnerability_cve others others others sub_activity others sub_activity sub_activity others sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others vulnerability_cve others others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity others others vulnerability_cve others others others others others others others others others sub_activity sub_activity sub_activity others others vulnerability_cve others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others vulnerability_cve others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others vulnerability_cve others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others