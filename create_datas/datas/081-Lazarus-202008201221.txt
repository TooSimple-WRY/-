Cryptocurrency businesses still being targeted by Lazarus Release_Time : 2019-3-26 Report_URL : https://securelist.com/cryptocurrency-businesses-still-being-targeted-by-lazarus/90019/ It ’s hardly news to anyone who follows cyberthreat intelligence that the Lazarus APT group targets financial entities , especially cryptocurrency exchanges .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others others industry industry others others industry industry others
Financial gain remains one of the main goals for Lazarus , with its tactics , techniques , and procedures constantly evolving to avoid detection .		attack_goal attack_goal others others others others others others others threatActor_name others others others others others others others others others others others others others others others
In the middle of 2018 , we published our Operation Applejeus research , which highlighted Lazarus ’s focus on cryptocurrency exchanges utilizing a fake company with a backdoored product aimed at cryptocurrency businesses .		others others time time time others person others others sub_activity sub_activity others others others others threatActor_name others others others others others others others others others others others others others others others others others others others
One of the key findings was the group ’s new ability to target macOS .		others others others others others others reference_word reference_word others others others others others others OS_name others
Since then Lazarus has been busy expanding its operations for the platform .		others others threatActor_name others others others others others others others others others others
Further tracking of their activities targeting the financial sector enabled us to discover a new operation , active since at least November 2018 , which utilizes PowerShell to control Windows systems and macOS malware for Apple users .		others others others others others others others others others others others others others others sub_activity sub_activity others others others others others time time others others others tool others others OS_name OS_name others OS_name others others others others others
Lazarus is a well-organized group , something that can be seen from their malware population : not only have we seen them build redundancy to reserve some malware in case of in-operation hot spare replacement of ‘ burnt ’ ( detected ) samples but they also conform to specific internal standards and protocols when developing backdoors .		threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This case is no different .		others others others others others others
They have developed custom PowerShell scripts that communicate with malicious C2 servers and execute commands from the operator .		reference_word others others others tool others others others others others protocol others others others others others others others others
The C2 server script names are disguised as WordPress ( popular blog engine ) files as well as those of other popular open source projects .		others others others others others others others others tool others others others others others others others others others others others others others others others others others
After establishing the malware control session with the server , the functionality provided by the malware includes :  Set sleep time ( delay between C2 interactions ) , Exit malware , Collect basic host information , Check malware status , Show current malware configuration , Update malware configuration , Execute system shell command , Download & Upload files .		others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Lazarus uses different tactics to run its C2 servers : from purchasing servers to using hacked ones .		others others others others others others others protocol others others others others others others others others others others
We have seen some legitimate-looking servers that are most likely compromised and used in malicious campaigns .		others others others others others others others others others others others others others others others others others
According to server response headers , they are most likely running an old vulnerable instance of Internet Information Services ( IIS ) 6.0 on Microsoft Windows Server 2003 .		others others others others others others others others others others others others others others others others others others others others others others others others OS_name OS_name OS_name OS_name others
Another C2 server was probably purchased by Lazarus from a hosting company and used to host macOS and Windows payloads .		others protocol others others others others others threatActor_name others others others others others others others others OS_name others others others others
The geography of the servers varies , from China to the European Union .		others others others others others others others others location others others location location others
But why use two different types of servers?		others others others others others others others others others
The group seems to have a rule ( at least in this campaign ) to only host malware on rented servers , while hosting C2 scripts for malware communication on compromised servers .		others others others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
The malware was distributed via documents carefully prepared to attract the attention of cryptocurrency professionals .		others reference_word others others others others others others others others others others others others others others
Seeing as how some of the documents were prepared in Korean , we believe that South Korean businesses are a high priority for Lazarus .		others others others others others others others others others others location others others others others location location company others others others others others threatActor_name others
Another macro-weaponized document ( e9a6a945803722be1556fd120ee81199 ) contains a business overview of what seems to be a Chinese technology consulting group named LAFIZ .		others others others others md5 others others others others others others others others others others others others others others others others company others
We couldn’t confirm if it ’s a legitimate business or another fake company made up by Lazarus .		others others others others others others others others others others others others others others others others others others others threatActor_name others
Their website lafiz.link has been parked since 2017 .		others others domain_evil others others others others time others
Based on our telemetry , we found a cryptocurrency exchange company attacked with a malicious document containing the same macro .		others others others others others others others others company company company others others others others others others others others others others
The payloads show that Lazarus keeps exploring more ways to evade detection to stay under the radar longer .		others others others others threatActor_name others others others others others others others others others others others others others others
The group builds malware for 32-bit and 64-bit Windows separately to support both platforms and have more variety in terms of compiled code .		others others others others others OS_name OS_name OS_name OS_name others others others others others others others others others others others others others others others
The Windows payloads distributed from the server ( nzssdm.com ) hosting the Mac malware have a CheckSelf export function , and one of them ( 668d5b5761755c9d061da74cb21a8b75 ) has the internal name ‘ battle64.dll ’ .		others others others others others others others others domain_evil others others others others others others others others others others others others others others others others md5 others others others others others others sample_name others others
From that point we managed to find additional Windows malware samples containing the CheckSelf export function and an internal name containing the word ‘ battle ’ .		others others others others others others others others others others others others others function others others others others others others others others others others string others others
These Windows malware samples were delivered using malicious HWP ( Korean Hangul Word Processor format ) documents exploiting a known PostScript vulnerability .		others others others others others others others others others others location others others others others others others others others others vul_aliases vul_aliases others
It should be noted that HWP documents are only popular among Korean users ( Hangul Word Processor was developed in South Korea ) and we have witnessed several attacks using the same method .		others others others others others others others others others others others location target_crowd others others others others others others others location location others others others others others others others others others others others others
It ’s no secret that Apple products are now very popular among successful internet startups and fintech companies , and this is why the malicious actor built and used macOS malware .		others others others others others others others others others others others others others others others others others others others others others others others others others person person others others others OS_name others others
While investigating earlier Lazarus incidents , we anticipated this actor would eventually expand its attacks to macOS .		others others others threatActor_name others others others others others person others others others others others others OS_name others
It appears that Lazarus is using the same developers to expand to other platforms , because some of the features have remained consistent as its malware evolves .		others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others
We ’d therefore like to ask Windows and macOS users to be more cautious and not fall victim to Lazarus .		others others others others others others others OS_name others OS_name others others others others others others others others others others threatActor_name others
If you ’re part of the booming cryptocurrency or technological startup industry , exercise extra caution when dealing with new third parties or installing software on your systems .		others others others others others others others others industry others industry industry industry others others others others others others others others others others others others others others others others others
It ’s best to check new software with an antivirus or at least use popular free virus-scanning services such as VirusTotal .		others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others sub_activity sub_activity sub_activity sub_activity sub_activity others others tool others
And never ‘ Enable Content ’ ( macro scripting ) in Microsoft Office documents received from new or untrusted sources .		others others others others others others others others others others others tool tool others others others others others others others others
Avoid being infected by fake or backdoored software from Lazarus – if you need to try out new applications , it ’s better do so offline or on an isolated network virtual machine which you can erase with a few clicks .		others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
We ’ll continue posting on Lazarus ’s latest tactics and tricks in our blog .		others others others others others others threatActor_name others others others others others others others others others others
File Hashes :  Testing office document :  29a37c6d9fae5664946c6607f351a8dc list.doc e9a6a945803722be1556fd120ee81199 list.doc a18bc8bc82bca8245838274907e64631 list.doc .		others others others others others others others md5 others md5 others md5 others others
macOS malware :  4345798b2a09fc782901e176bd0c69b6 .		others others others md5 others
PowerShell script :  cb713385655e9af0a2fc10da5c0256f5 test.ps1 e6d5363091e63e35490ad2d76b72e851 test.ps1 – It does not contain URLs .		others others others md5 others md5 others others others others others others others others
Da4981df65cc8b5263594bb71a0720a1 .		md5 others
Windows executable payload :  171b9135540f89bf727b690b9e587a4e wwtm.dat 668d5b5761755c9d061da74cb21a8b75 wwtm.dat ad3f966d48f18b5e7b23a579a926c7e8 .		others others others others md5 others md5 others md5 others
Manuscrypt payload :  35e38d023b253c0cd9bd3e16afc362a7 72fe869aa394ef0a62bb8324857770dd 86d3c1b354ce696e454c42d8dc6df1b7 5182e7a2037717f2f9bbf6ba298c48fb .		others others others md5 md5 md5 md5 others
Domains and Ips :  Compromised first stage C2 server :  http://bluecreekrobotics.com/wp-includes/common.php http://dev.microcravate.com/wp-includes/common.php http://dev.whatsyourcrunch.com/wp-includes/common.php http://enterpriseheroes.com.ng/wp-includes/common.php http://hrgp.asselsolutions.com/wp-includes/common.php https://baseballcharlemagnelegardeur.com/wp-content/languages/common.php https://bogorcenter.com/wp-content/themes/index2.php https://eventum.cwsdev3.bi.com/wp-includes/common.php https://streamf.ru/wp-content/index2.php https://towingoperations.com/chat/chat.php https://vinhsake.com//wp-content/uploads/index2.php https://www.tangowithcolette.com/pages/common.php .		others others others others others others others others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil others
Second stage C2 server :  http://115.28.160.20:443 – Compromised server .		others others others others others url_evil url_evil url_evil others others others others
Malware hosting server :  http://nzssdm.com/assets/wwtm.dat – Windows payload distribution URL http://nzssdm.com/assets/mt.dat – Mac payload distribution URL .		others others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil others