‘Operation Oceansalt’ Attacks South Korea, U.S., and Canada With Source Code From Chinese Hacker Group .		others attack_activity attack_activity others others location location others others others others location others others others others threatActor_name threatActor_name threatActor_name others
Release_Time : 2018-10-18 Report_URL : https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-oceansalt.pdf There are a few differences between the two implants in implementation ; these demonstrate that Oceansalt is not simply a recompilation of Seasalt source code.However , these differences also provide evidence that Oceansalt is an evolution of Seasalt .		others others others others others others others others others others others others others others others others others others others others others others others malware others others others others others others malware others others others others others others others others others malware others others others others malware others
Encoding : The Oceansalt implant uses an encoding and decoding mechanism before any data is sent to the control server .		others others others malware others others others tool tool tool tool others others others others others others others others others others
The Seasalt implant does not use this encoding and sends unencrypted data to the control server .		others malware others others others others others others others others others others others others others others others
Control server address : Oceansalt uses a hardcoded control server address to establish communication.Seasalt parses the control address from its binary by decoding data .		others others others others malware others others tool tool tool tool others sample_function others sample_function sample_function sample_function sample_function others others others others sub_activity sub_activity others
Based on the executable header information , Seasalt was compiled on March 30 , 2010 .		others others others others others others others malware others others others time time time time others
Oceansalt was compiled on June 1 , 2018 .		threatActor_name others others others time time time time others
Highlighting the compilation timestamps is important because , as our preceding analysis demonstrates , the samples have a high degree of code sharing .		others others others others others others others others others others others others others others others others others others others others others others others others
The code used to create the reverse shell in Oceansalt is an exact match with that of Comment Crew ’s Seasalt implant .		tool tool others others sample_function sample_function sample_function sample_function others malware others others others others others others others threatActor_name threatActor_name others others others others others
The mechanism for creating the reverse shell ( pipe-based inter-process communication for standard I/O handles ) is also seen in Comment Crew implants such as WebC2-CSON and WebC2-GREENCAT .		tool tool others sample_function sample_function tool tool others tool tool tool tool tool tool tool others others others others others malware malware malware others others malware others malware others
These matches lead us to believe that Oceansalt is based on Seasalt , because it reuses much of the code base developed 10 years ago .		reference_word reference_word others others others others others malware others others others malware others others reference_word others others others others tool others others others others others others
Seasalt ’s public disclosure in the Comment Crew report does not seem to have discouraged Oceansalt ’s developer .		malware others others others others others others threatActor_name threatActor_name others others others others others others others malware others others others others
We offer a comparative analysis of the following partially obfuscated implants against the initial Oceansalt sample and the Seasalt implant from Comment Crew .		others others others others others others others others others others others others others others malware others others others malware others others threatActor_name threatActor_name others
All the partially obfuscated Oceansalt implants have the following characteristics :  All implants were compiled during a three-day period : July 16–18 .		others others others others malware others others others others others others others others others others others others others others others time time others
All implants contain debug statements ( print logs ) written to the log file : C:\Users\Public\Videos\temp.log .		others others others others others others others others others others others others others others others others others others others
These debug statements begin with the timestamp and consist of the following keywords at the beginning of the debug message .		others tool tool others others others others others others others others others tool others others others others others others others others
All implants connected to the same control server IP address : 27.102.112.179 .		others others others others others others others others others others others IP_evil others
Although none of the partially obfuscated implants contain any additional capabilities ( as compared with the initial Oceansalt or Seasalt ) , some of the partially obfuscated implants are missing the reverse-shell capabilities :  Comment Crew : C1773E9CF8265693F37DF1A39E0CBBE2 .		others others others others others others others others others others others others others others others others others malware others malware others others others others others others others others others others others others others others threatActor_name threatActor_name others md5 others
Comment Crew : 0355C116C02B02C05D6E90A0B3DC107C .		threatActor_name threatActor_name others md5 others
Comment Crew : 74A50A5705E2AF736095B6B186D38DDF .		threatActor_name threatActor_name others md5 others
Comment Crew : 45C362F17C5DC8496E97D475562BEC4D .		threatActor_name threatActor_name others md5 others
Comment Crew : D14DD769C7F53ACEC482347F539EFDF4 .		threatActor_name threatActor_name others md5 others
Comment Crew : B2F6D9A62C63F61A6B33DC6520BFCCCD .		threatActor_name threatActor_name others md5 others
Comment Crew : 76C8DA4147B08E902809D1E80D96FBB4 .		threatActor_name threatActor_name others md5 others
We present evidence of source-code sharing between the Oceansalt authors and Comment Crew , based on our comparative analysis of the three sets of samples : Oceansalt , partially obfuscated Oceansalt , and Seasalt .		others others others others others others others others person person others threatActor_name threatActor_name others others others others others others others others others others others others others malware others others malware malware others others malware others
There is no possibility the attackers could have reinstrumented Seasalt by simply modifying the control server IP addresses :  The mechanism for obtaining the address in Seasalt is different from Oceansalt ’s .		others others others others others person others others others malware others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others tool tool others sample_function sample_function sample_function others malware others others others malware others others others
Seasalt looks for encoded data at the end of the binary , decodes this data into tokens separated by the marker “ $ , ” and obtains the control server information .		malware sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others sub_activity sub_activity sub_activity sub_activity sub_activity others
Oceansalt implants have the control server IP addresses and port numbers hardcoded as plaintext strings in the binaries .		malware others others others sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others others others others others others others
Some of the partially obfuscated Oceansalt implants are missing the reverse-shell capability .		others others others others others malware others others others others others others others
All other capabilities and command codes are similar .		others others others others others others others others others
Modifying capabilities in this fashion is possible only with access to the source code of Seasalt .		others others others others others others others others others others others others others others others malware others
The presence of these debug strings also indicates that the authors who modified the source code may have used these samples to perform their initial testing before obfuscating and releasing the implants to their victims , without scrubbing the debug strings .		others others others others others others others others others others person others others others others others others others others reference_word reference_word others sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others
The Oceansalt implant 531dee019792a089a4589c2cce3dac95 ( compiled June ) contains a few key features that indicate compilation from the source code of Seasalt :  Oceansalt is 76KB , a minimal on-disk footprint that is harder to detect than larger malware .		others malware others md5 others others time others others others others others others others others others others others others others others malware others malware others others others others others others others others others others others others others others others others
The implant has a variety of capabilities for capturing data from the victim ’s machine using a structured command system .		reference_word reference_word others others others others others others sample_function sample_function others others others others others others others tool tool tool tool others
From our research we have determined that this implant is a first-stage component .		others others others others others others others reference_word reference_word others others others others others
Further stages are downloaded through its commands .		others others others others others others others others
Oceansalt also supports commands enabling the attacker to take various actions on the victim ’s system .		malware others others others others others person others sub_activity sub_activity sub_activity others others others others others others others
Oceansalt starts by trying to connect to its control server at 158.69.131.78:8080 .		malware others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Operates the reverse shell established using the previous command code .		others others tool tool others others others tool tool tool others
Contains the commands sent by the control server to the reverse shell that will be executed by cmd.exe on the infected endpoint .		others others others others others others others others others others others others others others others sub_activity sub_activity sub_activity others others others others others
Once the command has been executed , the output is read from cmd.exe via a pipe and sent to the control server .		others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others
Closes the reverse shell by closing handles to the pipes created for the shell ’s inter-process communication .		others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others
Tests receive and send capabilities of the implant by receiving data ( 0x7 bytes ) from the control server and sending it back .		others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others
Oceansalt has no persistence capabilities to remain on the endpoint after the system reboots .		malware others others others others others others others others others others others others others others
This lack suggests other components in the infection chain may ensure persistence and carry out other malicious activities .		others others others others others others others others others others others others others others others others others others others
Based on our analysis , the McAfee Advanced Threat Research team has named this global threat Operation Oceansalt .		others others others others others others security_team security_team security_team security_team security_team others others others others others attack_activity attack_activity others
This operation has focused on targets in South Korea and other countries with new malware that has roots in Comment Crew activity from 2010 .		reference_word reference_word others others others others others location location others others others others others others others others others others threatActor_name threatActor_name others others time others
Our research shows that Comment Crew ’s malware in part lives on in different forms employed by another advanced persistent threat group operating primarily against South Korea .		others others others others threatActor_name threatActor_name others others others others others others others others others others others others others others others others others others others others location location others
This research represents how threat actors including nation-states might collaborate on their campaigns .		others others others others others others others others others others others others others others
McAfee continues to monitor the threat landscape in Asia and around the world to track the evolution of known groups and changes to their techniques .		company others others counter_measure counter_measure counter_measure counter_measure others location others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function others
Comment Crew : 158.69.131.78 .		threatActor_name threatActor_name others IP_evil others
Comment Crew : 172.81.132.62 .		threatActor_name threatActor_name others IP_evil others
Comment Crew : 27.102.112.179 .		threatActor_name threatActor_name others IP_evil others
Comment Crew : 211.104.160.196 .		threatActor_name threatActor_name others IP_evil others
Comment Crew : fc121db04067cffbed04d7403c1d222d376fa7ba .		threatActor_name threatActor_name others sha1 others
Comment Crew : 832d5e6ebd9808279ee3e59ba4b5b0e884b859a5 .		threatActor_name threatActor_name others sha1 others
Comment Crew : be4fbb5a4b32db20a914cad5701f5c7ba51571b7 .		threatActor_name threatActor_name others sha1 others
Comment Crew : 1f70715e86a2fcc1437926ecfaeadc53ddce41c9 .		threatActor_name threatActor_name others sha1 others
Comment Crew : dd3fb2750da3e8fc889cd1611117b02d49cf17f7 .		threatActor_name threatActor_name others sha1 others
Comment Crew : 583879cfaf735fa446be5bfcbcc9e580bf542c8c .		threatActor_name threatActor_name others sha1 others
Comment Crew : ec9a9d431fd69e23a5b770bf03fe0fb5a21c0c36 .		threatActor_name threatActor_name others sha1 others
Comment Crew : d72bc671583801c3c65ac1a96bb75c6026e06a73 .		threatActor_name threatActor_name others sha1 others