RevengeHotels : cybercrime targeting hotel front desks worldwide Release_Time :  2019-11-28 Report_URL :  https://securelist.com/revengehotels/95229/ RevengeHotels is a targeted cybercrime malware campaign against hotels , hostels , hospitality and tourism companies , mainly , but not exclusively , located in Brazil .		others others others others others others others others others others others others others others others others threatActor_name others others others others others others others industry others industry others target_crowd target_crowd target_crowd target_crowd others others others others others others others others others location others
We have confirmed more than 20 hotels that are victims of the group , located in eight states in Brazil , but also in other countries such as Argentina , Bolivia , Chile , Costa Rica , France , Italy , Mexico , Portugal , Spain , Thailand and Turkey .		others others others others others target_crowd target_crowd others others others others others others others others others others others others location others others others others others others others others location others location others location others location location others location others location others location others location others location others location others location others
The goal of the campaign is to capture credit card data from guests and travelers stored in hotel systems , as well as credit card data received from popular online travel agencies ( OTAs ) such as Booking.com .		others others others reference_word reference_word others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others company others others others domain others
The main attack vector is via email with crafted Word , Excel or PDF documents attached .		others others others others others others tool others others tool others tool others tool others others others
Some of them exploit CVE-2017-0199 , loading it using VBS and PowerShell scripts and then installing customized versions of RevengeRAT , NjRAT , NanoCoreRAT , 888 RAT and other custom malware such as ProCC in the victim ’s machine .		others others reference_word others vulnerability_cve others others others others program_language others tool others others others others others others others malware others malware others malware others malware malware others others others others others others malware others others others others others others others
The group has been active since 2015 , but increased its attacks in 2019 .		reference_word reference_word others others others others time others others others others others others time others
In our research , we were also able to track two groups targeting the hospitality sector , using separate but similar infrastructure , tools and techniques .		others others others others others others others others others others others others others others industry industry others others others others others others others others others others others
PaloAlto has already written about one of them .		tool others others others others others others others others
We named the first group RevengeHotels , and the second ProCC .		others others others others others threatActor_name others others others others threatActor_name others
These groups use a lot of social engineering in their attacks , asking for a quote from what appears to be a government entity or private company wanting to make a reservation for a large number of people .		reference_word reference_word sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Their infrastructure also relies on the use of dynamic DNS services pointing to commercial hosting and self-hosted servers .		others others others others others others others others others protocol others others others others others others others others others
They also sell credentials from the affected systems , allowing other cybercriminals to have remote access to hotel front desks infected by the campaign .		reference_word others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others
We monitored the activities of these groups and the new malware they are creating for over a year .		others others others others others reference_word reference_word others others others others others others others others others others others others
With a high degree of confidence , we can confirm that at least two distinct groups are focused on attacking this sector ; there is also a third group , though it is unclear if its focus is solely on this sector or if carries out other types of attacks .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
One of the tactics used in operations by these groups is highly targeted spear-phishing messages .		others others others others others others others others reference_word reference_word others others others attack_activity others others
They register typo-squatting domains , impersonating legitimate companies .		reference_word sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others
The emails are well written , with an abundance of detail .		others tool others others others others others others others others others others
They explain why the company has chosen to book that particular hotel .		others others others others others others others others others others others others others
By checking the sender information , it ’s possible to determine whether the company actually exists .		others others others others others others others others others others others others others others others others others others
However , there is a small difference between the domain used to send the email and the real one .		others others others others others others others others others others others others others others tool others others others others others
This spear-phishing message , written in Portuguese , has a malicious file attached misusing the name of a real attorney office , while the domain sender of the message was registered one day before , using a typo-squatting domain .		others attack_activity others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity others
The group goes further in its social engineering effort : to convince the hotel personnel about the legitimacy of their request , a copy of the National Registry of Legal Entities card ( CNPJ ) is attached to the quotation .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The attached file , Reserva Advogados Associados.docx ( Attorneys Associates Reservation.docx ) , is a malicious Word file that drops a remote OLE object via template injection to execute macro code .		others others others others sample_name sample_name sample_name others sample_name sample_name sample_name others others others others others tool others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others
The macro code inside the remote OLE document contains PowerShell commands that download and execute the final payload .		others others others others others others tool others others tool others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
In the RevengeHotels campaign , the downloaded files are .NET binaries protected with the Yoda Obfuscator .		others others threatActor_name others others others others others others sample_name others others others others tool tool others
After unpacking them , the code is recognizable as the commercial RAT RevengeRAT .		others others others others others others others others others others others malware malware others
An additional module written by the group called ScreenBooking is used to capture credit card data .		others others others others others others others others tool others others others attack_goal attack_goal attack_goal attack_goal others
It monitors whether the user is browsing the web page .		others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
In the initial versions , back in 2016 , the downloaded files from RevengeHotels campaigns were divided into two modules : a backdoor and a module to capture screenshots .		others others others others others others others time others others others others others threatActor_name others others others others others others others others others others others others others others others others
Recently we noticed that these modules had been merged into a single backdoor module able to collect data from clipboard and capture screenshots .		others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
In this example , the webpage that the attacker is monitoring is booking.com ( more specifically , the page containing the card details ) .		others others others others others others others others others others others others domain others others others others others others others others others others others others
The code is specifically looking for data in Portuguese and English , allowing the attackers to steal credit card data from web pages written in these languages .		others others others others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others
In the ProCC campaigns , the downloaded files are Delphi binaries .		others others threatActor_name others others others others others others tool others others
The backdoor installed in the machine is more customized than that used by RevengeHotels : it ’s developed from scratch and is able to collect data from the clipboard and printer spooler , and capture screenshots .		others others others others others others others others others others others others others threatActor_name others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others sub_activity sub_activity others
Because the personnel in charge of confirming reservations usually need to pull credit card data from OTA websites , it ’s possible to collect card numbers by monitoring the clipboard and the documents sent to the printer .		others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity others company others others others others others others others attack_goal attack_goal attack_goal others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
According to the relevant underground forums and messaging groups , these criminals also infect front desk machines in order to capture credentials from the hotel administration software ; they can then steal credit card details from it too .		others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others attack_goal attack_goal attack_goal attack_goal others others others others
Some criminals also sell remote access to these systems , acting as a concierge for other cybercriminals by giving them permanent access to steal new data by themselves .		others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Some Brazilian criminals tout credit card data extracted from a hotel ’s system as high quality and reliable because it was extracted from a trusted source , i.e.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others tool others
, a hotel administration system .		others others others others others others
The majority of the victims are associated with the hospitality sector .		others others others others others others others others others industry industry others
Based on the routines used , we estimate that this attack has a global reach .		others others others others others others others others others others others others others others others others
However , based on our telemetry data , we can only confirm victims in the following countries : Argentina , Bolivia , Brazil , Chile , Costa Rica , France , Italy , Mexico , Portugal , Spain , Thailand and Turkey .		others others others others others others others others others others others others others others others others others others location others location others location others location others location location others location others location others location others location others location others location others location others
Based on data extracted from Bit.ly statistics , we can see that potential victims from many other countries have at least accessed the malicious link .		others others others others others sample_name others others others others others others others others others others others others others others others others others others others others
This data suggests that the number of countries with potential victims is higher than our telemetry has registered .		others others others others others others others others others others others others others others others others others others others
RevengeHotels is a campaign that has been active since at least 2015 , revealing different groups using traditional RAT malware to infect businesses in the hospitality sector .		threatActor_name others others others others others others others others others others time others others others others others others malware others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
While there is a marked interest in Brazilian victims , our telemetry shows that their reach has extended to other countries in Latin America and beyond .		others others others others others others others target_crowd target_crowd others others others others others others others others others others others others others location location others others others
The use of spear-phishing emails , malicious documents and RAT malware is yielding significant results for at least two groups we have identified in this campaign .		others others others attack_activity tool others others others others malware others others others others others others others others others others others others others others others others others
Other threat actors may also be part of this wave of attacks , though there is no confirmation at the current time .		others others others others others others others others others others others others others others others others others others others others others others others
If you want to be a savvy and safe traveler , it ’s highly recommended to use a virtual payment card for reservations made via OTAs , as these cards normally expire after one charge .		others others others others others others others others others others others others others others others others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure company others others others others others others others others others others
While paying for your reservation or checking out at a hotel , it ’s a good idea to use a virtual wallet such as Apple Pay , Google Pay , etc .		others others others others others others others others others others others others others others others others others others others counter_measure counter_measure counter_measure counter_measure others others tool tool others tool tool others others others
If this is not possible , use a secondary or less important credit card , as you never know if the system at the hotel is clean , even if the rooms are… All Kaspersky products detect this threat as :  HEUR : Backdoor.MSIL.Revenge.gen .		others others others others others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others others others others others others others others others others others others others others others others others others others others security_team others others others others others others malware others others others
HEUR : Trojan-Downloader.MSIL.RevengeHotels.gen .		malware others others others
HEUR : Trojan.MSIL.RevengeHotels.gen .		malware others others others
HEUR : Trojan.Win32.RevengeHotels.gen .		malware others others others
HEUR : Trojan.Script.RevengeHotels.gen .		malware others others others
RevengeHotels : 74440d5d0e6ae9b9a03d06dd61718f66 .		threatActor_name others md5 others
RevengeHotels : e675bdf6557350a02f15c14f386fcc47 .		threatActor_name others md5 others
RevengeHotels : df632e25c32e8f8ad75ed3c50dd1cd47 .		threatActor_name others md5 others
RevengeHotels : a089efd7dd9180f9b726594bb6cf81ae .		threatActor_name others md5 others
RevengeHotels : 81701c891a1766c51c74bcfaf285854b .		threatActor_name others md5 others
For a full list of IoCs as well as the YARA rules and intelligence report for this campaign , please visit the Kaspersky Threat Intelligence Portal : https://tip.kaspersky.com/ .		others others others others others others others others others others tool others others others others others others others others others others others security_team others others others others domain domain domain others