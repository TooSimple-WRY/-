OPERATION COBALT KITTY : A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP .		threatActor_name threatActor_name threatActor_name others others others others others location others others others others threatActor_name threatActor_name others
Release_Time : 2017-05-24 .		others others others others
Report_URL : https://www.cybereason.com/blog/operation-cobalt-kitty-apt .		others others others others others others
Dubbed Operation Cobalt Kitty , the APT targeted a global corporation based in Asia with the goal of stealing proprietary business information .		threatActor_name threatActor_name threatActor_name threatActor_name others others others others others target_crowd target_crowd others others location others others others others attack_goal attack_goal attack_goal attack_goal others
The threat actor targeted the company ’s top-level management by using spear-phishing attacks as the initial penetration vector , ultimately compromising the computers of vice presidents , senior directors and other key personnel in the operational departments .		others others person others others target_crowd target_crowd target_crowd target_crowd target_crowd others others attack_activity others others others others others others others others others others target_crowd target_crowd target_crowd target_crowd others target_crowd target_crowd others target_crowd target_crowd target_crowd target_crowd target_crowd target_crowd target_crowd others
During Operation Cobalt Kitty , the attackers compromised more than 40 PCs and servers , including the domain controller , file servers , Web application server and database server .		others threatActor_name threatActor_name threatActor_name others others person others others others target_crowd target_crowd target_crowd target_crowd others others others target_crowd target_crowd others target_crowd target_crowd others target_crowd target_crowd target_crowd others target_crowd target_crowd others
Want to hear about another high-impact operation?		others others others others others others others others
SIGN UP FOR THE OPERATION SOFT CELL WEBINAR Forensic artifacts revealed that the attackers persisted on the network for at least a year before Cybereason was deployed .		others others others others security_team security_team security_team security_team others others others others others person others others others others others others others others others others security_team others others others
The adversary proved very adaptive and responded to company ’s security measures by periodically changing tools , techniques and procedures ( TTPs ) , allowing them to persist on the network for such an extensive period of time .		others person others others others others others others others others others others others others others others tool tool tool tool tool others reference_word others others others others others attack_goal attack_goal attack_goal attack_goal others others others others others others others others
Over 80 payloads and numerous domains were observed in this operation - all of which were undetected by traditional security products deployed in the company ’s environment at the time of the attack .		others others target_crowd others others target_crowd others others others reference_word reference_word others others others reference_word others others others others others others others others others others others others others others others others others others others others
The attackers arsenal consisted of modified publicly-available tools as well as six undocumented custom-built tools , which Cybereason considers the threat actor ’s signature tools .		others person others others others others tool tool others others others reference_word reference_word others tool others reference_word security_team others others others person others others others others others
Among these tools are two backdoors that exploited DLL sideloading attack in Microsoft , Google and Kaspersky applications .		others reference_word reference_word others others others others others tool tool others others company others company others security_team security_team others
In addition , they developed a novel and stealthy backdoor that targets Microsoft Outlook for command-and-control channel and data exfiltration .		others others others reference_word others others sub_activity sub_activity sub_activity sub_activity others others company company others attack_goal attack_goal others attack_goal attack_goal others
Based on the tools , modus operandi and IOCs ( indicators of compromise ) observed in Operation Cobalt Kitty ,  Cybereason attributes this large-scale cyber espionage APT to the “ OceanLotus Group ” ( which is also known as , APT-C-00 , SeaLotus and APT32 ) .		others others reference_word reference_word others others others others tool others reference_word reference_word reference_word others others others threatActor_name threatActor_name threatActor_name others security_team others others others others others others others others others threatActor_name threatActor_name others others others others others others others others threatActor_aliases others threatActor_aliases others threatActor_aliases others others
For detailed information tying Operation Cobalt Kitty to the OceanLotus Group , please see our Attacker ’s Arsenal and Threat Actor Profile sections .		others others others others threatActor_name threatActor_name threatActor_name others others threatActor_name threatActor_name others others others others others others others others others others others others others others
Cybereason also attributes the recently reported Backdoor.Win32.Denis to the OceanLotus Group , which at the time of this report ’s writing , had not been officially linked to this threat actor .		security_team others others others others others others others others threatActor_name threatActor_name others others others others others others others others others others others others others others others others others others others others others others
Finally , this report offers a rare glimpse into what a cyber espionage APT looks like " under-the-hood " .		others others others others others others others others others others others others others others others others others others others others
Cybereason was able to monitor and detect the entire attack lifecycle , from infiltration to exfiltration and all the steps in between .		security_team others others others others others others others others others others others others others others others others others others others others others others
Our report contains the following detailed sections ( PDF ) :  Cobalt Kitty Lifecycle : A step-by-step analysis Cobalt Kitty Attacker ’s Arsenal : Deep dive into the tools used in the APT Cobalt Kitty Threat Actor Profile and Indicators of Compromise HIGH-LEVEL ATTACK OUTLINE :  A CAT-AND-MOUSE GAME IN FOUR ACTS The following sections outline the four phases of the attack as observed by Cybereason ’s analysts , who were called to investigate the environment after the company ’s IT department suspected that their network was breached but could not trace the source .		others others others others others others others others others others others malware malware malware others others others others malware malware malware malware malware malware others others others others others others others others others others malware malware malware malware malware malware malware malware malware malware malware malware others others others others others others others others others others others others others others others others others others others others security_team others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Based on the forensic evidence collected from the environment , phase one was the continuation of the original attack that began about a year before Cybereason was deployed in the environment .		others others others others others others others others others others others others others others others others others others others others others others others others others security_team others others others others others others
During that phase , the threat actor operated a fileless PowerShell-based infrastructure , using customized PowerShell payloads taken from known offensive frameworks such as Cobalt Strike , PowerSploit and Nishang .		others others others others others others person sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity others others others others others others others tool tool others tool others tool others
The initial penetration vector was carried out by social engineering .		others others others others others others others others others others others
Carefully selected group of employees received spear-phishing emails , containing either links to malicious sites or weaponized Word documents .		others others others others others others attack_activity others others others others others others others others others sub_activity sub_activity sub_activity others
These documents contained malicious macros that created persistence on the compromised machine using two scheduled tasks , whose purpose was to download secondary payloads ( mainly Cobalt Strike Beacon ) :  In the first phase of the attack , the attackers used a fileless in-memory payload delivery infrastructure consisting of the following components :  VBS and PowerShell-based loaders The attackers dropped Visual Basic and PowerShell scripts in folders that they created under the ProgramData ( a hidden folder , by default ) .		reference_word reference_word others others others others others others others others others others others others others others others reference_word others others others attack_goal attack_goal attack_goal others others tool tool tool others others others others others others others others others others others others others others others others others others others others others others others others others tool others sub_activity sub_activity others person others program_language program_language others sub_activity sub_activity others others others others attack_goal attack_goal attack_goal attack_goal others others others others others others others others others
The attackers created persistence using Windows ’ registry , services and scheduled tasks .		others person others others others tool tool tool others tool others tool tool others
This persistence mechanism ensured that the loader scripts would execute either at startup or at predetermined intervals .		others others others others others others others others others others others others others others others others others others
Values found in Windows ’ Registry : the VBS scripts are executed by Windows ’ Wscript at startup :  The .vbs scripts as well as the .txt files contain the loader ’s script , which launches PowerShell with a base64 encoded command , which either loads another PowerShell script ( e.g Cobalt Strike Beacon ) or fetches a payload from the command-and-control ( C&C ) server :  In-memory fileless payloads from C&C servers The payloads served by the C&C servers are mostly PowerShell scripts with embedded base64-encoded payloads ( Metasploit and Cobalt Strike payloads ) :  The decoded payload is a shellcode , whose purpose is to retrieve a Cobalt Strike Beacon from the C&C server :  Less than 48 hours after Cybereason alerted the company about the breach , the attackers started to change their approach and almost completely abandoned the PowerShell infrastructure that they had been using - replacing it with sophisticated custom-built backdoors .		others others others OS_name tool tool others others tool others others others others OS_name tool tool others others others others others others others others others others others others others others others others others others others others others tool others others others others others others others others others others tool others others others tool tool tool others others others others others others others protocol others reference_word reference_word reference_word others others others others others others others protocol protocol protocol others others others others others others protocol protocol protocol others others others sub_activity sub_activity others others others others others tool others tool tool others others others others others others others others tool others reference_word others others others attack_goal attack_goal tool tool tool others others protocol protocol protocol others others others others others others others security_team others others others others others others others others person others others sub_activity sub_activity sub_activity others others others others others sub_activity sub_activity others others others others others others others others others others others others others
The attackers ’ remarkable ability to quickly adapt demonstrated their skill and familiarity with and command of the company ’s network and its operations .		others others others others others others others others others others others others others others others others others others others others others others others others others others
The attackers most likely replaced the PowerShell infrastructure after the company used both Windows Group Policy Object ( GPO ) and Cybereason ’s execution prevention feature to prevent PowerShell execution .		others person others others sub_activity sub_activity tool sub_activity others others others others others tool tool tool tool others reference_word others others security_team others others others others others others others others others others
After realizing that the PowerShell infrastructure had been discovered , the attackers had to quickly replace it to maintain persistence and continue the operation .		others others others others sub_activity sub_activity others others others others others person others others others others others others attack_goal attack_goal others attack_goal attack_goal attack_goal others
Replacing this infrastructure in 48 hours suggests that the threat actors were prepared for such a scenario .		others others others others others others others others others others others others others others others others others others
During the second phase of the attack , the attackers introduced two sophisticated backdoors that they attempted to deploy on selected targets .		others others others others others others others others others person sub_activity sub_activity sub_activity sub_activity others others others others attack_goal attack_goal attack_goal attack_goal others
The introduction of the backdoors is a key turning point in the investigation since it demonstrated the threat actor ’s resourcefulness and skill-set .		others others others others others others others others others others others others others others others others others others others others others others others others others
At the time of the attack , these backdoors were undetected and undocumented by any security vendor .		others others others others others others others others others others others others others others others others others others
Recently , Kaspersky researchers identified a variant of one of the backdoors as Backdoor.Win32.Denis .		others others security_team others others others others others others others others others others others others
The attackers had to make sure that they remained undetected so the backdoors were designed to be as stealthy as possible .		others person others others others others others others attack_goal attack_goal others others others others others others others others others others others others
To avoid being discovered , the malware authors used these techniques :  Backdoors exploiting DLL hijacking against trusted applications The backdoor exploited a vulnerability called “ DLL hijacking ” in order to “ hide ” the malware inside trusted software .		others attack_goal attack_goal attack_goal others others others person others others others others others others vulnerability_cve vulnerability_cve others others others others others others others others others others vulnerability_cve vulnerability_cve others others others others others others others others others others others others others
This technique exploits a security vulnerability found in legitimate software , which allows the attackers to load a fake DLL and execute its malicious code .		reference_word reference_word others others others others others others others others others others others others person others attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal attack_goal others
Please see an analysis of the backdoors in the Attacker ’s Arsenal section .		others others others others others others others others others others others others others others others
The attackers exploited this vulnerability against the following trusted applications :  By exploiting legitimate software , the attackers bypassed application whitelisting and legitimate security software , allowing them to continue their operations without raising any suspicions .		others others others others others others others others others others others others others others others others others person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
DNS Tunneling as C2 channel - In attempt to overcome network filtering solutions , the attackers implemented a stealthier C2 communication method , using “ DNS Tunneling ” – a method of C2 communicating and data exfiltration using the DNS protocol .		protocol others others protocol others others others others others attack_goal attack_goal attack_goal attack_goal others others person sub_activity sub_activity sub_activity protocol sub_activity sub_activity others others others sub_activity sub_activity others others others others others protocol others others others others others others protocol others others
To ensure that the DNS traffic would not be filtered , the attackers configured the backdoor to communicate with Google and OpenDNS DNS servers , since most organizations and security products will not filter traffic to those two major DNS services .		others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others person others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others others others others others others others others others others others protocol others others
The screenshot below shows the traffic generated by the backdoor and demonstrates DNS Tunneling for C2 communication .		others others others others others others others others others others others others protocol tool others protocol others others
As shown , while the destination IP is “ 8.8.8.8 ” – Google ’s DNS server – the malicious domain is “ hiding ” inside the DNS packet :  In the third phase of the operation , the attackers harvested credentials stored on the compromised machines and performed lateral movement and infected new machines .		others others others others others others protocol others others IP others others company others others protocol others others others others others others others others others others others protocol others others others others others others others others others others others person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others
The attackers also introduced a very rare and stealthy technique to communicate with their servers and exfiltrate data using Microsoft Outlook .		others person others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal company attack_goal others
In a relentless attempt to remain undetected , the attackers devised a very stealthy C2 channel that is hard to detect since it leverages an email-based C2 channel .		others others others others others attack_goal attack_goal others others person sub_activity sub_activity sub_activity sub_activity protocol sub_activity others others others others others others others others others others protocol others others
The attackers installed a backdoor macro in Microsoft Outlook that enabled them to execute commands , deploy their tools and steal valuable data from the compromised machines .		others person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others attack_goal attack_goal others attack_goal reference_word attack_goal others attack_goal attack_goal attack_goal others others others others others
For a detailed analysis of the Outlook backdoor , please see the Attacker ’s Arsenal section .		others others others others others others malware others others others others others others others others others others others
This technique works as follows :  The malicious macro scans the victim ’s Outlook inbox and looks for the strings “ $$cpte ” and “ $$ecpte ” .		others others others others others others others malware malware sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity others string string string others others others string string string others others
Then the macro will open a CMD shell that will execute whatever instruction / command is in between the strings .		others others malware others sub_activity sub_activity tool sub_activity others others sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others
The macro deletes the message from inbox to ensure minimal risk of exposure .		others malware sub_activity sub_activity sub_activity sub_activity sub_activity others attack_goal attack_goal attack_goal attack_goal attack_goal others
The macro searches for the special strings in the “ Deleted Items ” folder to find the attacker ’s email address and sends the data back to the attackers via email .		others malware others others others others others others others others tool tool others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal attack_goal others others person others others others
Lastly , the macro will delete any evidence of the emails received or sent by the attackers .		others others others malware others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity others
The attackers used the famous Mimikatz credential dumping tool as their main tool to obtain credentials including user passwords , NTLM hashes and Kerberos tickets .		others person others others others tool others others others others others others others others attack_goal attack_goal others others others others protocol others others protocol others others
Mimikatz is a very popular tool and is detected by most antivirus vendors and other security products .		tool others others others others others others others others others others others others others others others others others
Therefore , the attackers used over 10 different customized Mimikatz payloads , which were obfuscated and packed in a way that allowed them to evade antivirus detection .		others others others person sub_activity sub_activity sub_activity sub_activity sub_activity tool sub_activity others others others others others others others others others others others others others attack_goal attack_goal attack_goal others
The following are examples of Mimikatz command line arguments detected during the attack :   The stolen credentials were used to infect more machines , leveraging Windows built-in tools as well as pass-the-ticket and pass-the-hash attacks .		others others others others others tool others others others others others others others others others others others others others others attack_goal attack_goal attack_goal others others tool tool tool others others others attack_goal others attack_goal attack_goal others
After a four week lull and no apparent malicious activity , the attackers returned to the scene and introduced new and improved tools aimed at bypassing the security mitigations that were implemented by the company ’s IT team .		others others others others others others others others others others others others person others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others attack_goal attack_goal attack_goal attack_goal others others others others others others others others others others others
These tools and methods mainly allowed them to bypass the PowerShell execution restrictions and password dumping mitigations .		reference_word reference_word reference_word reference_word others others others others attack_goal attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal others
During that phase , Cybereason found a compromised server that was used as the main attacking machine , where the attackers stored their arsenal in a network share , which made it easier to spread their tools to other machines on the network .		others others others others security_team others others others others others others others others others others others others others others others person others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others
The attackers ’ arsenal consisted :  New variants of Denis and Goopy backdoors PowerShell Restriction Bypass Tool - Adapted from PSUnlock Github project .		others others others others others others others others others malware others malware others tool tool tool tool others others others others others others others
PowerShell Cobalt Strike Beacon - New payload + new C2 domain PowerShell Obfuscator - All the new PowerShell payloads are obfuscated using a publicly available script adapted from a Daniel Bohannon ’s GitHub project .		tool tool tool tool others others others others others protocol others tool tool others others others others tool others others others others others others others others others others others person person others others others others others
HookPasswordChange - Inspired by tools found on GitHub , this tool alerts the attackers if a password has been changed .		tool others others others others others others others others others others others others others others others others others others others others
Using this tool , the attackers could overcome a password reset .		others reference_word reference_word others others others others attack_goal attack_goal attack_goal attack_goal others
The attackers modified their tool .		others person sub_activity sub_activity sub_activity others
Customized Windows Credentials Dumper - A PowerShell password dumper that is based on a known password dumping tool , using PowerShell bypass and reflective loading .		tool tool tool tool others others tool others others others others others others others others others others others others others tool others others others others others
The attackers specifically used it to obtain Outlook passwords .		others person others others reference_word others attack_goal attack_goal attack_goal others
Customized Outlook Credentials Dumper - Inspired by known Outlook credentials dumpers .		tool tool tool tool others others others others malware others others others
Mimikatz - PowerShell and Binary versions , with multiple layers of obfuscation .		tool others tool others tool others others others others others others others others
Please see the Attacker ’s Arsenal section for detailed analysis of the tools .		others others others others others others others others others others others others others others others
An analysis of this arsenal shows that the attackers went out of their way to restore the PowerShell-based infrastructure , even though it had already been detected and shut down once .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The attackers ’ preference to use a fileless infrastructure specifically in conjunction with Cobalt Strike is very evident .		others person others others others others others sub_activity sub_activity others others others others tool tool others others others others
This could suggest that the attackers preferred to use known tools that are more expendable rather than using their own custom-built tools , which were used as a last resort .		reference_word others others others others person sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others
Operation Cobalt Kitty was a major cyber espionage APT that targeted a global corporation in Asia and was carried out by the OceanLotus Group .		threatActor_name threatActor_name threatActor_name others others others others others others others others others threatActor_name threatActor_name others location others others others others others others threatActor_name threatActor_name others
The analysis of this APT proves how determined and motivated the attackers were .		others others others reference_word reference_word others others others others others others person others others
They continuously changed techniques and upgraded their arsenal to remain under the radar .		reference_word others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others attack_goal attack_goal attack_goal attack_goal others
In fact , they never gave up , even when the attack was exposed and shut down by the defenders .		others others others reference_word others others others others others others others others others others others others others others others others others
During the investigation of Operation Cobalt Kitty , Cybereason uncovered and analyzed new tools in the OceanLotus Group ’s attack arsenal , such as :  New backdoor ( “ Goopy ” ) using HTTP and DNS Tunneling for C2 communication .		others others others others threatActor_name threatActor_name threatActor_name others security_team others others others others others others others threatActor_name threatActor_name others others others others others others others others others others others others malware others others others protocol others protocol protocol others attack_goal attack_goal others
Undocumented backdoor that used Outlook for C2 communication and data exfiltration .		others others others others malware others attack_goal attack_goal others attack_goal attack_goal others
Backdoors exploiting DLL sideloading attacks in legitimate applications from Microsoft , Google and Kaspersky .		others others tool others others others others others others company others company others security_team others
Three customized credential dumping tools , which are inspired by known tools .		others others others others others others others others others others others others others
In addition , Cybereason uncovered new variants of the “ Denis ” backdoor and managed to attribute the backdoor to the OceanLotus Group - a connection that had not been publicly reported before .		others others others security_team others others others others others others malware others others others others others others others others others others threatActor_name threatActor_name others others others others others others others others others others others
This report provides a rare deep dive into a sophisticated APT that was carried out by one of the most fascinating groups operating in Asia .		others others others others others others others others others others others others others others others others reference_word reference_word reference_word reference_word reference_word reference_word others others location others
The ability to closely monitor and detect the stages of an entire APT lifecycle - from initial infiltration to data exfiltration - is far from trivial .		others others others others others others others others others others others others others others others others others others others others others others others others others others others
The fact that most of the attackers ’ tools were not detected by the antivirus software and other security products deployed in the company ’s environment before Cybereason , is not surprising .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others security_team others others others others others
The attackers obviously invested significant time and effort in keeping the operation undetected , striving to evade antivirus detection .		others person others sub_activity sub_activity others others others others sub_activity sub_activity sub_activity sub_activity others others others attack_goal attack_goal attack_goal others
As the investigation progressed , some of the IOCs observed in Operation Cobalt Kitty started to emerge in the wild , and recently some were even reported being used in other campaigns .		others others others others others others others others malware others others threatActor_name threatActor_name threatActor_name others others attack_goal attack_goal attack_goal attack_goal others others others others others others others others others others others others others
It is important to remember , however , that IOCs have a tendency to change over time .		others others others others others others others others others malware others others others others others others others others
Therefore , understanding a threat actor ’s behavioral patterns is essential in combatting modern and sophisticated APTs .		others others others others others others others others others others others others others others others others others others others
The modus operandi and tools served as behavioral fingerprints also played an important role in tying Operation Cobalt Kitty to the OceanLotus Group .		others others others others others others others others others others others others others others others others threatActor_name threatActor_name threatActor_name others others threatActor_name threatActor_name others
Lastly , our research provides an important testimony to the capabilities and working methods of the OceanLotus Group .		others others others others others others others others others others others others others others others others threatActor_name threatActor_name others
Operation Cobalt Kitty is unique in many ways , nonetheless , it is still just one link in the group ’s ever-growing chain of APT campaigns .		threatActor_name threatActor_name threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others
Orchestrating multiple APT campaigns in parallel and attacking a broad spectrum of targets takes an incredible amount of resources , time , manpower and motivation .		others others others others others others others others others others others others others others others others others others others others others others others others others others
This combination is likely to be more common among nation-state actors .		others others others others others others others others others others others others
While the are many rumours and speculations circulating in the InfoSec community , at the time of writing , there was no publicly available evidence that can confirm that the OceanLotus Group is a nation-state threat actor .		others others others others others others others others others others company others others others others others others others others others others others others others others others others others others others threatActor_name threatActor_name others others others others others others