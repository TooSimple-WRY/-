IXESHE An APT Campaign .
Release_Time :  2012
Report_URL :  https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf .
The majority of the IXESHE campaign ’s C&C servers were based in Taiwan and the United States .
This is , however , not an indicator of attribution .
It is not possible to determine where the attackers are based solely on where their C&C infrastructures are located .
In addition , not all of the C&C servers are currently active .
Many , if not all of them , appear to be compromised machines .
In fact , at least 11 of the C&C servers were hosted on the compromised machines of an East Asian government , which made these very useful for launching targeted attacks against it .
Most of the malware samples directly accessed an IP address as a C&C server .
Connections to domains did exist in some cases .
The domains were usually registered using free dynamic DNS service providers or compromised websites .
Overall , this strategy was part of the attackers ’ modus operandi .
By choosing compromised machines to act as C&C servers , fewer clues were left for investigators to follow in an attempt to find out who is behind the attacks compared with those using bulletproof hosting services and registered domain names .
To conduct research on these servers , investigators need to differentiate between information related to malicious and legitimate use .
One very interesting error revealed more insights into the C&C network ’s setup .
One of the malware samples we tested was designed to access xxx.xxawan.com via port 443 , which , at that time , resolved to xx.xxx.114.87:443 , a server located in the United States .
The sample , however , received the following error message from the server : 
This indicated that the front-end servers actually functioned as proxy servers and that the true C&C servers were hidden behind this initial group of C&C servers .
This made the network more resistant to takedown and analysis .
Due to a server error , however , the attackers revealed the location of one of their back-end servers .
We discovered that the IP address , xx.xx.x2.202 , is located in Guangdong , China .
The particular error returned looked very similar to errors generated by a tool called “ HTran. ” HTran stands for “ HUC Packet Transmit Tool , ” a connection bouncer that redirects TCP traffic destined for one host to an alternate host , keeping the real host hidden from view .
“ HUC , ” in this case , stands for the hacking group , “ Honker Union of China. ” It was coded by a hacker who goes by the handle “ lion. ” This tool ’s error-checking code , however , is flawed .
Assuming that everything properly works , the tool functions very well as a proxy server but if the real server is currently inaccessible , HTran will send an error message , revealing its whereabouts .
Running a port scan on this server revealed some open ports shown in the table below .
80/tcp Open HTTP .
8080/tcp Open HTTP Alternative .
Based on OS fingerprinting , the server appears to be running Windows 7 Enterprise Server .
With only a few open ports , however , it was very difficult to confirm this .
In addition , we did not receive a response when we tried to connect to these ports .
Previous research on the IXESHE campaign indicated several connections to groups possibly from China .
In addition , the IP address hiding behind the HTran instance was an IP range assigned to China .
Upon further investigation of the “ manufact ” campaign , however , it appears that the gang behind it may be English speakers .
The name of the campaign , for one , is most likely a shortened form of “ manufacturing. ” The OS the C&C server uses is also an English install of Microsoft XP .
It is also likely , of course , that the C&C server is a compromised machine so it does not use the attackers ’ first language .
The malware samples , which appear to have been developed using C++ , had a number of strings and error codes in English such as “ Enter command ” and “ Receive command error! ” 
The date format used in the campaign codes ( i.e. , MMDD ) also provided us a clue as to where the attackers may be from .
This date format is only commonly used in China , Korea , Iran , Japan , Hungary , Lithuania , and the United States .
Based on the limited amount of information we gathered about the attackers , it was very difficult to pinpoint their exact location .
An attack can be considered associated with the gang behind the IXESHE campaign if it exhibits the following characteristics : 
Uses a specially crafted targeted email with a malicious file attachment .
Uses document exploits , primarily .PDF files , to drop malware into target systems .
Uses malware detected by security vendors as IXESHE variants .
Uses a malware that sends a GET request to the C&C server in the following format : 
http://[C&C Server]/[ACD] [EW]S[Some Numbers].jsp?
[Encrypted Base64 Blob] .
Uses dynamic DNS services for or compromised machines as C&C servers .
The IXESHE campaign has been successfully executing targeted attacks since 2009 .
The attackers primarily use malicious .PDF files that exploit vulnerabilities in Adobe Reader , Acrobat , and Flash Player , including the use of two zero-day exploits—one in 2009 and another in 2011 .
While the attackers primarily targeted East Asian governments in the past , they have also started targeting a telecommunications company and electronics manufacturers .
They kept track of their targeted attacks by embedding a “ campaign tag ” in the malware that appears to describe when each attack was launched and , in some cases , the nature of its target .
We found more than 40 of these campaign tags .
The IXESHE attackers are notable for their use of compromised machines within a target ’s internal network as C&C servers .
This helped disguise their activities .
In addition , the attackers ’ use of the proxy tool , HTran , also helped mask their true location .
While their identities remain unknown , the attackers behind the IXESHE campaign demonstrated that they were both determined and capable .
While the malware used in the attacks were not very complicated by nature , these proved very effective .
This campaign remains an active threat .
Sufficiently motivated threat actors can penetrate even networks that use moderately advanced security measures .
As such , apart from standard and relevant attack prevention measures and mechanisms such as solid patch management ; endpoint and network security ; firewall use ; and the like , enterprises should also focus on detecting and mitigating attacks .
Moreover , data loss prevention ( DLP ) strategies that identify the data an organization is protecting and take into account the context of data use should be employed .
Threat intelligence refers to indicators that can be used to identify the tools , tactics , and procedures threat actors engaging in targeted attacks utilize .
Both external and local threat intelligence is crucial for developing the ability to detect attacks early .
The following are the core components of this defense strategy : 
Enhanced visibility : Logs from endpoint , server , and network monitoring are an important and often underused resource that can be aggregated to provide a view of the activities within an organization that can be processed for anomalous behaviors that can indicate a targeted attack .
Integrity checks : In order to maintain persistence , malware will make modifications to the file system and registry .
Monitoring such changes can indicate the presence of malware .
Empowering the human analyst : Humans are best positioned to identify anomalous behaviors when presented with a view of aggregated logs from across a network .
This information is used in conjunction with custom alerts based on the local and external threat intelligence available .
Technologies available today such as Deep Discovery provide visibility , insight , and control over networks to defend against targeted threats .
Deep Discovery uniquely detects and identifies evasive threats in real time and provides in-depth analysis and actionable intelligence to prevent , discover , and reduce risks .
Once an attack is identified , the cleanup strategy should focus on the following objectives : 
Determine the attack vector and cut off communications with the C&C server .
Determine the scope of the compromise .
Assess the damage by analyzing the data and forensic artifacts available on compromised machines .
Remediation should be applied soon afterward , which includes steps to fortify affected servers , machines , or devices into secure states , informed in part by how the compromised machines were infiltrated .
Security-related policies and procedures combined with education and training programs are essential components of defense .
Traditional training methods can be fortified by simulations and exercises using real spear-phishing attempts sent to test employees .
Employees trained to expect targeted attacks are better positioned to report potential threats and constitute an important source of threat intelligence .
The ultimate objective of targeted attacks is to acquire sensitive data .
As such , DLP strategies that focus on identifying and protecting confidential information are critical .
Enhanced data protection and visibility across an enterprise provides the ability to control access to sensitive data as well as monitor and log successful and unsuccessful attempts to access it .
Enhanced access control and logging capabilities allow security analysts to locate and investigate anomalies , respond to incidents , and initiate remediation strategies and damage assessment .
The following table summarizes the Trend Micro solutions for the components of the IXESHE campaign .
Trend Micro recommends a comprehensive security risk management strategy that goes further than advanced protection to meet the real-time threat management requirements of dealing with targeted attacks .
Predetermined C&C communication format : http://[C&C Server]/ [ACD] [EW]S[Some Numbers] .
jsp?
[Encrypted Base64 Blob] Web Reputation Endpoint ( Titanium , Worry-Free Business Security , OfficeScan ) Server ( Deep Security ) Messaging ( InterScan Messaging Security , ScanMail Suite for Microsoft Exchange ) Network ( Deep Discovery ) Gateway ( InterScan Web Security , InterScan Messaging Security ) Mobile ( Mobile Security ) .
TROJ_PIDIEF , BKDR_PROXY , TROJ_ DROPR , and TROJ_DEMTRANC variants File Reputation ( Antivirus/Anti-malware ) Endpoint ( Titanium , Worry-Free Business Security , OfficeScan ) Server ( Deep Security ) Messaging ( InterScan Messaging Security , ScanMail Suite for Microsoft Exchange ) Network ( Deep Discovery ) Gateway ( InterScan Web Security , InterScan Messaging Security ) Mobile ( Mobile Security ) .
CVE-2009-4324 CVE-2009-0927 CVE-2011-0609 CVE-2011-0611 CVE-2009-3129 Vulnerability Shielding/Virtual Patching Server ( Deep Security ) Endpoint ( OfficeScan with Intrusion Defense Firewall Plug-In ) For CVE-2009-4324: Rule #1004008 ( Adobe Reader and Acrobat ‘ newplayer() ’ JavaScript Method Code Execution ) For CVE-2009-0927: Rule # 1003405 ( Adobe Acrobat JavaScript getIcon Method Buffer Overflow ) For CVE-2011-0609: Rule #1004615 ( Adobe Flash Player XLS Remote Code Execution ) For CVE-2011-0611: Rule # 1004647 ( Restrict Microsoft Office File with Embedded SWF ) For CVE-2009-3129: Rule #1003817 ( Excel Featheader Record Memory Corruption Vulnerability ) .
