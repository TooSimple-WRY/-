FOLLOW THE MONEY : DISSECTING THE OPERATIONS OF THE CYBER CRIME GROUP FIN6 .		others others others others others others others others others others others others threatActor_name others
In addition to collecting credentials , FIN6 used publicly available tools to map the internal network and conduct reconnaissance against Active Directory , Structured Query Language ( SQL ) servers and NetBIOS .		others others others others others others threatActor_name others others others others others others others others others others others others others attack_goal attack_goal others program_language program_language program_language others tool others others others protocol others
In particular , during the reconnaissance phase they gathered information on systems running SQL instances , dumping schemas for multiple databases and SQL user accounts .		others others others others others others others person others others others others others tool others others others others others others others others tool others others others
Specific tools used by FIN6 included Microsoft ’s built-in SQL querying tool ( osql.exe ) , Query Express ( a free , portable graphical SQL client capable of connecting to Microsoft SQL and Oracle databases ) and AdFind , a free command-line tool for querying Active Directory .		others others others others threatActor_name others tool others others others tool others others others sample_name others others tool tool others others others others others others tool others others others others others tool tool others tool others others others tool others others others others others others others attack_goal attack_goal others
Over the course of one day , for example , the group targeted more than 900 SQL servers to dump reconnaissance information to support further operations .		others others others others others others others others others others others reference_word others others others attack_goal tool attack_goal others others others others others others others others others
Capitalizing on the acquired reconnaissance data , FIN6 began lateral movement using credentials stolen from various systems on which they gathered usernames and password hashes .		others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others
They likely cracked these hashes outside of the target ’s network before using multiple sets of domain admin credentials in combination with remote command execution tools such as PsExec and Remote Command Executor ( RemCom ) throughout the rest of the lateral movement phase .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others tool others tool tool tool others reference_word others others others others others others others others others others
To maintain presence and support interactive access in the environment , FIN6 leveraged the publicly available Plink command-line utility ( part of the PuTTY SSH and Telnet suite ) to create SSH tunnels to CnC servers under their control .		others others others others others others others others others others others threatActor_name others others others others tool tool tool others others others others tool protocol others protocol others others others sub_activity protocol sub_activity sub_activity tool sub_activity others others others others
As shown in Figure 2 , they used these SSH tunnels to route Remote Desktop Protocol ( RDP ) traffic and allow for interactive RDP sessions with systems in the target network .		others others others others others others person others others protocol tool others others protocol protocol protocol others reference_word others others others others others others protocol others others others others others others others others
After locating POS systems within the target ’s environment , FIN6 deployed POS malware that we call TRINITY ( also known as FrameworkPOS ) , with Scheduled Tasks being used for persistence .		others others tool others others others others others others others others threatActor_name others tool others others others others malware others others others others reference_word others others others others others others others others others others
TRINITY runs continuously and targets system processes not listed in its accompanying process blacklist , seeking data that matches payment card track data .		malware others others others sample_function sample_function sample_function others others others others others others others others others others others others others others others others others
Once the malware identifies track data , it copies and encodes it to a local file in a subdirectory of the c:\windows\ directory while attempting to conceal these files with .dll or .chm extensions .		others others others others others others others reference_word others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
In one particular case — and as an example of scale — FIN6 compromised and deployed TRINITY on around 2,000 systems , resulting in millions of exposed cards .		others others others others others others others others others others others others threatActor_name others others others malware others others others others others others others others others others others others
The malware first creates mutexes named m_number3 and MuTex-Check and exits if either already exists .		others others others others others others others others others others others others others others others others
The malware then continuously iterates over the current process listing and examines the memory space of each process .		others others others others others others others others others others others others others others others others others others others
Processes with module names less than five characters are skipped , along with some specific process names that are unlikely to contain payment card information .		others others others others others others others others others others others others others others others others others others others others others others others others others others
TRINITY logs captured data to disk , typically to a file in %WINDIR%\temp or %WINDIR%\help .		malware others others others others others others others others others others others others others others others others others others others others others
The malware encodes the data with a simple substitution cipher and single-byte XOR using the OxAA key .		others reference_word others others others others others others others others others others string others others string others others
Finally , to move the stolen payment card data out of the environment , FIN6 used a script to systematically iterate through a list of compromised POS systems , copying the harvested track data files to a numbered “ log ”  file before removing the original data files .		others others others others others others others others others others others others others others threatActor_name others others others others others others others others others others others tool others others others others others others others others others others others others others others others others others others others others others others
They then compressed the log files into a ZIP archive and moved the archive through the environment to an intermediary system and then to a staging system .		person others others others others others others others tool others others others others others others others others others others others others others others others others others others others
From the staging system , they then copied the stolen data to external CnC servers under their control using the FTP command line utility .		others others others others others person others others others others others others others tool others others others others others others protocol others others others others
In another case , FIN6 used an alternative extraction method to upload payment card data to a public file sharing service .		others others others others threatActor_name others others others others others others others others others others others others others others others others others
Our analysis of the data sold through this underground vendor indicates that FIN6 ’s compromises are highly profitable to the actors involved , potentially resulting in extensive fraud losses .		others others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others
Using iSIGHT Partners ’ collected intelligence , we discovered that the stolen payment card data from these intrusions were sold in an underground card shop .		others tool others others others others others person others others others others others others others others others others others others others others others others others others
This particular shop is advertised on multiple underground cyber crime forums and has offered diverse criminals access to millions of stolen payment cards on a regular basis .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This closes the loop on the “ lifecycle ”  of cyber criminal activity and exemplifies one of the final stages of cyber crime actors monetizing their stolen data .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
We have identified stolen data from several of FIN6 ’s victims being sold by this vendor as far back as 2014 .		person others others others others others others others threatActor_name others others others others others others others others others others others others time others
This connection means that data stolen by FIN6 has almost certainly ended up in the hands of fraud operators across the world , as they buy and exploit payment cards from the underground shop .		others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others
In each case , the stolen data began appearing in the shop within six months of the FIN6 breach .		others others others others others others others others others others others others others others others others others others others others
While the amount of data sold through the shop varies by breach , in some cases more than 10 million cards associated with a specific FIN6-linked breach have been identified on the shop .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
After being posted , much of the stolen card data is quickly purchased for exploitation .		others others others others others others others others others others others others others others others others
Along with the data we have linked to FIN6 , this underground shop has sold data from millions of other cards , which may be linked to breaches perpetrated by other threat actors .		others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others