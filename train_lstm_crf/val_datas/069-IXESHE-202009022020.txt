IXESHE An APT Campaign .		threatActor_name others others others others
Release_Time :  2012 Report_URL :  https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf The number of targeted attacks is undoubtedly on the rise .		others others others others others others others others others others others others others others others others others others others
These highly targeted attacks focus on individual organizations in an effort to extract valuable information .		others others others others others others others others others others others others others others others others
In many ways , this is a return to the ”  old hacking days ”   before more widespread attacks targeting millions of users and the rise of computer worms came about .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Sometimes , these targeted attacks are allegedly linked to state-sponsored activities but may also be carried out by individual groups with their own goals .		others others others others others others others others others others others others others others others others others others others others others others others others others
Trend Micro continues to track and analyze highly targeted attacks , also known as   ”   advanced persistent threats ( APTs ) .		company company others others others others others others others others others others others others others others others others others others others others
”   We have , in fact , published two research papers on the Luckycat1 and Lurid2 campaigns .		others reference_word others others others others others others others others others others others others others others others others
This research paper will delve into another prominent group of attackers referred to as ”  IXESHE ”  ( pronounced ” i-sushi ”  )  , based on one of the more common detection names security companies use for the malware they utilize .		others others others others others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others
This campaign is notable for targeting East Asian governments , electronics manufacturers , and a telecommunications company .		others others others others others others government government government others industry industry others others others company company others
The IXESHE campaign makes use of targeted emails with malicious attachments to compromise victims ’ systems .		others threatActor_name others others others others others tool others tool tool others sample_function sample_function sample_function sample_function others
The emails are often tailored for specific victims and contain malicious attachments that are almost always  ”  weaponized ”   .		others tool others others others others others others others others tool tool tool tool tool tool tool tool tool others
PDF files with known exploits that drop malware executables onto targeted systems .		tool tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function others
In addition , the IXESHE attackers conducted two specific attacks that leveraged zero-day exploits—one in 2009 and another in 2011 .		others others others others threatActor_name others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others time others others others time others
The IXESHE attackers almost always make use of compromised servers as command-and-control ( C&C ) servers .		others threatActor_name others others others others others others others others others tool others tool tool tool others others others
In some cases , the compromised servers are hosted on target organizations ’  networks after successful infiltration so the attackers can increase their control of the victims ’ infrastructure .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Using this approach , the attackers amassed at least 60 C&C servers over time .		others others others others others others others others others others tool tool tool others others others others
This technique also allows the attackers to cover their tracks , as having the C&C server in the victims ’ corporate networks means very little C&C traffic leaves them .		others others others others others others others others others others others others others others tool tool tool others others others others others others others others others others tool tool tool others others others others
The attackers ’  deliberate use of compromised machines and dynamic Domain Name System ( DNS ) services allows them to hide traces of their presence by confusing their activities with data belonging to legitimate individuals .		others person others others others others others others others tool tool tool tool others tool others others others others others sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others
Looking at threat intelligence derived from tracking APT campaigns over time primarily based on the network traffic generated by the malware used , we were able to develop indicators of compromise for the IXESHE campaign .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others
The malware samples used in this campaign were not very complicated by nature but do give the attackers almost complete control over their targets ’  compromised systems .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Most of the IP addresses of IXESHE ’s victims are linked to DSL networks , which made it difficult to determine their identities .		others others others protocol others others threatActor_name others others others others others others protocol others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Careful research , however , allowed the identification of some of the attackers ’  victims :  East Asian governments .		others others others others others others others others others others others reference_word reference_word others others others government government government others
Taiwanese electronics manufacturers .		industry industry industry others
A telecommunications company Campaign victims were identified by using Whois records and open source research .		others others others others others others others others others protocol tool others others others others others
Trend Micro generally notifies customers that are believed to have been specifically targeted by APT campaigns .		company company others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others
The IXESHE attackers have been actively launching highly targeted attacks since at least July 2009 .		others threatActor_name others others others others others others others others others others others time time others
Available data on the IXESHE campaign indicates that targeted emails with malicious .		others others others others threatActor_name others others others others tool others others others
PDF file attachments were the attackers ’ vector of choice .		tool tool tool others others person others others others others others
In most cases , the attacks involved Adobe Acrobat , Reader , and Flash Player exploits such as :   CVE-2009-43243 .		others others others others others others others tool tool others tool others others tool tool others others others others vulnerability_cve others
CVE-2009-09274 .		vulnerability_cve others
CVE-2011-06095 .		vulnerability_cve others
CVE-2011-06116 It should also be noted that this campaign used CVE-2009- 43247 and CVE-2011-06098 exploits when these were still unpatched or considered zero-day vulnerabilities  .		vulnerability_cve others others others others others others reference_word reference_word others vulnerability_cve vulnerability_cve others vulnerability_cve others others others others others others others others others others others
The IXESHE attackers also used an exploit that affected Microsoft Excel—CVE-2009-3129  .		others threatActor_name others others others others others others sample_function sample_function others others
The IXESHE malware binary allowed the attackers to easily take over and maintain complete control of victims ’ systems to do the following :   List all services , processes , and drives .		tool threatActor_name tool tool others others person others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Terminate processes and services .		attack_goal attack_goal attack_goal attack_goal others
Download and upload files .		attack_goal attack_goal attack_goal attack_goal others
Start processes and services .		attack_goal attack_goal attack_goal attack_goal others
Get victims ’ user names .		attack_goal attack_goal attack_goal attack_goal attack_goal others
Get a machine ’s name and domain name .		attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Download and execute arbitrary files .		attack_goal attack_goal attack_goal attack_goal attack_goal others
Cause a system to pause or sleep for a specified number of minutes .		attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Spawn a remote shell .		attack_goal attack_goal attack_goal attack_goal others
List all current files and directories .		attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Every IXESHE case we examined revealed that the original infection vector was a targeted email with a PDF exploit as attachment .		others threatActor_name others others others others others others others others others others others others tool others tool tool tool others others others
Older versions also used an XLS exploit .		others others others others others tool others others
Opening the .PDF file drops and executes a malware in a victim ’s system .		others others others others others others others others others others others others others others others others
The malware displays a blank .PDF file or a decoy document related to the targeted attack .		others others others others others others others others others others others others others others others others others
The emails normally come from compromised personal accounts or are entirely spoofed .		others tool others others others others others others others others others others others
Emails from spoofed senders were usually sent via mail servers in the United States and China .		tool others others others others others others others tool tool others location location location others location others
Once dropped onto target systems by means of a document exploit attached to a tailored email , the malware drops an executable file into one of the following folders :  %APPDATA%\Locations\ .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
%APPDATA%\Adobe .		others others others others others
%TEMP% The malware also sets the executable file ’s attributes to ”  Hidden .		others others others others others others others others others others others others others others others others others
”  Some of the file names the attackers used include :  winhlps.exe .		others others others others others others others person others others others sample_name others
acrotry.exe .		sample_name others
AcroRd32.exe .		sample_name others
Updater.exe In order for the malware to survive rebooting , it normally creates the following registry run key :  HKEY_CURRENT_USER\Software\Microsoft\Windows\ CurrentVersion\Run The registry run key , in turn , points to the malware that has been dropped .		sample_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The value name of this entry varies from sample to sample .		others others others others others others others others others others others others
Some of the names the attackers used for it include :   Adobe Assistant .		others others others others person person others others others others others tool tool others
Migrated .		tool others
Some samples , however , do not use a registry run key as load point .		others others others others others others others others others others others others others others others others
Some of the more recent samples we observed create a shortcut ( i.e .		others others others others others others others others others others others others others others
, .LNK file ) in the Startup folder with names such as adobe reader speed launch.lnk .		others others others others others others others others others others others others others others others others others
The malware also checks a system ’s proxy settings for later use in C&C communications : HKEY_CURRENT_USER\Software\Microsoft\Windows\ CurrentVersion\Internet Settings ProxyEnable ProxyServer .		others others others others others others others others others others others others others others others others others others others others others others others others others
Upon installation , the malware starts communicating with one of its C&C servers .		others others others others others others others others others others others others others others others others
Most of the samples appeared to have at least three C&C servers hard coded for redundancy .		others others others others others others others others others others others others others others others others others others others
The C&C communications are easy to identify , as these tended to be coded in the following predetermined format : http://[ C&C Server ]/[ ACD ] [ EW ]S[ Some Numbers ] .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
jsp?		others others
[ Encrypted Base64 Blob ] Some samples alternatively use an FGKD.jsp or an FPK.jsp file .		others others others others others others others others others others tool others others tool others others
The Base64 blob is of particular interest .		others others others others others others others others
It makes use of a custom Base64 alphabet .		others others others others others others others others others
Once decoded , this blob reveals a standardized structure of the information sent to the registered C&C server , which includes the following details :   Computer name .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Local IP address .		others others others others
Proxy server IP and port .		others others others others others others
Malware ID .		others others others
To date , we have seen several custom Base64 alphabets , including :   +NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67FM3wemKfkJLBo9VtWXlEuA .		others others others others others others others others others others others others others string others
HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3wemKckJLBofCDrs9VtWXlEu .		string others
p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/zPgUx67FMhYb8q3wemKc .		string others
aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
ZaGHviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
4HIvZGjaiQdn=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
pGIaHnZj0vdQ=i421y+NO5RSY/zMgUx67KPhTb8q3wemFckBLJufWErs9VtCXlDo .		string others
QpaZIivj4ndG=H021y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu .		string others
pGZaHnIj4vdQ=i012y+NO5RST/zPgUx67FMhYb8q3we mKckJLBofCDrs9VtWXlEu .		string string others
Some similarities exist across different versions of the Base64 alphabet , which indicates that these are most likely not completely randomly generated .		others others others others others others others others others others others others others others others others others others others others others others others
Instead , the attackers manually cut and pasted older versions after altering some parts .		others others others others others others others others others others others others others others others
The malware ID seems to be a campaign code with a different IP address for each attack .		others others others others others others others others others others others others others others others others others others
Some of the campaign codes we have seen include :  It appears that the numbers in the given campaign codes refer to dates when the campaigns were launched in  ”  MMDD ”  format .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The letters are possibly related to the target industry or company .		others others others others others others others others others others others others
PAGE 4 | IXESHE If the malware does not get a response from the C&C server , it will choose another random number after the AWS part of the URL and try again .		others others others threatActor_name others others others others others others others others others others tool tool tool others others others others others others others others others others others others others others tool others others others others
Once connected , the malware specifically waits for the remote server to issue the following commands , which may vary from one version to another :  del [ parameter ] : Allows a remote user to delete files .		others others others others others others others others others others others others others others others others others others others others others others others others others others tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
disk [ parameter ] : Lists all available drives .		tool others others others others sample_function sample_function sample_function sample_function others
dos [ parameter ] : Allows a remote user to execute commands via cmd.exe .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
get [ parameter ] : Allows a remote user to download a file from the remote server onto a local machine .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
list [ parameter ] : Lists files on the victim ’s machine .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
ls [ parameter ] : Allows a remote user to display the contents of a directory .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
kill [ parameter ] : Allows a remote user to terminate processes .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
put [ parameter ] : Allows a remote user to upload a file from a local machine to a remote server .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
rsh [ parameter ] : Similar to the sh or dos [ parameter ] except for the fact that this is an already-existing file or shell .		tool others others others others others others others tool others tool others others others others others others others others others others others others others others others others
run [ parameter ] : Allows a remote user to execute programs .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
sh [ parameter ] : Allows a remote user to execute commands via cmd.exe .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
sleep [ parameter ] : Causes a system to sleep for a certain amount of time .		tool others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Related AES Campaign We have also been tracking another campaign , which we refer to as the  ”  AES campaign , ”  which appears to be related to IXESHE .		others encryption_algo others others others others others others others others others others others others others others others others encryption_algo others others others others others others others others others threatActor_name others
The main body of the malware related to the IXESHE campaign can be identified by its connection to a C&C server using a file such as AWS12345.jsp and a custom Base64 blob ; the malware associated with the AES campaign operates very similarly .		others others others others others others others others others threatActor_name others others others others others others others others others tool tool tool others others others others others others sample_name others others others tool tool others others others others others others encryption_algo others others others others others
The samples used in the AES campaign slightly differed in terms of C&C communication but had significant similarities with IXESHE malware , which used the format : http://C&C Server/ACDES Some Numbers.jsp .		others others others others others encryption_algo others others others others others others tool tool tool others others others others others others threatActor_name others others others others others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil others
Even though the network traffic format of the AES campaign was slightly similar , instead of the more familiar AWS[ random ].jsp format , it used several other formats for certain commands or events such as :  AES : Initial beacon .		others others others others others others others others encryption_algo others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others encryption_algo others sample_function sample_function others
DES : Send the path of %systemdir% .		encryption_algo others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
PES : Send the result of the  ”  put ”  command .		encryption_algo others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
SEU : Send the ”  error ”  or ”  invalid ”  command .		others others others others others others others others others others others others others
SUS : Send the system name , which is not encoded , upon receiving the ”  exit ”  command .		others others others others others others others others others others others others others others others others others others others others
ZES : Send the result of the ”  dos ”  command .		others others others others others others others others others others others others
Another difference in the traffic is that AWS uses the POST method with the format , ”  http://C&C Server/FPK Some Numbers.jsp?Base64 Blob , ”  when the ”  get ”  command is invoked .		others others others others others others others tool others others tool others others others others others others url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil url_evil others others others others others others others others others others others
The Base64 blob contains the file specified in the ”  get ”  command .		others others others others others others others others others others others others others others
Analysis of the binaries also revealed similarities between the AES and AWS samples .		others others others others others others others others others encryption_algo others tool others others
These included the encoding algorithm and commands used .		others others others others others others others others others
Even though some commands varied , the format and parameters used essentially remained the same .		others others others others others others others others others others others others others others others others