BlackEnergy by the SSHBearDoor : attacks against Ukrainian news media and electric industry .		threatActor_name others others malware others others others industry industry industry others industry others others
Release_time :  2016-01-03 .		others others others others
Report_URL :  https://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/ .		others others others others others others
The cybercriminal group behind BlackEnergy , the malware family that has been around since 2007 and has made a comeback in 2014 ( see our previous blog posts on Back in BlackEnergy :  2014 Targeted Attacks in Ukraine and Poland and BlackEnergy PowerPoint Campaigns , as well as our Virus Bulletin talk on the subject ) , was also active in the year 2015 .		others others others others threatActor_name others others others others others others others others others time others others others others others others time others others others others others others others others others threatActor_name others time others others others location others location others attack_activity attack_activity attack_activity others others others others others others others others others others others others others others others others others others others time others
ESET has recently discovered that the BlackEnergy trojan was recently used as a backdoor to deliver a destructive KillDisk component in attacks against Ukrainian news media companies and against the electrical power industry .		company others others others others others threatActor_name malware others others others others others others others others others others malware others others others others industry industry industry industry others others others industry industry industry others
In this blog , we provide details on the BlackEnergy samples ESET has detected in 2015 , as well as the KillDisk components used in the attacks .		others others others others others others others others others threatActor_name others company others others others time others others others others others malware others others others others others others
Furthermore , we examine a previously unknown SSH backdoor that was also used as another channel of accessing the infected systems , in addition to BlackEnergy .		others others others others others others others protocol malware others others others others others others others others others others others others others others others others threatActor_name others
We continue to monitor the BlackEnergy malware operations for future developments .		others others others others others threatActor_name others others others others others others
For any inquiries or to make sample submissions related to the subject , contact us at :  threatintel@eset.com Once activated , variants of BlackEnergy Lite allow a malware operator to check specific criteria in order to assess whether the infected computer truly belongs to the intended target .		others others others others others others others others others others others others others others others others others domain domain domain others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others
If that is the case , the dropper of a regular BlackEnergy variant is pushed to the system .		others others others others others others others others others others others threatActor_name others others others others others others others
The exact mechanism of infection by BlackEnergy is described in our Virus Bulletin presentation and this whitepaper by F-Secure .		others others others others others others threatActor_name others others others others others others others others others others others tool others
The BlackEnergy malware stores XML configuration data embedded in the binary of DLL payload .		others threatActor_name malware others program_language others others others others others others others string others others
Apart from a list of C&C servers , the BlackEnergy config contains a value called build_id .		others others others others others tool tool tool others others others threatActor_name others others others others others sample_name others
This value is a unique text string used to identify individual infections or infection attempts by the BlackEnergy malware operators .		others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others threatActor_name malware others others
The combinations of letters and numbers used can sometimes reveal information about the campaign and targets .		others others others others others others others others others others others others others others others others others
Here is the list of Build ID values that we identified in 2015 :  2015en , khm10 , khelm , 2015telsmi , 2015ts , 2015stb , kiev_o , brd2015 , 11131526kbp , 02260517ee , 03150618aaa , 11131526trk .		others others others others others others others others others others others others time others string others string others string others string others string others string others string others string others string others string others string others string others
We can speculate that some of them have a special meaning .		others others others others others others others others others others others others
For example 2015telsmi could contain the Russian acronym SMI – Sredstva Massovoj Informacii , 2015en could mean Energy , and there ’s also the obvious “ Kiev ”  .		others others string others others others others others string others others others others others string others others others others others others others others others others others others others others others
In 2014 some variants of the BlackEnergy trojan contained a plugin designed for the destruction of the infected system , named dstr .		others time others others others others threatActor_name malware others others others others others others others others others others others others others others others
In 2015 the BlackEnergy group started to use a new destructive BlackEnergy component detected by ESET products as Win32/KillDisk.NBB , Win32/KillDisk.NBC and Win32/KillDisk.NBD trojan variants .		others time others threatActor_name others others others others others others others threatActor_name tool others others company others others malware others malware others malware others others others
The main purpose of this component is to do damage to data stored on the computer :  it overwrites documents with random data and makes the OS unbootable .		others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
The first known case where the KillDisk component of BlackEnergy was used was documented by CERT-UA in November 2015 .		others others others others others others tool others others threatActor_name others others others others others security_team others time time others
In that instance , a number of news media companies were attacked at the time of the 2015 Ukrainian local elections .		others others others others others others others target_crowd target_crowd target_crowd others others others others others others others time others others others others
The report claims that a large number of video materials and various documents were destroyed as a result of the attack .		others others others others others others others others others others others others others others others others others others others others others others
It should be noted that the Win32/KillDisk.NBB variant used against media companies is more focused on destroying various types of files and documents .		others others others others others others malware others others others target_crowd target_crowd others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
It has a long list of file extensions that it tries to overwrite and delete .		others others others others others others others others others others others others others others others others
The complete list contains more than 4000 file extensions .		others others others others others others others others others others
The KillDisk component used in attacks against energy companies in Ukraine was slightly different .		others tool others others others others others industry industry others location others others others others
Our analysis of the samples shows that the main changes made in the newest version are :   Now it accepts a command line argument , to set a specific time delay when the destructive payload should activate .		others others others others others others others others others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
It also deletes Windows Event Logs :  Application , Security , Setup , System .		others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
It is less focused on deleting documents .		others others others others others others others others
Only 35 file extensions are targeted .		others others others others others others others
As well as being able to delete system files to make the system unbootable – functionality typical for such destructive trojans – the KillDisk variant detected in the electricity distribution companies also appears to contain some additional functionality specifically intended to sabotage industrial systems .		others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others tool others others others others industry industry industry others others others others others others others others others others attack_goal attack_goal attack_goal others
Once activated , this variant of the KillDisk component looks for and terminates two non-standard processes with the following names :  komut.exe , sec_service.exe .		others others others others others others others tool others others others others others others others others others others others others others sample_name others sample_name others
We didn’t manage to find any information regarding the name of the first process ( komut.exe ) .		others others others others others others others others others others others others others others others others others sample_name others others
The second process name may belong to software called ASEM Ubiquity , a software platform that is often used in Industrial control systems ( ICS ) , or to ELTIMA Serial to Ethernet Connector .		others others others others others others others others others company company others others others others others others others others others OS_name OS_name OS_name others string others others others others company others others others others others
In case the process is found , the malware does not just terminate it , but also overwrites the executable file with random data .		others others others others others others others others reference_word others others others others others others others others others others others others others others others others
In addition to the malware families already mentioned , we have discovered an interesting sample used by the BlackEnergy group .		others others others others reference_word others others others others others others others others others others others others others threatActor_name others others
During our investigation of one of the compromised servers we found an application that , at first glance , appeared to be a legitimate SSH server called Dropbear SSH .		others others others others others others others others others others others others others others others others others others others others others others others others protocol others others tool tool others
In the order to run the SSH server , the attackers created a VBS file with the following content :  Set WshShell = CreateObject ( “ WScript.Shell ”  ) ， WshShell.CurrentDirectory = “ C:\WINDOWS\TEMP\Dropbear\ ”  ， WshShell.Run “ dropbear.exe -r rsa -d dss -a -p 6789 ”  , 0 , false .		others others others others others others protocol others others others person others others program_language tool others others others others others others others others others others others others others others others others others others others others others others others others others sample_name others others others others others others others others others others others others others
As is evident here , the SSH server will accept connections on port number 6789 .		others others others others others others protocol others others others others others others others others others
By running SSH on the server in a compromised network , attackers can come back to the network whenever they want .		others others others others others others others others others others others person others others others others others others others others others others
However , for some reason this was not enough for them .		others others others others others others others others others others others others
After detailed analysis we discovered that the binary of the SSH server actually contains a backdoor .		others others others others others others others others others others protocol others others others others others others
This version of Dropbear SSH will authenticate the user if the password passDs5Bu9Te7 was entered .		others others others tool tool others others others others others others others others others others others
The same situation applies to authentication by key pair – the server contains a pre-defined constant public key and it allows authentication only if a particular private key is used .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
ESET security solutions detect this threat as Win32/SSHBearDoor.A trojan .		company others others others others others others malware malware others
BlackEnergy :  5.149.254.114 .		threatActor_name others IP_evil others
BlackEnergy :  5.9.32.230 .		threatActor_name others IP_evil others
BlackEnergy :  31.210.111.154 .		threatActor_name others IP_evil others
BlackEnergy :  88.198.25.92 .		threatActor_name others IP_evil others
BlackEnergy :  146.0.74.7 .		threatActor_name others IP_evil others
BlackEnergy :  188.40.8.72 .		threatActor_name others IP_evil others
BlackEnergy :  AA67CA4FB712374F5301D1D2BAB0AC66107A4DF1 .		threatActor_name others sha1 others
BlackEnergy :  4C424D5C8CFEDF8D2164B9F833F7C631F94C5A4C .		threatActor_name others sha1 others
BlackEnergy :  896FCACFF6310BBE5335677E99E4C3D370F73D96 .		threatActor_name others sha1 others
BlackEnergy :  069163E1FB606C6178E23066E0AC7B7F0E18506B .		threatActor_name others sha1 others
BlackEnergy :  0B4BE96ADA3B54453BD37130087618EA90168D72 .		threatActor_name others sha1 others
BlackEnergy :  1A716BF5532C13FA0DC407D00ACDC4A457FA87CD .		threatActor_name others sha1 others
BlackEnergy :  1A86F7EF10849DA7D36CA27D0C9B1D686768E177 .		threatActor_name others sha1 others
BlackEnergy :  1CBE4E22B034EE8EA8567E3F8EB9426B30D4AFFE .		threatActor_name others sha1 others
BlackEnergy :  20901CC767055F29CA3B676550164A66F85E2A42 .		threatActor_name others sha1 others
BlackEnergy :  2C1260FD5CEAEF3B5CB11D702EDC4CDD1610C2ED .		threatActor_name others sha1 others
BlackEnergy :  2D805BCA41AA0EB1FC7EC3BD944EFD7DBA686AE1 .		threatActor_name others sha1 others
BlackEnergy :  4BC2BBD1809C8B66EECD7C28AC319B948577DE7B .		threatActor_name others sha1 others
BlackEnergy :  502BD7662A553397BBDCFA27B585D740A20C49FC .		threatActor_name others sha1 others
BlackEnergy :  672F5F332A6303080D807200A7F258C8155C54AF .		threatActor_name others sha1 others
BlackEnergy :  84248BC0AC1F2F42A41CFFFA70B21B347DDC70E9 .		threatActor_name others sha1 others
BlackEnergy :  A427B264C1BD2712D1178912753BAC051A7A2F6C .		threatActor_name others sha1 others
BlackEnergy :  A9ACA6F541555619159640D3EBC570CDCDCE0A0D .		threatActor_name others sha1 others
BlackEnergy :  B05E577E002C510E7AB11B996A1CD8FE8FDADA0C .		threatActor_name others sha1 others
BlackEnergy :  BD87CF5B66E36506F1D6774FD40C2C92A196E278 .		threatActor_name others sha1 others
BlackEnergy :  BE319672A87D0DD1F055AD1221B6FFD8C226A6E2 .		threatActor_name others sha1 others
BlackEnergy :  C7E919622D6D8EA2491ED392A0F8457E4483EAE9 .		threatActor_name others sha1 others
BlackEnergy :  CD07036416B3A344A34F4571CE6A1DF3CBB5783F .		threatActor_name others sha1 others
BlackEnergy :  D91E6BB091551E773B3933BE5985F91711D6AC3B .		threatActor_name others sha1 others
BlackEnergy :  E1C2B28E6A35AEADB508C60A9D09AB7B1041AFB8 .		threatActor_name others sha1 others
BlackEnergy :  E40F0D402FDCBA6DD7467C1366D040B02A44628C .		threatActor_name others sha1 others
BlackEnergy :  E5A2204F085C07250DA07D71CB4E48769328D7DC .		threatActor_name others sha1 others
BlackEnergy :  16F44FAC7E8BC94ECCD7AD9692E6665EF540EEC4 .		threatActor_name others sha1 others
BlackEnergy :  8AD6F88C5813C2B4CD7ABAB1D6C056D95D6AC569 .		threatActor_name others sha1 others
BlackEnergy :  6D6BA221DA5B1AE1E910BBEAA07BD44AFF26A7C0 .		threatActor_name others sha1 others
BlackEnergy :  F3E41EB94C4D72A98CD743BBB02D248F510AD925 .		threatActor_name others sha1 others
BlackEnergy :  72D0B326410E1D0705281FDE83CB7C33C67BC8CA .		threatActor_name others sha1 others
BlackEnergy :  166D71C63D0EB609C4F77499112965DB7D9A51BB .		threatActor_name others sha1 others