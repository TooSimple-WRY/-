Goodbye Mworm, Hello Nworm: TrickBot Updates Propagation Module Release_Time : 2020-05-28  Report_URL : https://unit42.paloaltonetworks.com/goodbye-mworm-hello-nworm-trickbot-updates-propagation-module/ First discovered in 2016 , TrickBot is an information stealer that provides backdoor access sometimes used by criminal groups to distribute other malware .		others tool others others tool others malware others others others others others others others others others others others others others others time others malware others reference_word reference_word reference_word others attack_goal tool tool others others others industry industry others sub_activity sub_activity sub_activity others
TrickBot uses modules to perform different functions , and one key function is propagating from an infected Windows client to a vulnerable Domain Controller ( DC ) .		malware others tool others sample_function sample_function sample_function others others others others others others sample_function others others tool OS_name tool others others others tool tool others tool others others
TrickBot currently uses three modules for propagation .		malware others others tool tool others others others
As early as April 2020 , TrickBot updated one of its propagation modules known as "mworm" to a new module called "nworm."		others others others time time others malware others others others reference_word others others others others others tool others others others tool tool others others tool others others
Infections caused through nworm leave no artifacts on an infected DC , and they disappear after a reboot or shutdown .		sub_activity others others tool others others others others others others tool others others reference_word others others others others others others others
Other key differences of the new nworm module include :  It retrieves an encrypted , or otherwise encoded binary , over network traffic that represents a TrickBot executable file ( the old mworm module sent it as an executable file without any sort of encryption/encoding ) .		others others others others others others tool others others others reference_word others others others others others others others others others others tool tool others others tool malware tool tool others others others tool others others reference_word others others others others others others others others others others others
A TrickBot infection caused by the new mworm module is run from system RAM and does not appear to remain persistent on an infected host .		sub_activity malware sub_activity others others others others tool others others others others tool tool others others others others others others others others others others others others
This is a much better method of evading detection on an infected DC .		others others others others others others others others others others others others tool others
TrickBot is modular , meaning it uses various binaries to perform different functions during an infection .		malware others others others others reference_word others others tool others sample_function sample_function sample_function others others others others
In most cases , the basis of a TrickBot infection is a malicious Windows executable ( EXE ) file saved to disk .		others others others others others others others others malware others others others others OS_name others others tool others others others others tool others
This EXE is often called a "TrickBot loader" because it loads the TrickBot modules .		others tool others others others others others malware tool others others reference_word others others malware others others
TrickBot modules are dynamic link libraries ( DLLs ) or EXEs run from system memory .		malware tool others tool tool tool others tool others others tool others others tool tool others
On an infected Windows 10 host , TrickBot modules are only found in system memory .		others others tool tool tool tool others malware others others others others others tool tool others
But on an infected Windows 7 host , we also see artifacts related to the modules stored on the disk .		others others others tool tool tool tool others others others others tool others others others tool others others others tool others
These artifacts are encrypted binaries .		others tool others tool tool others
During a TrickBot infection , these encrypted binaries are decrypted and run from system memory as TrickBot modules .		others others malware others others others tool tool others others others others others tool tool others malware tool others
Starting in September 2019 , TrickBot modules with propagation capabilities have been mworm , mshare , and tab .		others others time time others malware tool others others others others others tool others tool others others tool others
They generate distinct activity when propagating to a vulnerable DC .		reference_word others others others others others others others others tool others
For the mshare and tab modules : An infected Windows client retrieves a new TrickBot EXE using an HTTP URL , The infected Windows client sends this new TrickBot EXE over SMB traffic to the vulnerable DC .		others others tool others tool others others others tool OS_name tool sample_function sample_function sample_function malware tool others others protocol tool others others tool OS_name tool others others others malware tool others protocol others others others others tool others
For the mworm module : The infected Windows client uses an SMB exploit targeting the vulnerable DC , The vulnerable DC retrieves a new TrickBot EXE using an HTTP URL and infects itself with it .		others others tool others others others tool OS_name tool others others protocol others others others others tool others others others tool others others others malware tool others others protocol tool others others reference_word others reference_word others
Of note , the mworm module did not usually appear unless the TrickBot infection happened in an AD environment with a DC .		others others others others tool others others others others others others others malware others others others others tool tool others others tool others
Since February 2020 , URLs generated by these modules to retrieve follow-up TrickBot EXE files used the following patterns : URL generated by mshare module ends with /images/cursor.png , URL generated by mworm module ends with /images/redcar.png , URL generated by tab module ends with /images/imgpaper.png .		others time time others tool others others tool tool others sample_function sample_function malware tool tool others others others others others tool others others tool others others others others others tool others others tool others others others others others tool others others tool others others others others others
These URLs use IP addresses instead of domains .		others tool others tool tool others others others others
In April 2020 while generating a TrickBot infection in a lab environment , TrickBot stopped using the mworm module .		others time time others others others malware sub_activity others others tool tool others malware others others others tool others others
In its place , a new artifact named "nworm" appeared on an infected Windows 7 client .		others reference_word others others others tool tool others others tool others others others others tool tool tool tool others
HTTP traffic for follow-up TrickBot EXEs caused by nworm is noticeably different than traffic caused by mworm .		protocol tool others others malware tool others others tool others others others others tool others others tool others
The differences are : mworm : URL for TrickBot EXE ends with /images/redcar.png , nworm : URL for TrickBot EXE ends with /ico/VidT6cErs , mworm : Follow-up TrickBot EXE is returned unencrypted in the HTTP traffic , nworm : Follow-up TrickBot EXE is returned as an encrypted or otherwise encoded binary in the HTTP traffic .		others others others others tool others tool others malware tool others others others others tool others tool others malware tool others others others others tool others others malware tool others others others others others protocol others others tool others others malware tool others others others others others others others others tool others others protocol tool others
By using Wireshark and examining TCP streams , we can easily spot the differences in HTTP traffic caused by the old mworm module and the new nworm module .		others others tool others others protocol others others person others others others others others others protocol tool others others others tool tool tool others others tool tool tool others
Like mworm , the new nworm module does not appear unless the TrickBot infection happens in an AD environment with a DC .		others tool others others tool tool tool others others others others others malware sub_activity others others others tool tool others others tool others
When nworm infects a vulnerable DC , the malware is run from memory .		others tool others others others tool others others others others others others others others
No artifacts are found on the infected DC and TrickBot on the DC doesn't survive a reboot .		others others others others others others others tool others malware others others tool others others others others others others
In cases where mshare and tab infect a vulnerable DC with TrickBot , these infections remain persistent on the DC , but TrickBot caused by nworm is not persistent .		others others others tool others tool others others others tool others malware others others others others others others others tool others others malware others others tool others others others others
This shouldn't be an issue for the malware , because the DC is a server and servers rarely shut down or reboot like a Windows client .		others others others others others others others others others others others others tool others tool tool others others others others others others others others others OS_name others others
Every TrickBot binary has an identifier called a gtag .		others malware tool others others tool others others tool others
This is found in configuration data extracted from a TrickBot binary .		reference_word others others others tool tool others others others malware tool others
Gtags can also be found in HTTP traffic during a TrickBot infection .		tool others others others others others protocol tool others others malware others others
They indicate the specific campaign or source of infection used for a TrickBot binary .		reference_word others others others others others others others others others others others malware tool others
The gtag is a short alphabetic string followed by a number representing a one-up serialization .		others tool others others tool tool tool others others others others others others tool tool others
Examples follow :  mor-series gtag : TrickBot caused by an Emotet infection , for example : TrickBot gtag mor84 caused by Emotet on January 27th , 2020. ono-series gtag : various TrickBot infections initiated through malicious Microsoft Office documents like Word documents or Excel spreadsheets , distributed through English-language emails .		others others others sample_name sample_name others malware others others others tool others others others others others malware sample_name sample_name others others tool others time time time others sample_name sample_name others others malware others others others tool company tool tool others tool others others tool others others others others tool tool others
red-series gtag : TrickBot distributed as a DLL file instead of an EXE , for example : TrickBot gtag red5 documented on March 17th , 2020 .		sample_name sample_name others malware others others others tool tool others others others tool others others others others malware sample_name sample_name others others time time time time others
Gtags for TrickBot binaries used by TrickBot modules are unique .		tool others malware tool others others malware tool others others others
They break out as : tot-series gtag : TrickBot binaries used by mshare module , jim-series gtag : TrickBot binaries used by nworm ( and the old mworm ) module , lib-series gtag : TrickBot binaries used by tab module .		reference_word others others others others sample_name sample_name others malware tool others others tool tool others sample_name sample_name others malware tool others others tool others others others tool tool others others others sample_name sample_name others malware tool others others tool tool others
An infection caused by nworm is run from system memory , leaves no artifacts on an infected DC and disappears after a reboot or shutdown .		others others others others tool others others others others others others others others others others others others tool others others others others others others others others
Furthermore , the TrickBot binary used by nworm is encrypted or otherwise encoded when it is retrieved over the Internet .		others others others malware tool others others tool others others others others others others others others others others others tool others
These characteristics are likely an attempt by TrickBot developers to avoid detection .		others others others others others others others malware person others sub_activity sub_activity others
This is the latest in a series of changes in TrickBot as it evolves within our current threat landscape .		others others others others others others others others others others malware others reference_word others others others others others others others
However , best security practices like running fully-patched and up-to-date versions of Microsoft Windows will hinder or prevent TrickBot infections .		others others others others others others others others others others others others company OS_name others others others others malware others others
Palo Alto Networks customers are further protected from TrickBot by our threat prevention platform .		tool tool tool person others others others others malware others others tool tool tool others
AutoFocus users can track TrickBot activity by using the TrickBot tag .		tool person others sub_activity malware sub_activity others others others malware tool others