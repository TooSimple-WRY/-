BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents .		attack_activity attack_activity attack_activity others location others malware others tool tool others
Release_Time : 2016-01-28 .		others others others others
Report_URL : https://securelist.com/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/73440/ .		others others others others others others
Late last year , a wave of cyber-attacks hit several critical sectors in Ukraine .		others others others others others others others attack_activity others others government government others location others
Widely discussed in the media , the attacks took advantage of known BlackEnergy Trojans as well as several new modules .		others others others others others others reference_word reference_word others others others others malware malware others others others others others others others
BlackEnergy is a Trojan that was created by a hacker known as Cr4sh .		malware others others others others others others others others others others others threatActor_name others
In 2007 , he reportedly stopped working on it and sold the source code for an estimated $700 .		others time others others others others others others others others others others others others others others others others others others
The source code appears to have been picked by one or more threat actors and was used to conduct DDoS attacks against Georgia in 2008 .		others others others others others others others others others others others others others others others others others others others attack_activity attack_activity others location others time others
These unknown actors continued launching DDoS attacks over the next few years .		others person person others others attack_activity attack_activity others others others others others others
Around 2014 , a specific user group of BlackEnergy attackers came to our attention when they began deploying SCADA-related plugins to victims in the ICS and energy sectors around the world .		time time others others others others others others threatActor_name others others others others others others others others others malware malware others target_crowd others others industry others industry industry others others others others
This indicated a unique skillset , well above the average DDoS botnet master .		others others others others others others others others others others attack_activity others others others
For simplicity , we ’re calling them the BlackEnergy APT group .		others others others others others others others others others threatActor_name threatActor_name others others
One of the prefered targets of the BlackEnergy APT has always been Ukraine .		others others others others others others others threatActor_name threatActor_name others others others location others
Since the middle of 2015 , one of the preferred attack vectors for BlackEnergy in Ukraine has been Excel documents with macros that drop the Trojan to disk if the user chooses to run the script in the document .		others others time time time others others others others others others others others threatActor_name others location others others tool tool others tool others others others malware others others others others others others others others others others others others others others
A few days ago , we discovered a new document that appears to be part of the ongoing BlackEnergy APT group attacks against Ukraine .		others others others others others others others others others others others others others others others others others others threatActor_name threatActor_name others others others location others
Unlike previous Office files used in previous attacks , this is not an Excel workbook , but a Microsoft Word document .		others others others others others others others others others others others others others tool tool others others others tool tool tool others
The lure used a document mentioning the Ukraine “ Right Sector ” party and appears to have been used against a television channel .		others others others others others others others others others others others others others others others others others others others others others others others others
At the end of the last year , a wave of attacks hit several critical sectors in Ukraine .		others others others others others others others others others others others attack_activity others others government government others location others
Widely discussed in the media and by our colleagues from ESET , iSIGHT Partners and other companies , the attacks took advantage of both known BlackEnergy Trojans as well as several new modules .		others others others others others others others others others others security_team others security_team security_team others others others others reference_word reference_word others others others others others malware malware others others others others others others others
A very good analysis and overview of the BlackEnergy attacks in Ukraine throughout 2014 and 2015 was published by the Ukrainian security firm Cys Centrum ( the text is only available in Russian for now , but can be read via Google Translate ) .		others others others others others others others others attack_activity attack_activity others location time time time time others others others others security_team security_team security_team security_team security_team others others others others others others others location others others others others others others others others company others others others
In the past , we have written about BlackEnergy , focusing on their destructive payloads , Siemens equipment exploitation and router attack plugins .		others others others others others others others others threatActor_name others others others others others others others others others others others others others others others
You can read blogs published by my GReAT colleagues Kurt Baumgartner and Maria Garnaeva here and here .		others others others others others others others security_team others person person others person person others others others others
We also published about the BlackEnergy DDoS attacks .		others others others others others attack_activity attack_activity attack_activity others
Since mid-2015 , one of the preferred attack vectors for BlackEnergy in Ukraine has been Excel documents with macros which drop the trojan to disk if the user chooses to run the script in the document .		others time others others others others others others others others threatActor_name others location others others tool tool others tool others others others malware others others others others others others others others others others others others others others
For the historians out there , Office documents with macros were a huge problem in the early 2000s , when Word and Excel supported Autorun macros .		others others others others others others tool tool others tool others others others others time time time time others others tool others tool others others tool others
That meant that a virus or trojan could run upon the loading of the document and automatically infect a system .		others others others others others others others others others others others others others others others others others others others others others
Microsoft later disabled this feature and current Office versions need the user to specifically enable the Macros in the document to run them .		company others others others others others others others others others others others others others others others tool others others others others others others others
To get past this inconvenience , modern day attackers commonly rely on social engineering , asking the user to enable the macros in order to view “ enhanced content ” .		others others others others others others others others others others others others others others others others others others others others others tool others others others others others others others others others
Few days ago , we came by a new document that appears to be part of the ongoing attacks BlackEnergy against Ukraine .		others others others others others others others others others others others others others others others others others others attack_activity attack_activity others location others
Unlike previous Office files used in the recent attacks , this is not an Excel workbook , but a Microsoft Word document : “ $RR143TB.doc ” ( md5: e15b36c2e394d599a8ab352159089dd2 ) .		others others others others others others others others others others others others others others tool tool others others others tool tool tool others others sample_name sample_name others others encryption_algo others md5 others others
This document was uploaded to a multiscanner service from Ukraine on Jan 20 2016 , with relatively low detection .		reference_word reference_word others others others others others others others location others time time time others others others others others others
It has a creation_datetime and last_saved field of 2015-07-27 10:21:00 .		reference_word others others others others others others others time time others
This means the document may have been created and used earlier , but was only recently noticed by the victim .		others others others others others others others others others others others others others others others others others others others others others
Upon opening the document , the user is presented with a dialog recommending the enabling of macros to view the document .		others others others others others others others others others others others others others others others others tool others others others others others
Interestingly , the document lure mentions “ Pravii Sektor ” ( the Right Sector ) , a nationalist party in Ukraine .		others others others others others others others government government others others others others others others others others others others others location others
The party was formed in November 2013 and has since played an active role in the country ’s political scene .		reference_word reference_word others others others time time others others others others others others others others others others others others others others others
To extract the macros from the document without using Word , or running them , we can use a publicly available tool such as oledump by Didier Stevens .		others others others tool others others others others others others others others others others others others others others others others others others others others tool others person person others
Here ’s a brief cut and paste .		others others others others others others others others others
As we can see , the macro builds a string in memory that contains a file that is created and written as “ vba_macro.exe ” .		others others others others others others tool others others others others others others others others others others others others others others others others sample_name others others
The file is then promptly executed using the Shell command .		others others others others others others others others tool tool others
The vba_macro.exe payload ( md5: ac2d7f21c826ce0c449481f79138aebd ) is a typical BlackEnergy dropper .		others sample_name others others encryption_algo others md5 others others others others malware malware others
It drops the final payload as “ %LOCALAPPDATA%\FONTCACHE.DAT ” , which is a DLL file .		others others others others others others others others others others others others others others others others others others others
It then proceeds to run it , using rundll32: rundll32.exe “ %LOCALAPPDATA%\FONTCACHE.DAT ” , #1 .		others others others others others others others others tool others others others others others others others others others others others others
To ensure execution on every system startup , the dropper creates a LNK file into the system startup folder , which executes the same command as above on every system boot .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The final payload ( FONTCACHE.DAT , md5: 3fa9130c9ec44e36e52142f3688313ff ) is a minimalistic BlackEnergy ( v3 ) trojan that proceeds to connect to its hardcoded C&C server , 5.149.254.114 , on Port 80 .		others others others others sample_name others encryption_algo others md5 others others others others malware malware malware malware malware others others others others others others others tool tool tool tool others IP_evil others others others others others
The server was previously mentioned by our colleagues from ESET in their analysis earlier this month .		others others others others others others others others others security_team others others others others others others others
The server is currently offline , or limits the connections by IP address .		others others others others others others others others others others others others others others
If the server is online , the malware issues as HTTP POST request to it , sending basic victim info and requesting commands .		others others others others others others malware malware others others protocol protocol others others others others others others others others others others others others
The b_id contains a build id and an unique machine identifier and is computed from system information , which makes it unique per victim .		others string others others others others others others others others others others others others others others others others others others others others others others others
This allows the attackers to distinguish between different infected machines in the same network .		others others others others others others others others others others others others others others others
The field b_gen seems to refer to the victim ID , which in this case is 301018stb .		others others string others others others others others others others others others others others others others string others
STB could refer to the Ukrainian TV station “ STB ” , http://www.stb.ua/ru/ .		string others others others others others others others others company others others url url url others
This TV station has been publicly mentioned as a victim of the BlackEnergy Wiper attacks in October 2015 .		reference_word reference_word others others others others others others others others others others attack_activity attack_activity attack_activity others time time others
BlackEnergy is a highly dynamic threat actor and the current attacks in Ukraine indicate that destructive actions are on their main agenda , in addition to compromising industrial control installations and espionage activities .		threatActor_name others others others others others others others others others others others location others others others others others others others others others others others others others others others others others others others others others
Our targeting analysis indicates the following sectors have been actively targeted in recent years .		others others others others others others others others others others others others others others others
If your organization falls into these categories , then you should take BlackEnergy into account when designing your defences :  ICS , Energy , government and media in Ukraine ICS/SCADA companies worldwide Energy companies worldwide .		others others others others others others others others others others others others threatActor_name others others others others others others others industry others industry others government others industry others location company company others company company others others
The earliest signs of destructive payloads with BlackEnergy go back as far as June 2014 .		others others others others others others others threatActor_name others others others others others time time others
However , the old versions were crude and full of bugs .		others others others others others others others others others others others others
In the recent attacks , the developers appear to have gotten rid of the unsigned driver which they relied upon to wipe disks at low level and replaced it with more high level wiping capabilities that focus on file extensions as opposed on disks .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This is no less destructive than the disk payloads , of course , and has the advantage of not requiring administrative privileges as well as working without problems on modern 64-bit systems .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Interestingly , the use of Word documents ( instead of Excel ) was also mentioned by ICS-CERT , in their alert 14-281-01B .		others others others others others tool tool others others others tool others others others others others government others others others others others others
It is particularly important to remember that all types of Office documents can contain macros , not just Excel files .		others others others others others others others others others others tool tool others others tool others others others tool tool others
This also includes Word , as shown here and alerted by ICS-CERT and PowerPoint , as previously mentioned by Cys Centrum .		others others others tool others others others others others others others government others tool others others others others others security_team security_team others
In terms of the use of Word documents with macros in APT attacks , we recently observed the Turla group relying on Word documents with macros to drop malicious payloads ( Kaspersky Private report available ) .		others others others others others others tool tool others tool others attack_activity attack_activity others others others others others threatActor_name others others others tool tool others tool others others others others others others others others others others others
This leads us to believe that many of these attacks are successful and their popularity will increase .		others others others others others others others others others others others others others others others others others others
We will continue to monitor the BlackEnergy attacks in Ukraine and update our readers with more data when available .		others others others others others others attack_activity attack_activity others location others others others others others others others others others others
More information about BlackEnergy APT and extended IOCs are available to customers of Kaspersky Intelligence Services .		others others others threatActor_name threatActor_name others others others others others others others others security_team others others others
Contact intelreports@kaspersky.com .		others others others others others
Kaspersky Lab products detect the various trojans mentioned here as : Backdoor.Win32.Fonten .		security_team others others others others others others others others others others others others
* and HEUR : Trojan-Downloader.Script.Generic .		others others malware others others others
To know more about countering BlackEnergy and similar offensives , read this article on Kaspersky Business Blog .		others others others others others threatActor_name others others others others others others others others security_team others others others
BlackEnergy : e15b36c2e394d599a8ab352159089dd2 .		threatActor_name others md5 others
BlackEnergy : ac2d7f21c826ce0c449481f79138aebd .		threatActor_name others md5 others
BlackEnergy : 3fa9130c9ec44e36e52142f3688313ff .		threatActor_name others md5 others
BlackEnergy : 5.149.254.114 .		threatActor_name others IP_evil others