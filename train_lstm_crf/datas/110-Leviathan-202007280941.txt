Leviathan: Espionage actor spearphishes maritime and defense targets .		threatActor_name others others others attack_activity industry others industry others others
Release_Time :  2019-01-29 Report_URL :  https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets Proofpoint researchers are tracking an espionage actor targeting organizations and high-value targets in defense and government .		others others others others others others others others security_team person others others others person person others others others others others others industry others government others
Active since at least 2014 , this actor has long-standing interest in maritime industries , naval defense contractors , and associated research institutions in the United States and Western Europe .		others others others others time others others reference_word others others others others industry others others industry industry others others others others industry others others others location location others location location others
Industry targeting : The actor targets defense contractors , universities ( particularly those with military research ties ) , legal organizations and government agencies .		others others others reference_word reference_word others industry others others industry others others others others others others others others others industry others others government others others
The actor has particular interest in naval industries including shipbuilding and related research .		reference_word reference_word others others others others others others others industry others others industry others
Geographical targeting : Targeting includes United States , Western Europe , and South China Sea .		others others others others others location location others location location others others location location location others
Tools : Custom JavaScript malware known as “ Orz ” and “ NanHaiShu ” , Cobalt Strike , the SeDll JavaScript loader , and MockDll dll loader .		others others others program_language others others others others malware others others others malware others others malware malware others others malware malware malware others others malware malware malware others
Delivery : Emailed attachments and URLs , often employing a fraudulent lookalike domain and stolen branding .		others others sub_activity sub_activity sub_activity sub_activity others others others others sub_activity sub_activity sub_activity others sub_activity sub_activity others
Exploitation : Microsoft Excel and Word documents with macros ( sometimes password-protected ) , very recent vulnerabilities such as CVE-2017-0199 and CVE-2017-8759 , and malicious Microsoft Publisher files .		others others company tool tool tool tool others tool others others others others others others others others others others vulnerability_cve others vulnerability_cve others others others company tool tool others
Installation : JavaScript , JavaScript Scriptlets in XML , HTA , PowerShell , WMI , regsvr32 , Squiblydoo .		others others program_language others program_language program_language others program_language others tool others tool others tool others tool others tool others
Lateral Movement : The actor sometimes utilizes access at one compromised organization to attack the next .		others others others reference_word reference_word others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity others
For example , compromised email accounts at one organization were used to send the next wave of malicious attachments to potential victims in the same industry .		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Similarly the actor attempts to compromise servers within victim organizations and use them for command and control ( C&C ) for their malware .		others reference_word reference_word others others sub_activity sub_activity sub_activity sub_activity sub_activity others others others others tool tool tool others tool tool tool others others others others others
On September 15 and 19 , 2017 , Proofpoint detected and blocked spearphishing emails from this group targeting a US shipbuilding company and a US university research center with military ties .		others time time time time time time others security_team others others others attack_activity tool others others reference_word others others location industry others others others location others industry others others industry others others
Example emails used the subject “ Apply for internship position ” and contained an attachment “ resume.rtf ” .		others tool others others others others string string string string others others others others others others sample_name others others
Another attachment , “ ARLUAS_FieldLog_2017-08-21.doc ” contained a “ Torpedo recovery experiment ” lure .		others others others others sample_name others others others others string string string others others others
The attachments exploited CVE-2017-8759 which was discovered and documented only five days prior to the campaign .		others others others vulnerability_cve others others others others others others others others others others others others others
Between August 2 and 4 , the actor sent targeted spearphishing emails containing malicious URLs linking to documents to multiple defense contractors .		time time time time time others reference_word reference_word others others attack_activity tool others others others others others others others others industry others others
Some of this activity was documented and observed by a fellow researcher .		others others others others others others others others others others others others others
Many of the documents , C&C domains , and payload domains abused the brand of a major provider of ships , submarines , and other vessels with military applications .		others others others others others tool tool tool others others others others others others others others others others others others others others others others others others others others others industry others others
Some of the documents exploited CVE-2017-0199 to deliver the payload .		others others others others others vulnerability_cve others others others others others
Other documents were Microsoft Publisher files that relied on social engineering .		others others others company tool tool others others others others others others
The potential victims were lured into starting an embedded PowerPoint presentation , moving the mouse to trigger execution of an embedded JavaScript , and then pressing “ Enable ” in a warning dialog to cause the payload download .		others others person others sub_activity sub_activity sub_activity sub_activity sub_activity tool sub_activity others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others sub_activity sub_activity others
The Publisher files were poorly crafted , relied on multiple user interactions , and contained multiple grammatical and typographic errors .		others tool others others others others others others others others others others others others others others others others others others others
From February to October of 2015 , our colleagues at F-Secure and McAfee reported on campaigns by this actor targeting South China Sea interests .		others time time time time time others others person others security_team others security_team others others others others others reference_word others location location location others others
During this time , the group utilized Microsoft Excel and Word documents with macros to target the Philippines Department of Justice , APEC organizers , and an international law firm .		others others others others reference_word reference_word others company tool tool tool tool others tool others others others location government government government others government others others others others others industry others others
Targeting of these companies is different from that which we typically observe for this actor ; however it still centers around marine and naval issues as related to South China sea politics .		others others others others others others others others others others others others others others reference_word others others others others others others industry others industry others others others others location location location others others
The period between November 2014 and January 2015 marked one of the earlier instances in which Proofpoint observed persistent exploitation attempts by this actor .		others others time time time time time time others others others others others others others others security_team others sub_activity sub_activity sub_activity others others reference_word others
The actor generally emailed Microsoft Excel documents with malicious macros to US universities with military interests , most frequently related to the Navy .		others reference_word others others company tool tool others others tool others location industry others industry others others others others others others others industry others
The actor also occasionally used macro-laden Microsoft Word documents to target other US research and development organizations with military and intelligence ties during this period .		others reference_word others others others others company tool tool others others others location industry sub_activity industry sub_activity others industry sub_activity sub_activity sub_activity others others others others
Emails were often very simple with a greeting and an attachment .		tool others others others others others others others others others others others
On other occasions , it appears that the attackers used highly topical lures based on current events or legitimate documents stolen from previous victims .		others others others others others others others reference_word reference_word sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others
Lure topics included symposia , the Navy , IT , and relevant research .		others others others others others others industry others industry others others others industry others
The actor continues to : Innovate and modify the code that accomplishes the installation , while the backdoor code remains more static ; Use scripting languages such as JavaScript , JavaScript Scriptlets , VBScript , and XML ; Use simple obfuscation such as base64 , gzip compression , and insertion of garbage characters ; Split functionality of the backdoor & code that establishes persistence for the backdoor into separate files and scripts .		reference_word reference_word others others others others others others others others others others others others others others others malware others others others others others others others others others others program_language others program_language program_language others program_language others others program_language others others others others others others encryption_algo others encryption_algo encryption_algo others others others others encryption_algo encryption_algo others sub_activity sub_activity sub_activity sub_activity malware sub_activity sub_activity others sub_activity sub_activity others others malware others others others others others others
The “ resume.rtf ” file from the September 19 , 2017 attack retrieves the malicious SOAP WSDL definition named “ readme.txt “ using an anonymous FTP logon to the attacker ’s server .		others others sample_name others others others others time time time time others sub_activity sub_activity sub_activity protocol program_language sub_activity sub_activity sub_activity sample_name sub_activity others others others protocol others others others others others others others others
This definition in turn downloads a VBScript favicon.ico file , which then creates and runs two JavaScript files in the %TMP% directory .		others others others others others others program_language sample_name others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others location location location others others
The job of the smaller of the two JavaScripts is to establish a system autostart mechanism .		others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity others
It accomplishes this by deobfuscating another script , link.js , into %TMP% .		others others others others others others others others sample_name others others location location location others
Link.js in turn creates a shortcut  file "Java (TM ) Platform SE Auto Updater.lnk" in the "Startup" special folder pointing to the main backdoor JavaScript .		sample_name others others others others others others others sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name others sample_name others others others others others others others others others others malware program_language others
The job of the larger of the two JavaScripts is to download and execute the Cobalt Strike payload .		others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
It accomplishes this by writing more code to rWug5n0PHUFjDFyb8k.js in the temporary directory , which then runs a PowerShell command ( obfuscated using garbage characters , base64 encoding , and Gzip compression ) .		others others others others others others others others sample_name others others others others others others others sample_function sample_function tool sample_function others others others encryption_algo encryption_algo others encryption_algo others others others encryption_algo encryption_algo others others
The PowerShell is a default Cobalt Strike downloader .		others tool others others others malware malware others others
The malicious script executed by the Microsoft Publisher file downloads and runs yet another JavaScript file , 0.js , hosted on the attacker-controlled server .		others others others others others others company tool tool sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_name others others others others others others others
Similar to the previous example ( resume.rtf ) , the 0.js handles the system autostart mechanism via a shortcut file "office 365.lnk" in the "Startup" special folder .		others others others others others others sample_name others others others sample_name sample_function sample_function sample_function sample_function sample_function others others others others others sample_name sample_name others others others others others others others others others
However , the shortcut abuses the “ Squiblydoo ” technique .		others others others others others others others string others others others
Moreover , the backdoor is not run directly but via an intermediary SeDll .		others others others malware others others others others others others others others malware others
0.js also downloads two additional files from the C&C server ( green.ddd and green.tmp ) The first of these files , green.ddd , is an executable file internally named “ SEDll_Win32.dll ” .		sample_name others sample_function sample_function sample_function sample_function sample_function sample_function sub_activity sub_activity sub_activity sample_function others sample_name others sample_name others others others others others others others sample_name others others others others others others others others sample_name others others
This is a known backdoor used by this actor since 2014 for the same purpose : decrypting and executing the final JavaScript backdoor “ Orz ” .		others others others others malware others others others reference_word time time others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
We have observed variants of this JavaScript backdoor used in various campaigns , including those publically reported .		others others others others others others program_language malware others others others others others others others others others others
The actor continues to improve and refine the malware by , for example , wrapping it inside an HTA wrapper .		reference_word reference_word others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity tool tool others
Several good descriptions are available  in analyses from fellow researchers .		others others others others others others others others others others others
Basic functionality includes : Information gathering ( computer name , user name , serial number , proxy server ) ; Downloading from URL ; Executing other JavaScript ; Registry , system , process , directory , file operations ; SafeIE ( change IE settings to reduce warnings about about malware activity ) .		others others others others sample_function sample_function others others others others others others others others others others others others others others sample_function sample_function sample_function others sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_function others sub_activity tool sub_activity sub_activity sub_activity sub_activity others others others others others others
We observed this backdoor in an August 2017 campaign dropped by the Microsoft Publisher files , as well as much earlier in 2014 .		others others others malware others others time time others others others others company tool tool others others others others others others time time others
We named it due to a variable name “ orz ” , which is changed to “ core ” in the more recent version .		others others others others others others others others others malware others others others others others others others malware others others others others others others others
The actor consistently tweaks and improves this backdoor as well .		reference_word reference_word others others others others others others others others others
The backdoor is a fairly involved script malware .		reference_word reference_word others others others others others others others
Its functionality includes : Information gathering ( IE version , OS version , OS 64-bit/32-bit , etc ) ; Overwriting registry settings to reduce malware visibility on system ; Download file ; Upload file ; Execute a command with cscript ; Execute JavaScript ; Execute shell command ; Execute a dll ( via an embedded ‘ MockDll' ) ; Get proxy info ; Get process list ; Terminate process ; Get drive info ; GET request to a URL ; POST request to a URL .		others others others others sample_function sample_function others tool others others others others others others others others others others others sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function others sample_function sample_function others sample_function sample_function others sample_function sample_function sample_function sample_function sample_function others sample_function sample_function others sample_function sample_function sample_function others sample_function sample_function sample_function others others others others others malware others others others sample_function sample_function sample_function others sample_function sample_function sample_function others sample_function sample_function others sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function others
There is an extensive configuration section at the top of the script .		others others others others others others others others others others others others others
The "jmpUrlList" provides the initial C&C servers , which are used to determine the secondary C&C server as well as additional commands to execute .		others others string others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others
It is worth noting that the secondary C&C may be the same as the first .		others others others others others others others sub_activity sub_activity sub_activity others others others others others others others others
We have observed attacker-controlled web servers , compromised victim web servers , and Technet and Pastebin web pages used for the initial C&C .		others others others others others others others others others others others others others others others others others others others others others others tool tool tool others
The initial C&C response is parsed with a regex .		others others tool tool tool others others others others others others others
The backdoor first looks for the secondary encoded C&C server using the "jmpRegex" regex .		reference_word reference_word others sample_function sample_function sample_function sample_function sample_function tool tool tool sample_function others others others string others others others
Next , the backdoor looks for additional code to execute using the "codeRegex" regex .		others others reference_word reference_word others others others others others others others others others string others others others
For additional code , we observed simple code blocks that provide a different upload/download functionality .		others others others others others others others others others others others others others others others others
Some versions of the Orz backdoor have 32- and 64-bit embedded DLLs , stored internally as base64 strings .		others others others others malware malware others others others others others string others others others others encryption_algo others others
Their purpose is to simply run another binary .		others others others others others others others others others
These are used as loaders for future executable payloads , using the well-known process hollowing technique .		others others others others others others others others others others others others others others others others others
To use the MockDll , the backdoor creates a configuration .ini file .		others others others malware others others malware sample_function sample_function sample_function sample_function sample_function others
After the configuration file is created , the MockDll is executed with regsvr32 .		others others others others others others others others malware others others others tool others
MockDll reads the mentioned .ini config file to determine what to execute .		malware others others others others others others others others others others others others
It can log its execution results into a file specified by the “ outf ” parameter .		others others others others others others others others others others others others others string others others others
This DLL is used for decrypting and executing another JavaScript backdoor such as Orz .		others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others malware others
The DLL is registered by the installer using regsvr32 .		others others others others others others others others tool others
The DllRegisterServer export is then called , which performs checks on the commandline parameter .		others tool others others others others others others others others others others others others others
If the string “ DR ” is passed as an argument , or if the DLL is running in the active session with a username that is not “ system ” , the final JavaScript backdoor is decoded using a custom base64 alphabet .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others encryption_algo others others
This backdoor has to be present in the same directory as the dll , with a “ .tmp ” file extension .		others others others others others others others others others others others others others others others others others others others others others others
The backdoor script is then executed using the IActiveScript and IActiveScriptParse32 COM interfaces .		others others others others others others others others function others function function others others
If those conditions are not met , it runs the following command line “ "regsvr32 /s \"%s\" DR __CIM__" ” to register the DLL , where %s is the path to the DLL .		others others others others others others others others others others others others others others others string string string others string string others string string others others others sample_function others others others others others others others others others others others others others
It tries to do this with the current user privileges , but if the privileges cannot be adjusted it defaults to the available execution environment .		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Cobalt Strike : This is a penetration testing tool , The attackers often abuse the free trial version .		malware malware others others others others sub_activity sub_activity sub_activity others others others others others others others others others others
This actor , whose espionage activities primarily focus on targets in the US and Western Europe with military ties , has been active since at least 2014 .		others reference_word others others others others others others others others others others location target_crowd location location target_crowd target_crowd target_crowd others others others others others others others time others
The tools , techniques , and targets consistently connect their work , particular given their attention to naval and maritime defense interests and use of custom backdoors .		others others others others others others others others others others others others others others others others others industry others industry industry others others others others others malware others
While defense contractors and academic research centers with military ties should always be cognizant of the potential for cyberattacks , organizations fitting their targeting profiles should be especially wary of legitimate-looking but unsolicited emails from outside entities .		others industry others others company company company others industry others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Appropriate layered defenses at the firewall , email gateway , and endpoint can all help prevent the kinds of lateral movement we have observed with this actor , as well as the compromise and abuse of systems via which this group expands its attack surface to other organizations .		others others others others others counter_measure others counter_measure counter_measure others others counter_measure others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Leviathan : Resume.rtf , exploiting CVE-2017-8759 , cdf6e2e928a89cbb857e688055a25e37a8d8b8b90530bd52c8548fb544f66f1f .		threatActor_name others sample_name others others vulnerability_cve others sha2 others
Leviathan : ARLUAS_FieldLog_2017-08-21.doc , exploiting CVE-2017-8759 , c7fa6f27ec4f4142ae591f2dd7c63d046431945f03c87dbed88d79f55180a46d .		threatActor_name others sample_name others others vulnerability_cve others sha2 others
Leviathan : ftp://185.106.120.206/pub/readme.txt , Resume.rtf , downloading scripts .		threatActor_name others url_evil url_evil url_evil others sample_name others sample_function sample_function others
Leviathan : http://185.106.120.206/favicon.ico , Resume.rtf , downloading scripts .		threatActor_name others url_evil url_evil url_evil others sample_name others sample_function sample_function others
Leviathan : Favicon.ico , 39c952c7e14b6be5a9cb1be3f05eafa22e1115806e927f4e2dc85d609bc0eb36 .		threatActor_name others sample_name others sha2 others
Leviathan : Cobalt Strike , 5860ddc428ffa900258207e9c385f843a3472f2fbf252d2f6357d458646cf362 .		threatActor_name others malware malware others sha2 others
Leviathan : 20170720_final_pm_app-2.doc , ced7ca9625543d3d3d09f70223cc19f0d99e21792854452df5ba84b3a59d17b8 .		threatActor_name others sample_name others sha2 others