Detecting threat actors in recent German industrial attacks with Windows Defender ATP .		others others others others others location others others others tool tool tool others
Detecting threat actors in recent German industrial attacks with Windows Defender ATP .		others others others others others location others others others tool tool tool others
Release_Time : 2017-02-25 Report_URL : https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/ When a Germany-based industrial conglomerate disclosed in December 2016 that it was breached early that year , the breach was revealed to be a professionally run industrial espionage attack .		others others others others others others others others others others others company company others others time time others reference_word others others others others others others others others others others others others others others others others others others others
According to the German press , the intruders used the Winnti family of malware as their main implant , giving them persistent access to the conglomerate ’s network as early as February 2016 .		others others others location others others others others others others malware others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others time time others
In this blog , we look at the Winnti malware implant as used by two known activity groups BARIUM and LEAD .		others others others others others others others others malware others others others others others others others others others threatActor_name others threatActor_name others
We look at how these activity groups introduce the implant to various targets and techniques used by Microsoft researchers to track the implant .		others others others others others others others others others others others others others others others others others company others others others others others others
To show how this breach and similar breaches can be mitigated , we look at how Windows Defender Advanced Threat Protection ( Windows Defender ATP ) flags activities associated with BARIUM , LEAD , and other known activity groups and how it provides extensive threat intelligence about these groups .		others others others others others others others others others others others others others others others others tool tool tool tool tool others tool tool tool others others others others others threatActor_name others threatActor_name others others others others others others others others others others others others others others others others others
We go through the Winnti implant installation process and explore how Windows Defender ATP can capture such attacker methods and tools and provide visualized contextual information that can aid in actual attack investigation and response .		others others others others malware others others others others others others tool tool tool others others others others others others others others others others others others others others others others others others others others others others
We then discuss how centralized response options , provided as enhancements to Windows Defender ATP with the Windows 10 Creators Update , can be used to quickly stop threats , including stopping command and control ( C&C ) communication and preventing existing implants from installing additional components or from moving laterally to other computers on the network .		others others others others tool tool tool others others others others others tool tool tool others OS_name OS_name OS_name OS_name OS_name others others others others others sample_function sample_function sample_function others others others others others others others protocol protocol protocol others others others others others others others others others others others others others others others others others others others others others
Microsoft Threat Intelligence associates Winnti with multiple activity groups—collections of malware , supporting infrastructure , online personas , victimology , and other attack artifacts that the Microsoft intelligent security graph uses to categorize and attribute threat activity .		security_team security_team security_team others malware others others others others others others others others others others others others others others others others others others others others security_team security_team security_team security_team security_team others others others others others others others others
Microsoft labels activity groups using code names derived from elements in the periodic table .		company others others others others others others others others others others others others others others
In the case of this malware , the activity groups strongly associated with Winnti are BARIUM and LEAD .		others others others others others others others others others others others others others malware others threatActor_name others threatActor_name others
But even though they share the use of Winnti , the BARIUM and LEAD activity groups are involved in very different intrusion scenarios .		others others others reference_word others others others others malware others others threatActor_name others threatActor_name others others others others others others others others others others
BARIUM begins its attacks by cultivating relationships with potential victims—particularly those working in Business Development or Human Resources—on various social media platforms .		threatActor_name others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Once BARIUM has established rapport , they spear-phish the victim using a variety of unsophisticated malware installation vectors , including malicious shortcut ( .lnk ) files with hidden payloads , compiled HTML help ( .chm ) files , or Microsoft Office documents containing macros or exploits .		others threatActor_name others others others others reference_word sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others tool tool tool tool tool tool others others others others tool tool tool tool tool tool tool others others tool tool tool others others others others others
Initial intrusion stages feature the Win32/Barlaiy implant—notable for its use of social network profiles , collaborative document editing sites , and blogs for C&C .		others others others others others malware others others others others others tool tool tool others tool tool tool tool others others tool others protocol protocol protocol others
Later stages of the intrusions rely upon Winnti for persistent access .		others others others others others others others malware others sample_function sample_function others
The majority of victims recorded to date have been in electronic gaming , multimedia , and Internet content industries , although occasional intrusions against technology companies have occurred .		others others others others others others others others others others industry industry others industry others others industry industry industry others others others others others company company others others others
In contrast , LEAD has established a far greater reputation for industrial espionage .		others others others threatActor_name others others others others others others others others others others
In the past few years , LEAD ’s victims have included :  Multinational , multi-industry companies involved in the manufacture of textiles , chemicals , and electronics .		others others others others others others threatActor_name others others others others others others company company company company company company company company company company company company company company company others
Pharmaceutical companies .		company company others
A company in the chemical industry .		company company company company company company others
University faculty specializing in aeronautical engineering and research .		target_crowd target_crowd target_crowd target_crowd target_crowd target_crowd target_crowd target_crowd others
A company involved in the design and manufacture of motor vehicles .		company company company company company company company company company company company others
A cybersecurity company focusing on protecting industrial control systems .		company company company company company company company company company others
During these intrusions , LEAD ’s objective was to steal sensitive data , including research materials , process documents , and project plans .		others others others others threatActor_name others others others others others attack_goal attack_goal attack_goal others others others others others others others others others others others others
LEAD also steals code-signing certificates to sign its malware in subsequent attacks .		threatActor_name others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
In most cases , LEAD ’s attacks do not feature any advanced exploit techniques .		others others others others threatActor_name others others others others others others others others others others others
The group also does not make special effort to cultivate victims prior to an attack .		reference_word reference_word others others others others others others others others others others others others others others
Instead , the group often simply emails a Winnti installer to potential victims , relying on basic social engineering tactics to convince recipients to run the attached malware .		others others reference_word reference_word others others sub_activity sub_activity tool tool sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others
In some other cases , LEAD gains access to a target by brute-forcing remote access login credentials , performing SQL injection , or exploiting unpatched web servers , and then they copy the Winnti installer directly to compromised machines .		others others others others others threatActor_name sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity tool tool sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Microsoft Analytics shows that Winnti has been used in intrusions carried out throughout Asia , Europe , Oceania , the Middle East , and the United States in the last six months ( Figure 1 ) .		security_team security_team others others malware others others others others others others others others location others location others location others location location location others others location location location others others time time time others others others others others
The most recent series of attacks observed was in December 2016 .		others others others others others others others others others time time others
Although tracking threats like Winnti involves old-fashioned investigative work , Microsoft Threat Intelligence analysts take advantage of machine learning to work at scale .		others others others others malware others others others others others person person person person others others others tool tool others others others others others
When attackers used Winnti to maintain access to web servers , they hid the implant in plain sight by masquerading it as a trusted , legitimate file .		others person others malware others sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function sample_function sample_function others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
This was the case in two known intrusions in 2015 , where attackers named the implant DLL “ ASPNET_FILTER.DLL ” to disguise it as the DLL for the ASP.NET ISAPI Filter .		others others others others others others others others others time others others person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Although there are obvious differences between the legitimate file and the malicious one , filtering out the malicious file would involve going through a data set with noise from millions of possible file names , software publishers , and certificates .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Microsoft researchers used a combination of anomaly detection and supervised machine learning to reduce the data set and separate meaningful , malware-related anomalies from benign data .		person person others others others others tool tool others tool tool tool others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Windows Defender ATP helps network security professionals deal with intrusions from activity groups like LEAD and BARIUM in several ways .		tool tool tool others person person person others others others others others others others threatActor_name others threatActor_name others others others others
The following examples were developed using a Winnti installer that was used in attacks in December 2016 .		others others others others others others others malware others others others others others others others time time others
Microsoft Threat Intelligence continually tracks activity groups such as LEAD and BARIUM and documents the tactics , techniques , and procedures they employ in their attacks , with a special focus on the tools and infrastructure they use to facilitate those attacks .		security_team security_team security_team others others others others others others threatActor_name others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Windows Defender ATP continuously monitors protected systems for such indicators of hostile activity and alerts security operations center ( SOC ) personnel to their presence .		tool tool tool others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_function tool tool tool sample_function tool sample_function sample_function sample_function sample_function sample_function others
To provide context around such alerts , Windows Defender ATP also features a short summary of the group ’s history , goals , methods , and tools , with links to extensive documentation for technically minded users .		others others others others others others others tool tool tool others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function others others others others others
Windows Defender ATP is also capable of detecting previously unknown attacks by monitoring system behavior indicative of hostile activity , including :  Malware installation , persistence , and activation .		tool tool tool others others others others sample_function sample_function sample_function sample_function others others others others others others others others others others others others others others others others others others others
Backdoor command and control .		others others others others others
Credential theft .		others others others
Lateral movement to other machines on the network .		others others others others others others others others others
For example , numerous malware families register themselves as services during installation to guarantee persistence across reboots .		others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others
A majority of malware that perform this persistence technique modify the necessary registry keys in ways that do not fit the profile of a legitimate program .		others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Winnti is no exception , and so , during Winnti ’s installation process , Windows Defender ATP is able to raise behavioral alerts .		malware others others others others others others others others malware others others others others others tool tool tool others others others sample_function sample_function sample_function others
To improve coverage while minimizing false positives , Windows Defender ATP uses the intelligent security graph to differentiate between suspicious and benign behavior before generating alerts .		others sample_function sample_function sample_function sample_function sample_function sample_function others tool tool tool sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
It considers the age of the file , its global prevalence , and the presence and validity of a digital signature along with the method of service creation .		reference_word sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
For alerts raised either by specific threat intelligence tied to activity groups or by more generic suspicious behaviors , Windows Defender ATP provides rich , visualized technical context .		others others others others others others others others others others others others others others others others others others others tool tool tool sample_function sample_function sample_function sample_function sample_function sample_function others
This visual context enables SOC personnel to investigate alerts with all related artifacts , understand the scope of the breach , and prepare a comprehensive action plan .		others others others others person person others others others others others others others others others others others others others others others others others others others others others others
In the screenshots below , Windows Defender ATP clearly presents the Winnti installation where an installer drops a DLL to disk , loads the DLL using rundll32 , sets the DLL as a service , and saves a copy of itself in C:\Windows\Help .		others others others others others tool tool tool others sample_function sample_function attack_activity attack_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Windows Defender ATP displays these activities as process trees in a machine timeline for the infected computer .		tool tool tool sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Analysts can easily extract detailed information from these trees , such as the implant DLL dropped by the installer , the command used to call rundll32.exe and load the DLL , and the registry modifications that set the DLL as a service .		person others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
This information can provide an initial means by which to assess the scope of the breach .		others others others others others others others others others others others others others others others others others
The Windows 10 Creators Update will bring several enhancements to Windows Defender ATP that will provide SOC personnel with options for immediate mitigation of a detected threat .		OS_name OS_name OS_name OS_name OS_name others others others others others tool tool tool others others sample_function person sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
If an intruder compromises a computer that has been onboarded to Windows Defender ATP , SOC personnel can isolate the computer from the network , blocking command and control of the implant and preventing attackers from installing additional malware and moving laterally to other computers in the network .		others others person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity tool tool tool others person person others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
Meanwhile , connectivity to the Windows Defender ATP service is maintained .		others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
While the machine is in isolation , SOC personnel can direct the infected machine to collect live investigation data , such as the DNS cache or security event logs , which they can use to verify alerts , assess the state of the intrusion , and support follow-up actions .		others others others others others others others person person others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others protocol others others others others others others others others others others others others others others others others others others others others others others others others others others
Another option is to simply halt and quarantine the Winnti implant itself , stopping the intrusion on a single machine .		others others others others others others others others others malware malware others others others others others others others others others others
LEAD and BARIUM are not known for large-scale spear-phishing , so it is unlikely that SOC personnel would have to deal with multiple machines having been compromised by these groups at the same time .		threatActor_name others threatActor_name others others others others attack_activity attack_activity others others others others others others person person others others others others others others others others others others others reference_word reference_word others others others others others
Nevertheless , Windows Defender ATP also supports blocking the implant across the entire enterprise , stopping large-scale intrusions in the early stages .		others others tool tool tool others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
With the enhanced post-breach detection capabilities of Windows Defender ATP , SOC personnel are able to reduce this period to hours or even minutes , significantly lessening the potential impact of persistent attacker access to their network .		others others tool tool tool tool others tool tool tool others person person others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others person others others others others others
Windows Defender ATP provides extensive information about activity groups responsible for the attacks , enabling customers to understand aspects of the attack that may not be obtained by network and endpoint sensors , such as common social engineering lures and the regional nature of an attack .		tool tool tool sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others others others others others
With relevant visualized information , analysts are able to study malware behavior on impacted machines , so they can investigate further and plan out their response .		others tool tool tool others person others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others others others
And , finally , with the upcoming Creators Update , Windows Defender ATP will provide additional capabilities for detecting threats such as Winnti , as well as centralized response options , such as machine isolation and file blocking , that will enable fast containment of known attack jump off points .		others others others others others others others OS_name OS_name others tool tool tool others sample_function sample_function sample_function sample_function sample_function sample_function others others malware others others others others sample_function sample_function sample_function others others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others