Attackers Deploy New ICS Attack Framework “TRITON” and Cause Operational Disruption to Critical Infrastructure .		others others others others others others others malware others others others others others others others others others
Release_Time:2017-12-14 Report_URL:https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html  Mandiant recently responded to an incident at a critical infrastructure organization where an attacker deployed malware designed to manipulate industrial safety systems.		others others others others others others security_team others others others others others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal others
The targeted systems provided emergency shutdown capability for industrial processes.		others others others others others others others others others others others
We assess with moderate confidence that the attacker was developing the capability to cause physical damage and inadvertently shutdown operations.		others others others others others others others others others others others others others others others others others others others others others
This malware, which we call TRITON, is an attack framework built to interact with Triconex Safety Instrumented System (SIS) controllers.		others others others others others others malware others others others others others others others others others others others others others others others others others others
We have not attributed the incident to a threat actor, though we believe the activity is consistent with a nation state preparing for an attack.		others others others others others others others others others others others others others others others others others others others others others others others others others others others
TRITON is one of a limited number of publicly identified malicious software families targeted at industrial control systems (ICS).		malware others others others others others others others others others others others others others others industry industry industry others others others others
It follows Stuxnet which was used against Iran in 2010 and Industroyer which we believe was deployed by Sandworm Team against Ukraine in 2016.		others others malware others others others others location others time others others others others others others others others threatActor_name others others location others time others
TRITON is consistent with these attacks, in that it could prevent safety mechanisms from executing their intended function, resulting in a physical consequence.		malware others others others others others others others others others others others others others others others others others others others others others others others others others
TRITON:trilog.exe Main executable leveraging libraries.zip library.zip Custom communication library for interaction with Triconex controllers.		malware others sample_name sample_function sample_function sample_function sample_function sample_name sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
The attacker gained remote access to an SIS engineering workstation and deployed the TRITON attack framework to reprogram the SIS controllers.		others others others others others others others others others others others others others malware others others others sub_activity sub_activity sub_activity sub_activity others
During the incident, some SIS controllers entered a failed safe state, which automatically shutdown the industrial process and prompted the asset owner to initiate an investigation.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The investigation found that the SIS controllers initiated a safe shutdown when application code between redundant processing units failed a validation check -- resulting in an MP diagnostic failure message.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
We assess with moderate confidence that the attacker inadvertently shutdown operations while developing the ability to cause physical damage for the following reasons: Modifying the SIS could prevent it from functioning correctly, increasing the likelihood of a failure that would result in physical consequences.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
TRITON was used to modify application memory on SIS controllers in the environment, which could have led to a failed validation check.		malware others others others attack_goal attack_goal attack_goal others others others others others others others others others others others others others others others others others
The failure occurred during the time period when TRITON was used.		others others others others others others others others malware others others others
It is not likely that existing or external conditions, in isolation, caused a fault during the time of the incident.		others others others others others others others others others others others others others others others others others others others others others others others
FireEye has not connected this activity to any actor we currently track; however, we assess with moderate confidence that the actor is sponsored by a nation state.		security_team others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The targeting of critical infrastructure as well as the attacker’s persistence, lack of any clear monetary goal and the technical resources necessary to create the attack framework suggest a well-resourced nation state actor.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Specifically, the following facts support this assessment: The attacker targeted the SIS suggesting an interest in causing a high-impact attack with physical consequences.		others others others others others others others others others others others others others others others others others others others others others others others others others others
This is an attack objective not typically seen from cyber-crime groups.		others others others others others others others others others others others others
The attacker deployed TRITON shortly after gaining access to the SIS system, indicating that they had pre-built and tested the tool which would require access to hardware and software that is not widely available.		others others others malware others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others others others others others
TRITON is also designed to communicate using the proprietary TriStation protocol which is not publicly documented suggesting the adversary independently reverse engineered this protocol.		malware others others others others others others others others protocol others others others others others others others others others others others others others others others
The targeting of critical infrastructure to disrupt, degrade, or destroy systems is consistent with numerous attack and reconnaissance activities carried out globally by Russian, Iranian, North Korean, U.S., and Israeli nation state actors.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Intrusions of this nature do not necessarily indicate an immediate intent to disrupt targeted systems, and may be preparation for a contingency.		others others others others others others others others others others others others others others others others others others others others others others others others
Modern industrial process control and automation systems rely on a variety of sophisticated control systems and safety functions.		others others others others others others others others others others others others others others others others others others others
These systems and functions are often referred to as Industrial Control Systems (ICS) or Operational Technology (OT).		others others others others others others others others others others others others others others others others others others others others others others
A Distributed Control System (DCS) provides human operators with the ability to remotely monitor and control an industrial process.		others others others others others others others others others others others others others others others others others others others others others others
It is a computerized control system consisting of computers, software applications and controllers.		others others others others others others others others others others others others others others others
An Engineering Workstation is a computer used for configuration, maintenance and diagnostics of the control system applications and other control system equipment.		others others others others others others others others others others others others others others others others others others others others others others others others
A SIS is an autonomous control system that independently monitors the status of the process under control.		others others others others others others others others others others others others others others others others others others
If the process exceeds the parameters that define a hazardous state, the SIS attempts to bring the process back into a safe state or automatically performs a safe shutdown of the process.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
If the SIS and DCS controls fail, the final line of defense is the design of the industrial facility, which includes mechanical protections on equipment (e.g.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
rupture discs), physical alarms, emergency response procedures and other mechanisms to mitigate dangerous situations.		others others others others others others others others others others others others others others others others others others
Asset owners employ varied approaches to interface their plant's DCS with the SIS.		others others others others others others others others others others others others others others others
The traditional approach relies on the principles of segregation for both communication infrastructures and control strategies.		others others others others others others others others others others others others others others others others others
For at least the past decade, there has been a trend towards integrating DCS and SIS designs for various reasons including lower cost, ease of use, and benefits achieved from exchanging information between the DCS and SIS.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
We believe TRITON acutely demonstrates the risk associated with integrated designs that allow bi-directional communication between DCS and SIS network hosts.		others others malware others others others others others others others others others others others others others others others others others others others
The attack lifecycle for disruptive attacks against ICS is similar to other types of cyber attacks, with a few key distinctions.		others others others others others others others others others others others others others others others others others others others others others others others
First, the attacker’s mission is to disrupt an operational process rather than steal data.		others others others others others others others others others attack_goal attack_goal attack_goal attack_goal others others others others others
Second, the attacker must have performed OT reconnaissance and have sufficient specialized engineering knowledge to understand the industrial process being controlled and successfully manipulate it.		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Even if cyber security measures fail, safety controls are designed to prevent physical damage.		others others others others others others others others others others others others others others others others
To maximize physical impact, a cyber attacker would also need to bypass safety controls.		others others others others others others others others others others others others others others others others
The SIS threat model below highlights some of the options available to an attacker who has successfully compromised an SIS.		others others others others others others others others others others others others others others others others others others others others others
Attack Option 1: Use the SIS to shutdown the process.		others others others others others others others others others others others others
The attacker can reprogram the SIS logic to cause it to trip and shutdown a process that is, in actuality, in a safe state.		others others others others others others others others others others others others others others others others others others others others others others others others others others others
In other words, trigger a false positive.		others others others others others others others others others
Implication: Financial losses due to process downtime and complex plant start up procedure after the shutdown.		others others others others others others others others others others others others others others others others others others
Attack Option 2: Reprogram the SIS to allow an unsafe state.		others others others others others others others others others others others others others
The attacker can reprogram the SIS logic to allow unsafe conditions to persist.		others others others others others others others others others others others others others others
Implication: Increased risk that a hazardous situation will cause physical consequences (e.g.		others others others others others others others others others others others others others others others
impact to equipment, product, environment and human safety) due to a loss of SIS functionality.		others others others others others others others others others others others others others others others others others others others
Attack Option 3: Reprogram the SIS to allow an unsafe state – while using the DCS to create an unsafe state or hazard.		others others others others others others others others others others others others others others others others others others others others others others others others others
The attacker can manipulate the process into an unsafe state from the DCS while preventing the SIS from functioning appropriately.		others others others others others others others others others others others others others others others others others others others others others
Implication: Impact to human safety, the environment, or damage to equipment, the extent of which depends on the physical constraints of the process and the plant design.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
We assess with moderate confidence that the attacker’s long-term objective was to develop the capability to cause a physical consequence.		others others others others others others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal others
We base this on the fact that the attacker initially obtained a reliable foothold on the DCS and could have developed the capability to manipulate the process or shutdown the plant, but instead proceeded to compromise the SIS system.		others others others others others others others others others others others others others others others others others others others others others others others others sample_function sample_function sample_function others sample_function sample_function sample_function others others others others others others others others others others
Compromising both the DCS and SIS system would enable the attacker to develop and carry out an attack that causes the maximum amount of damage allowed by the physical and mechanical safeguards in place.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Once on the SIS network, the attacker used their pre-built TRITON attack framework to interact with the SIS controllers using the TriStation protocol.		others others others others others others others others others others others malware others others others others others others others others others others protocol others others
The attacker could have caused a process shutdown by issuing a halt command or intentionally uploading flawed code to the SIS controller to cause it to fail.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Instead, the attacker made several attempts over a period of time to develop and deliver functioning control logic for the SIS controllers in this target environment.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
While these attempts appear to have failed due one of the attack scripts’ conditional checks, the attacker persisted with their efforts.		others others others others others others others others others others others others others others others others others others others others others others others others
This suggests the attacker was intent on causing a specific outcome beyond a process shutdown.		others others others others others others others others others others others others others others others others
Of note, on several occasions, we have observed evidence of long term intrusions into ICS which were not ultimately used to disrupt or disable operations.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
For instance, Russian operators, such as Sandworm Team, have compromised Western ICS over a multi-year period without causing a disruption.		others others others others others others others others threatActor_name threatActor_name others others others industry industry others others others others others others others others others
The TRITON attack tool was built with a number of features, including the ability to read and write programs, read and write individual functions and query the state of the SIS controller.		others malware others others others others others others others others others others others others others others sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
However, only some of these capabilities were leveraged in the trilog.exe sample (e.g.		others others others others others others others others others others others sample_name others others others others
the attacker did not leverage all of TRITON’s extensive reconnaissance capabilities).		others others others others others others others malware others others sample_function sample_function sample_function others others
The TRITON malware contained the capability to communicate with Triconex SIS controllers (e.g.		others malware others others others others others sample_function sample_function sample_function sample_function sample_function others others others
send specific commands such as halt or read its memory content) and remotely reprogram them with an attacker-defined payload.		sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function others others others others others
The TRITON sample Mandiant analyzed added an attacker-provided program to the execution table of the Triconex controller.		others malware others security_team others others others others others others others others others others others company others others
This sample left legitimate programs in place, expecting the controller to continue operating without a fault or exception.		others others others others others others others others others others others others others others others others others others others others
If the controller failed, TRITON would attempt to return it to a running state.		others others others others others malware others others others others others others others others others others
If the controller did not recover within a defined time window, this sample would overwrite the malicious program with invalid data to cover its tracks.		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Asset owners who wish to defend against the capabilities demonstrated in the incident, should consider the following controls: Where technically feasible, segregate safety system networks from process control and information system networks.		person person others others others others others others others others others others others others others others others others others others others others others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others
Engineering workstations capable of programming SIS controllers should not be dual-homed to any other DCS process control or information system network.		others others others others others others others others others others others others others others others others others others others others others others
Leverage hardware features that provide for physical control of the ability to program safety controllers.		counter_measure counter_measure counter_measure others others others others others others others others others others others others others
These usually take the form of switches controlled by a physical key.		others others others others others others others others others others others others others
On Triconex controllers, keys should not be left in the PROGRAM mode other than during scheduled programming events.		others company others others others others others others others others others others others others others others others others others others
Implement change management procedures for changes to key position.		counter_measure counter_measure counter_measure counter_measure others others others others others others
Audit current key state regularly.		others others others others others others
Use a unidirectional gateway rather than bidirectional network connections for any applications that depend on the data provided by the SIS.		counter_measure counter_measure counter_measure counter_measure others others others others others others others others others others others others others others others others others others
Implement strict access control and application whitelisting on any server or workstation endpoints that can reach the SIS system over TCP/IP.		counter_measure counter_measure counter_measure counter_measure others counter_measure counter_measure others others others others others others others others others others others others others others others
Monitor ICS network traffic for unexpected communication flows and other anomalous activity.		counter_measure counter_measure counter_measure counter_measure others others others others others others others others others
TRITON was deployed on an SIS engineering workstation running the Microsoft Windows operating system.		malware others others others others others others others others others OS_name OS_name others others others
The malware was named to masquerade as the legitimate Triconex Trilog application.		others others others others others others others others others tool tool tool others
This application is used for reviewing logs and is a part of the TriStation application suite.		others others others others others sample_function sample_function others others others others others others others others others others
The malware was delivered as a Py2EXE compiled python script dependent on a zip file containing standard Python libraries, open source libraries, as well as the attacker-developed Triconex attack framework for interacting with the Triconex controllers.		others others others others others others tool others program_language others others others others others others others others program_language others others others others others others others others others others others others others others others others others others others others others
Along with the executable, two binary files, inject.bin (malicious function code) and imain.bin (malicious control logic), were deployed as the controller’s payload.		others others others others others others others others others sample_name others others others others others others sample_name others others others others others others others others others others others others others others others
These file names were hard coded in the Py2EXE compiled python script.		others others others others others others others others others others others others others
Trilog.exe took one option from the command line, which was a single IP address of the target Triconex device.		sample_name others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
It did not leverage the underlying TRITON library’s capability for Triconex device discovery, instead an instance of trilog.exe had to be invoked separately for each target controller in the environment.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Once invoked, trilog.exe checked the status of the controller, then read the configuration information exposed by the TriStation protocol.		others others others sample_name sample_function sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function sample_function others others protocol others others
If the controller was in a running state, trilog.exe encoded the two payload files inject.bin and imain.bin and passed them to the communication libraries to be appended to the controller’s program memory and execution table.		others others others others others others others others others sample_name others others others others others sample_name others sample_name others others others others others others others others others others others others others others others others others others others others others
After payload files were inserted into memory on the Triconex controller, the script initiated a countdown, periodically checking the status of the controller.		others others others others others others others others others company others others others others others others others others others others others others others others others others
If an error was detected, the communication library’s method SafeAppendProgramMod attempted to reset the controller to the previous state using a TriStation protocol command.		others others others others others others others others others others others others function others others sample_function sample_function sample_function others others others others others others protocol others others others
If this failed, trilog.exe attempted to write a small ‘dummy’ program to memory.		others others others others sample_name others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others
We assess that this was an anti-forensics technique to hide the presence of the attacker code on the Triconex controller.		others others others others others others others others others others others others others others others others others others others others others
Working with the asset owner, Mandiant ran trilog.exe in a lab environment with a valid Triconex controller and discovered a conditional check in the malware that prevented the payload binary from persisting in the environment.		others others others others others others security_team others sample_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Mandiant confirmed that, after correcting patching the attack script to remove this check, the payload binary would persist in controller memory, and the controller would continue to run.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
TRITON implements the TriStation protocol, which is the protocol used by the legitimate TriStation application, to configure controllers.		malware others others protocol others others others others others others others others others others others others others others others others others
TsHi is the high-level interface created by the malware’s authors that allows the threat actor’s operators to implement attack scripts using the TRITON framework.		sample_name others others others others others others others others others others others others others others others others others others others others others others others others others malware others others
It exposes functions for both reconnaissance and attack.		others others others others others sample_function others sample_function others
The functions generally accept binary data from the user, and handle the code ‘signing’ and check sums prior to passing the data to lower level libraries for serialization on to the network.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
TsBase, another attacker-written module, contains the functions called by TsHi, which translate the attacker’s intended action to the appropriate TriStation protocol function code.		sample_name others others others others others others others others sample_function sample_function sample_function others others others others others others others others others others others others protocol others others others others
For certain functions, it also packs and pads the data in to the appropriate format.		others others others others others others others others others others others others others others others others others
TsLow is an additional attacker module that implements the TriStation UDP wire protocol.		sample_name others others others others others others others others protocol protocol protocol protocol others
The TsBase library primarily depends on the ts_exec method.		others sample_name others others others others others others others others
This method takes the function code and expected response code, and serializes the commands payload over UDP.		others others others others others others others others others others others others others others others others others protocol others
It checks the response from the controller against the expected value and returns a result data structure indicating success or a False object representing failure.		others others others others others others others others others others others others others others others others others others others others others others others others others others
TsLow also exposes the connect method used to check connectivity to the target controller.		sample_name others others others sample_function sample_function others others others others others others others others others
If invoked with no targets, it runs the device discovery function detect_ip.		others others others others others others others others others others others others others others
This leverages a "ping" message over the TriStation protocol using IP broadcast to find controllers that are reachable via a router from where the script is invoked.		others others others others others others others others others protocol others others others others others others others others others others others others others others others others others others others others
TRITON: trilog.exe, 6c39c3f4a08d3d78f2eb973a94bd7718, e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230.		malware others sample_name others md5 others sha2 others
TRITON: imain.bin, 437f135ba179959a580412e564d3107f, 08c34c6ac9186b61d9f29a77ef5e618067e0bc9fe85cab1ad25dc6049c376949.		malware others sample_name others md5 others sha2 others
TRITON: inject.bin, 0544d425c7555dc4e9d76b571f31f500, 5fc4b0076eac7aa7815302b0c3158076e3569086c4c6aa2f71cd258238440d14.		malware others sample_name others md5 others sha2 others
TRITON: library.zip, 0face841f7b2953e7c29c064d6886523, bef59b9a3e00a14956e0cd4a1f3e7524448cbe5d3cc1295d95a15b83a3579c59.		malware others sample_name others md5 others sha2 others
TRITON: TS_cnames.pyc, e98f4f3505f05bf90e17554fbc97bba9, 2c1d3d0a9c6f76726994b88589219cb8d9c39dd9924bc8d2d02bf41d955fe326.		malware others sample_name others md5 others sha2 others
TRITON: TsBase.pyc, 288166952f934146be172f6353e9a1f5, 1a2ab4df156ccd685f795baee7df49f8e701f271d3e5676b507112e30ce03c42.		malware others sample_name others md5 others sha2 others
TRITON: TsHi.pyc, 27c69aa39024d21ea109cc9c9d944a04, 758598370c3b84c6fbb452e3d7119f700f970ed566171e879d3cb41102154272.		malware others sample_name others md5 others sha2 others
TRITON: TsLow.pyc, f6b3a73c8c87506acda430671360ce15, 5c776a33568f4c16fee7140c249c0d2b1e0798a96c7a01bfd2d5684e58c9bb32.		malware others sample_name others md5 others sha2 others
TRITON: sh.pyc, 8b675db417cc8b23f4c43f3de5c83438, c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1.		malware others sample_name others md5 others sha2 others