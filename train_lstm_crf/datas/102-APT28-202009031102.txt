APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?		threatActor_name others others others others location others others others others others others
Release_Time: unknow .		others others others others
Report_URL: https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf .		others others others others others others
In April 2013 , based on compile time , the group began to make significant alterations to the SOURFACE downloader .		time time time others others others others others others others others others others others others others others others malware others others
Variants of the SOURFACE second stage backdoor , EVILTOSS , share some code similarities with SOURFACE .		others others others malware others others malware others malware others others others others others others malware others
However , it contains more capabilities , including the ability to provide access to the file system and registry , enumerate network resources , create processes , log keystrokes , access stored credentials , and execute shellcode .		others others reference_word others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others sample_function sample_function sample_function others sample_function sample_function others sample_function sample_function others sample_function sample_function sample_function others others sample_function sample_function others
The backdoor encrypts data that it uploads with an RSA public key .		others malware others others others others others others others encryption_algo others others others
Many of its variants we have seen are named netui.dll .		others others others others others others others others others sample_name others
EVILTOSS variants may use the Simple Mail Transfer Protocol ( SMTP ) to send stolen data in an attachment named “ detaluri .		malware others others others others protocol protocol protocol protocol others protocol others others others others others others others others others others others others
dat ” .		others others others
The backdoor attaches this file to a preformatted email and sends it out through a victim ’s mail server .		others malware others others others others others others others others others others others others others others others others others others others
Interestingly , we found an antivirus report from 2004 detailing what appears to be an early variant of EVILTOSS .		others others others others others others others others time others others others others others others others others others malware others
The backdoor was installed alongside the NATO-themed decoy document depicted in Figure 8 .		others malware others others others others others others others others others others others others
The backdoor sent data via SMTP to nato_smtp@mail[ .		others malware others others others protocol others others others others others others
]ru and received its tasking via POP from nato_pop@mail[.		others others others others others others others protocol others others others others others others
]ru .		others others others
Although we have not conclusively attributed this sample to APT28 , it does suggest the possibility that APT28 has been operating since as early as 2004 .		others others others others others others others others others threatActor_name others others others others others others others threatActor_name others others others others others others others time others
MODULAR IMPLANTS INDICATE A FORMAL DEVELOPMENT ENVIRONMENT .		others others others others others others others others
A modular development framework suggests the group has had an organized development effort since as early as 2007 .		others others others others others others others others others others others others others others others others others time others
During our research , we discovered that APT28 uses a backdoor developed using a modular framework .		others others others others others others others threatActor_name others others malware others others others others others others
We call this backdoor CHOPSTICK , a somewhat ironic name that comes from our semi-random name generator .		others others others malware malware others others others others others others others others others others others others others
The modular design allows flexible options for compiling variants with different capabilities as needed , as well as deploying additional capabilities at runtime .		others others others others others others others others others others others others others others others others others others others others others others others others
This allows the developers to make targeted implants , including only the capabilities and protocols necessary for a specific environment .		others others others others others others others others others others others others others others others others others others others others others
Such a modular framework suggests the group has had an organized development effort since as early as 2007 .		others others others others others others others others others others others others others others others others others time others
A formal development environment , in which code is versioned and well-organized , would almost certainly be required to track and define the various modules that can be included in the backdoor at compile time .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others others others others
CHOPSTICK variants may move messages and information using at least three methods :  Communications with a C2 server using HTTP .		malware others others others others others others others others others others others others others others others tool others others protocol others
These protocols are covered in more detail in Appendix D.  Email sent through a specified mail server .		others others others others others others others others others others others others others others others others others others
One CHOPSTICK v1 variant contained modules and functions for collecting keystroke logs , Microsoft Office documents , and PGP files .		others malware others others others others others others others sample_function sample_function sample_function others tool tool others others others sub_activity sub_activity others
The monitoring for new files of interest is performed by a “ Directory Observer ” module .		others others others others others others others others others others others others others others others others others
In one sample this information was intended to be sent via SMTP using a Georgian MIA mail server .		others others others others others others others others others others others protocol others others location others others others others
It used one of four embedded sender email addresses ( @mia.gov.ge ) to send files via email to another email address on the same mail server .		others others others others others others others others others others email_evil email_evil others others others others others others others others others others others others others others others others
All information required for the email was hardcoded in the backdoor .		others others others others others others others others others others malware others
Local copying to defeat closed networks .		others others others others others others others
One variant of CHOPSTICK focuses on apparent air gap / closed network capabilities by routing messages between local directories , the registry and USB drives .		others others others malware others others others others others others others others others others others others others sub_activity sub_activity others sub_activity sub_activity others sub_activity sub_activity others
APT28 MALWARE INDICATES RUSSIAN SPEAKERS IN A RUSSIAN TIME ZONE .		threatActor_name others others location others others others others others others others
During our research into APT28 ’s malware , we noted two details consistent across malware samples .		others others others others threatActor_name others others others others others others others others others others others others others
The first was that APT28 had consistently compiled Russian language settings into their malware .		others others others others threatActor_name others others others location others others others others others others
The second was that malware compile times from 2007 to 2014 corresponded to normal business hours in the UTC + 4 time zone , which includes major Russian cities such as Moscow and St. Petersburg .		others others others others others others others others time others time others others others others others others others others others others others others others others others others location others others others location others others others others
Use of Russian and English Language Settings in PE Resources .		others others others others others others others others tool others others
PE resources include language information that  can be helpful if a developer wants to show user  interface items in a specific language .		tool others others others others others others others others others others others others others others others others others others others others others others
Non-default language settings packaged with PE resources are dependent on the developer ’s build environment .		others others others others others tool others others others others others others others others others others others
Each PE resource includes a “ locale ” identifier with a language ID “ composed of a primary language identifier indicating the language and a sublanguage identifier indicating the country/region.		others tool others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
”  At the time of the writing of this paper , we had identified 103 malware samples that were both attributed to APT28 and contained PE resources .		others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others tool others others
Table 5 shows the locale identifiers with associated language and country/region for these samples .		others others others others others others others others others others others others others others others
Table 5: Locale and language identifiers associated with APT28 malware 0x0419: Russian ( ru ) , Russia ( RU ) , 59 .		others others others others others others others others others threatActor_name others others others others others others others others location others location others others others others
0x0409: English ( en ) , United States ( US ),27 .		others others others others others others others location location others location others others others
0x0000 or 0x0800: Neutral locale / System default locale language , Neutral , 16 .		others others others others others others others others others others others others others others others others
0x0809: English ( en ) , United Kingdom ( GB ) , 1 .		others others others others others others others location location others location others others others others
The samples with Russian language settings were compiled between late 2007 and late 2013 , as depicted in Figure 9 .		others others others others others others others others others others time others others time others others others others others others others
This consistency over a long timeframe suggests that the developers of APT28 malware were using a build environment with Russian language settings at least some of the time and made no effort to obscure this detail .		others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others
Overall , the locale IDs suggest that APT28 developers can operate in both Russian and English .		others others others others others others others threatActor_name others others others others others others others others others
Compile Times Align with Working Hours in Moscow and St. Petersburg .		others others others others others others others location others others others others
Of the 140 malware samples that we have attributed to APT28 so far , over 89% were compiled between 0400 and 1400 UTC time , as depicted in Figure 10 .		others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others
Over 96% were compiled between Monday and Friday .		others others others others others others others others others others
This parallels the working hours in UTC+0400 ( that is , compile times begin about 8AM and end about 6PM in this time zone ) .		others others others others others others others others others others others others others others others others others others others others others others others others others others
This time zone includes major Russian cities such as Moscow and St. Petersburg .		others others others others others location others others others location others others others others
We started researching APT28 based on activity we observed on our clients ’ networks , similar to other targeted threat groups we have identified over time .		others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others
We assess that APT28 is most likely sponsored by the Russian government .		others others others threatActor_name others others others others others others location others others
We summarize our key observations about APT28 in Figure 11 below .		others others others others others others threatActor_name others others others others others
APT28 ’s characteristics-their targeting , malware , language , and working hours-have led us to conclude that we are tracking a focused , longstanding espionage effort .		threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others
Given the available data , we assess that APT28 ’s work is sponsored by the Russian government .		others others others others others others others others threatActor_name others others others others others others others others others others
Evolves and Maintains Tools for Continued , Long-Term Use :  Uses malware with flexible and lasting platforms .		others others others others others others others others others others others others others others others others others others
Constantly evolves malware samples for continued use .		others others others others others others others others
Malware is tailored to specific victims ’ environments , and is designed to hamper reverse engineering efforts .		others others others others others others others others others others others others others others others others others others
Development in a formal code development environment .		others others others others others others others others
Various Data Theft Techniques :   Backdoors using HTTP protocol .		others others others others others malware others protocol others others
Backdoors using victim mail server .		malware others others others others others
Local copying to defeat closed/air gapped networks .		others others others others others others others others
Georgia and the Caucasus :  Ministry of Internal Affairs .		location others others location others government government government government others
Ministry of Defense .		government government government others
Journalist writing on Caucasus issues .		others others others others others others
Kavkaz Center .		company company others
Eastern European Governments & Militaries :  Polish Government .		location location others others others others location others others
Hungarian Government .		location others others
Ministry of Foreign Affairs in Eastern Europe .		government government government government others location location others
Baltic Host exercises .		government government others others
Security-related Organizations :  NATO .		others others others security_team others
OSCE .		security_team others
Defense attaches .		person person others
Defense events and exhibitions .		sub_activity sub_activity sub_activity sub_activity others
Russian Language Indicators : 	 Consistent use of Russian language in malware over a period of six years .		others others others others others others others others others others others others others others others others others others
Lure to journalist writing on Caucasus issues suggests APT28 understands both Russian and English .		others others others others others others others others threatActor_name others others others others others others
Malware Compile Times Correspond to Work Day in Moscow ’s Time Zone ：  Consistent among APT28 samples with compile times from 2007 to 2014 .		others others others others others others others others location others others others others others others others threatActor_name others others others others others time others time others
The compile times align with the standard workday in the UTC + 4 time zone which includes major Russian cities such as Moscow and St. Petersburg .		others others others others others others others others others others others others others others others others others others location others others others others others others others others
APPENDIX A : DISTINGUISHING THREAT GROUPS .		others others others others others others others
We use the term “ threat group ” to refer to actors who work together to target and penetrate networks of interest .		others others others others others others others others others others others person others others others others others others others others others others others
These individuals may share the same set of tasks , coordinate targets , and share tools and methodology .		reference_word others others others others others others others others others others others others others others others others others others
They work together to gain access to their targets and steal data .		reference_word others others others others others others others others others others others others
The art of attributing disparate intrusion activities to the same threat group is not always simple .		others others others others others others others others others others others others others others others others others
Different groups may use similar intrusion methodologies and common tools , particularly those that are widely available on the Internet , such as pwdump , HTran , or Gh0st RAT .		others others others others others others others others others others others others others others others others others others others others others others others tool others tool others others tool tool others
There may be overlaps between groups caused by the sharing of malware or exploits they have authored , or even the sharing of personnel .		others others others others others others others others others others others others others others others others others others others others others others others others others
Individual threat actors may move between groups either temporarily or permanently .		others others person others others others others others others others others others
A threat actor may also be a private citizen who is hired by multiple groups .		others others person others others others others others others others others others others others others others
Multiple groups , on occasion , compromise the same target within the same timeframe .		others others others others others others others others others others others others others others others
Distinguishing one threat group from another is possible with enough information , analytical experience , and tools to piece it all together .		others others others others others others others others others others others others others others others others others others others others others others others
We can analyze multiple incidents and tell by the evidence left behind that a given incident was the result of one threat group and not another .		others others others others others others others others others others others others others others others others others others others others others others others others others others others
Threat actors leave behind various forensic details .		others person others others others others others others
They may send spear phishing emails from a specific IP address or email address .		reference_word others others attack_activity attack_activity others others others others others others others others others others
Their emails may contain certain patterns ; files have specific names , MD5 hashes , timestamps , custom functions , and encryption algorithms .		reference_word others others others others others others others others others others others others others others others others others others others others others others others
Their backdoors may have command and control IP addresses or domain names embedded .		reference_word malware others others others others others others others others others others others others
These are just a few examples of the myriad of forensic details that we consider when distinguishing one threat group from another .		others others others others others others others others others others others others others others others others others others others others others others others
At the most basic level , we say that two intrusion events are attributed to the same group when we have collected enough indicators to show beyond a reasonable doubt that the same actor or group of actors were involved .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others person others others others person others others others
We track all of the indicators and significant linkages associated with identified threat groups in a proprietary database that comprises millions of nodes and linkages between them .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
In this way , we can always go back and answer “ why ” we associated cyber threat activity with a particular group .		others others others others others others others others others others others others others others others others others others others others others others others others
APPENDIX B : TIMELINE OF APT28 LURES .		others others others others others others others others
2010 Iran ’s work with an international organization ( internal document ) SOURFACE .		time location others others others others others others others others others others others malware others
2011 File named “ military cooperation.doc ” SOURFACE , OLDBAIT .		time others others others sample_name sample_name others malware others malware others
2011 Georgian language IT document for Ministry of Internal Affairs ( internal document ) SOURFACE .		time others others others others others others others government government others others others others malware others
2011 “ USB Disk Security is the best software to block threats that can damage your PC or compromise your personal information via USB storage.		time others tool tool tool others others others others others others others others others others others others others others others others others others others others others
” SOURFACE .		others malware others
2012 Food security in Africa ( “ Food and nutrition crisis reaches peak but good forecast for 2013 ” ) SOURFACE .		time others others others location others others others others others others others others others others others others time others others malware others
2012 “ IDF Soldier Killed and another injured in a Terror Attack ” SOURFACE .		time others government others others others others others others others others others others malware others
2012 “ Echo Crisis Report ” on Portugal ’s forest fires SOURFACE .		time others others others others others others location others others others others malware others
2012 “ FBI to monitor Facebook , Twitter , Myspace ” SOURFACE .		time others government others others company others company others company others malware others
2012 Georgia ( US state , not the country of Georgia ) murder case uncovers terror plot SOURFACE .		time location others location location others others others others others location others others others others others others malware others
2012 Military attaches in London ( internal document ) SOURFACE .		time others others others location others others others others malware others
2013 South Africa MFA document CHOPSTICK , CORESHELL .		time location location encryption_algo others malware others malware others
2013 John Shalikashvili ( Georgian-Polish-American US General ) Questionnaire CORESHELL .		time others others others location location others others others malware others
2013 Asia Pacific Economic Cooperation Summit 2013 reporters ( internal document ) SOURFACE .		time location others others others others time others others others others others malware others
2013 Defense Attaches in Turkey ( internal document ) CHOPSTICK , CORESHELL .		time others others others location others others others others malware others malware others
2013 Turkish Cypriot news about Syria chemical weapons CHOPSTICK , CORESHELL .		time person person others others location others others malware others malware others
2013 Georgian language document about drivers ’ licenses ( internal document ) EVILTOSS .		time others others others others others others others others others others others malware others
2013 Apparent Reason Magazine-related lure sent to a journalist CORESHELL .		time company company others others others others others others malware others
2014 Mandarin language document , possibly related to a Chinese aviation group ( non-public document ) CORESHELL .		time others others others others others others others others government government government others others others others malware others
2014 Netherlands-Malaysia cessation of hostilities ; related to Ukraine airline attack CORESHELL .		time others others others others others others others government government others malware others