6 New Vulnerabilities Found on D-Link Home Routers .		others others others others others company others others others
Release_Time :  2020-06-12  .		others others others others
Report_URL :  https://unit42.paloaltonetworks.com/6-new-d-link-vulnerabilities-found-on-home-routers/  .		others others others others others others
On February 28 , 2020 , Palo Alto Networks ’ Unit 42 researchers discovered six new vulnerabilities in D-Link wireless cloud routers running their latest firmware .		others time time time time others security_team security_team security_team security_team security_team security_team others others others others others others company others others others others others others others others
The vulnerabilities were found in the DIR-865L model of D-Link routers , which is meant for home network use .		others others others others others others others others others company others others others others others others others others others others
The current trend towards working from home increases the likelihood of malicious attacks against home networks , which makes it even more imperative to keeping our networking devices updated .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
It is possible that some of these vulnerabilities are also present in newer models of the router because they share a similar codebase .		others others others others others others others others others others others others others others others others others others others others others others others others
The following are the six vulnerabilities found :  CVE-2020-13782: Improper Neutralization of Special Elements Used in a Command ( Command Injection ) .		others others others others others others others others vulnerability_cve others others others others others others others others others others others attack_activity attack_activity others others
CVE-2020-13786: Cross-Site Request Forgery ( CSRF ) .		vulnerability_cve others attack_activity attack_activity attack_activity others attack_activity others others
CVE-2020-13785: Inadequate Encryption Strength .		vulnerability_cve others others others others others
CVE-2020-13784: Predictable seed in pseudo-random number generator .		vulnerability_cve others others others others others others others others
CVE-2020-13783: Cleartext storage of sensitive information .		vulnerability_cve others others others others others others others
CVE-2020-13787: Cleartext transmission of sensitive information .		vulnerability_cve others others others others others others others
Different combinations of these vulnerabilities can lead to significant risks .		others others others others others others others others others others others
For example , malicious users can sniff network traffic to steal session cookies .		others others others person person others others others others others others others tool others
With this information , they can access the administrative portal for file sharing , giving them the ability to upload arbitrary malicious files , download sensitive files , or delete essential files .		others others others others reference_word others others others others others others attack_goal attack_goal others others others others others others attack_goal attack_goal attack_goal attack_goal others attack_goal attack_goal attack_goal others others attack_goal attack_goal attack_goal others
They can also use the cookie to run arbitrary commands to conduct a denial of service attack .		reference_word others others others others tool others others others others others others others attack_activity attack_activity attack_activity attack_activity others
The Palo Alto Networks Next-Generation Firewalls with threat prevention are protected from this threat with custom signatures .		others security_team security_team security_team others tool others others others others others others others others others others others others
The web interface for this router is controlled by the backend engine called cgibin.exe .		others others others others others others others others others others others others others sample_name others
Most requests for web pages are sent to this controller .		others others others others others others others others others others others
If a request for scandir.sgi is made , a malicious actor can inject arbitrary code to be executed on the router with administrative privileges .		others others others others sample_name others others others others others others others others others others others others others others others others others others others others
This attack requires authentication , but it can be conducted by stealing an active session cookie because the web page is vulnerable to cross site request forgery as well .		others others others others others others others others others others others others others others others tool others others others others others others others others others others others others others others
As will be seen with later vulnerabilities , stealing a session cookie is trivial for an attacker .		others others others others others others others others others others others tool others others others others person others
There are multiple pages on the router ’s web interface that are vulnerable to CSRF .		others others others others others others others others others others others others others others others attack_activity others
This means that an attacker can sniff web traffic and use the session information to gain access to password-protected portions of the website without knowing the password .		others others others others person others others others others others others others tool tool others attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others others others others
The previous vulnerability already mentioned that the command injection can be conducted using CSRF .		others others others others others others others attack_activity attack_activity others others others others attack_activity others
There is also a SharePort Web Access portal , which is an administrative web site for file sharing located on port 8181 .		others others others others others others others others others others others others others others others others others others others others others others others
If the attacker were to navigate directly to the folder_view.php page , they can bypass the login screen but would have no functionality .		others others others others others others others others others sample_name others others others others others others others others others others others others others others
If they were to simply change the value of the cookie to be the uid of the valid session , they would completely bypass authentication .		others others others others others others others others others others others others others others others others others others others others others others others others others others
The attacker now has the ability to do three different things :  View the contents of all files .		others others others others others others others others others others others others others others others others others others others
Delete any or all files .		others others others others others others
Upload new files , including malware .		others others others others others malware others
When a user logs into the SharePort Web Access portal on port 8181 , there is enough information sent in clear text for a listening attacker to determine a user ’s password through a brute force attack .		others others others others others others others others others others others others others others others others others others others others others others others others others person others others others others others others others others others attack_activity attack_activity attack_activity others
The above information is sent to the client from the router .		others others others others others others others others others others others others
The client will then calculate the password to send as follows : MD5 HMAC of string equal to username + challenge with the actual password as the key .		others others others others others others others others others others others others encryption_algo encryption_algo others others others others others others others others others others others others others others others
By sniffing this handshake , the attacker now has access to the following information :  The data input for the MD5 HMAC algorithm = id + challenge The result of the hashing algorithm = password .		others others others others others others others others others others others others others others others others others others others others encryption_algo encryption_algo others others others others others others others others others encryption_algo encryption_algo others others others
With this information , the attacker can determine the actual password by conducting a brute force attack completely offline .		others others others others others person others attack_goal attack_goal attack_goal attack_goal others others others attack_activity attack_activity attack_activity others others others
There is an algorithm in the router ’s code-base that calculates the session cookie randomly , but the result is predictable .		others others others others others others others others others others others others others others tool others others others others others others others others
An attacker only needs to know the approximate time that a user logged on to determine the session cookie , even if it is protected with encryption .		others person others others others others others others others others others others others others others attack_goal attack_goal attack_goal attack_goal others others others others others others others others others
Every time a user logs on , the router responds with a cookie , challenge , and public key .		others others others others others others others others others others others others tool others others others others others others others
This information seems random , but it is created by a function called get_random_string .		others others others others others others others others others others others others others sample_function others
This function will seed the random number generated with the time of the login attempt .		others others others others others others others others others others others others others others others others
Thus , the result of the calculation can be predicted by an attacker who knows the time of the request .		others others others others others others others others others others others others others others others others others others others others others
The result of this vulnerability is that even if the router is using HTTPS to encrypt session information , a sophisticated attacker can still determine the information necessary to conduct the CSRF attacks .		others others others others others others others others others others others others others protocol others others others others others others others person others others others others others others others others others attack_activity attack_activity others
The tools_admin.php page stores the admin password in clear text .		others sample_name others others others others others others others others others
In order for an attacker to get the password , they would require physical access to a machine that is logged on .		others others others others others others others others others others others others others others others others others others others others others others others
Physical access is necessary because the credentials are not sent in clear text over the wire .		others others others others others others others others others others others others others others others others others
With physical access , they can see the password by viewing the HTML source of the page .		others others others others others others others others others others others others program_language others others others others others
The adv_gzone.php page is used to set up a guest wifi network .		others sample_name others others others others others others others others others others others
There are multiple options available for the security on this network .		others others others others others others others others others others others others
One option is Wired Equivalent Privacy ( WEP ) , which was deprecated in 2004 , and not recommended to secure a wireless network .		others others others protocol protocol protocol others protocol others others others others others others time others others others others others others others others others others
If the administrator chooses this option , the password will be sent over the network in clear text .		others others others others others others others others others others others others others others others others others others others
Malicious users sniffing network traffic can see the password used for the guest network .		others others others others others others others others others others others others others others others
In summary , the D-Link DIR-865L home wireless router has multiple vulnerabilities .		others others others others company others others others others others others others others
Due to the number of people working from home , malicious actors have an incentive to attack routers meant for home networks .		others others others others others others others others others others others others others others others others others others others others others others others
These vulnerabilities can be used together to run arbitrary commands , exfiltrate data , upload malware , delete data or steal user credentials .		reference_word reference_word others others others others others attack_goal attack_goal attack_goal others attack_goal attack_goal others attack_goal attack_goal others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
These attacks are easiest to conduct if the router is set up to use HTTP , but a sophisticated attacker can still calculate the required session information if the router uses HTTPS .		others others others others others others others others others others others others others others protocol others others others others others others others others others others others others others others others others protocol others
Palo Alto Networks protects customers in the following ways :  Next-Generation Firewalls with threat prevention license can block the attacks with best practice via threat prevention signature 58410 .		security_team security_team security_team others others others others others others others others tool others tool tool tool others others others others others others others others others others others others others
Install the latest version of the firmware with patches .		others others others others others others others others others others
The firmware can be found on the D-Link website where they announced the vulnerabilities : D-Link Announcement .		others others others others others others others company others others others others others others others others others others
Default all traffic to HTTPS to defend against session hijacking attacks .		others others others others protocol others others others others attack_activity attack_activity others
Change the time zone on the router to defend against malicious actors who are calculating the randomly generated session id .		others others others others others others others others others others others others others others others others others others others others others
You can find how to do that on D-Link ’s site .		others others others others others others others others others others others others others
Do not use this router to share sensitive information until it ’s patched .		others others others others others others others others others others others others others others others
CVE-2020-13782 Improper Neutralization of Special Elements Used in a Command ( Command Injection ) https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13782 .		vulnerability_cve attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity others attack_activity attack_activity others url url url url url others
CVE-2020-13783 Cleartext storage of sensitive information https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13783 .		vulnerability_cve others others others others others url url url url url others
CVE-2020-13784 Predictable seed in pseudo-random number generator https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13784 .		vulnerability_cve others others others others others others url url url url url others
CVE-2020-13785 Inadequate Encryption Strength https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13785 .		vulnerability_cve others others others url url url url url others
CVE-2020-13786 Cross-Site Request Forgery https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13786 .		vulnerability_cve attack_activity attack_activity attack_activity url url url url url others
CVE-2020-13787 Cleartext transmission of sensitive information https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13787 .		vulnerability_cve others others others others others url url url url url others