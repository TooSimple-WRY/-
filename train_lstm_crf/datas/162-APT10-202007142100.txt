ChessMaster Makes its Move: A Look into the Campaign’s Cyberespionage Arsenal Release_Time :  2017-07-27 .		attack_activity others others others others others others others others others others others others others others others others others
Report_URL :  https://blog.trendmicro.com/trendlabs-security-intelligence/chessmaster-cyber-espionage-campaign/ .		others others others others others others
From gathering intelligence , using the right social engineering lures , and exploiting vulnerabilities to laterally moving within the network , targeted attacks have multifarious tools at their disposal .		others sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others
And like in a game of chess , they are the set pieces that make up their modus operandi .		others others others others others others others others others others others others others others others others others others others others
Take for instance the self-named ChessMaster , a campaign targeting Japanese academe , technology enterprises , media outfits , managed service providers , and government agencies .		others others others others others attack_activity others others others others industry industry others target_crowd target_crowd others target_crowd target_crowd others target_crowd target_crowd target_crowd others others target_crowd target_crowd others
It employs various poisoned pawns in the form of malware-laden spear-phishing emails containing decoy documents .		reference_word others others others others others others others others others attack_activity tool others others others others
And beyond ChessMaster ’s endgame and pawns , we also found red flags that allude to its links to APT 10 , also known as menuPass , POTASSIUM , Stone Panda , Red Apollo , and CVNX .		others others attack_activity others others others others others others others others others others others others others others others others others threatActor_name threatActor_name others others others others threatActor_aliases others threatActor_aliases others threatActor_aliases threatActor_aliases others threatActor_aliases threatActor_aliases others others threatActor_aliases others
ChessMaster ’s name is from pieces of chess/checkers/draughts we found in the resource section of the main backdoor they use against their targets : ChChes , which Trend Micro detects as BKDR_CHCHES .		attack_activity others others others others others others others others others others others others others others others others others others others others others others others others malware others others security_team security_team others others string others
What makes the campaign unique is its arsenal of tools and techniques :  Malicious shortcut ( LNK ) files and PowerShell .		others others reference_word reference_word others others others others others others others others others tool tool sub_activity sub_activity sub_activity sub_activity others tool others
The LNK files execute Command Prompt that downloads a PowerShell script , which would either directly drop or reflectively load ChChes into the machine .		reference_word tool reference_word others tool tool others sub_activity sub_activity tool sub_activity others others others others others sub_activity sub_activity sub_activity sub_activity malware sub_activity sub_activity sub_activity others
The latter method makes ChChes a fileless malware .		others others others others malware others others others others
Self-extracting archive ( SFX ) .		sub_activity sub_activity others tool others others
An archive that drops an executable ( EXE ) , a dynamic-link library ( DLL ) , and a binary file ( .BIN ) .		others sub_activity sub_activity sub_activity sub_activity sub_activity others tool others others others tool tool others tool others others others others sub_activity sub_activity others sample_name others others
Upon their extraction , malicious code is injected into the process of a legitimate file/application ( DLL hijacking ) .		others others others others sub_activity sub_activity others others others others others others others others others others tool attack_activity others others
ChessMaster takes it up a notch via load-time dynamic linking to trigger the malicious DLL ’s function .		attack_activity others others others others others others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity tool sub_activity sub_activity sub_activity others
Runtime packers .		sub_activity sub_activity others
Throughout its campaign , ChChes used three packers to obfuscate itself and avoid detection .		others others others others malware others others others others attack_goal attack_goal others attack_goal attack_goal others
The first had no encryption and a varied loader code .		others others others others others others others others sub_activity sub_activity others
The second had a buggy ( or anti-emulation ) exclusive OR ( XOR ) encryption technique .		others others others others others others others others others others encryption_algo others encryption_algo others others others others
The third added an AES algorithm on top of XOR encryption .		others others others others encryption_algo others others others others encryption_algo others others
Their compile dates overlap , which indicates ChChes ’ authors take cues and fine-tune their malware .		others others others others others others others malware others others others others others others others others others
Second-stage payloads .		sub_activity sub_activity others
Additional malware are introduced to the infected system for persistence .		others others others others others others sub_activity sub_activity others others others
These are actually variants of ChChes that use similar entry points but different and encrypted C&C communication .		others others others others others malware others others others others others others others others others tool tool tool others others
Hacking Tools .		sub_activity sub_activity others
ChessMaster draws on legitimate email and browser password recovery and dumping tools they ’ve misused and modified for their campaign .		attack_activity others others others tool others sub_activity sub_activity sub_activity others sub_activity sub_activity others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
These can restore forgotten passwords , which are then dumped and retrieved .		others others sub_activity sub_activity sub_activity others others others others others others others others
Lateral movement and further attacks can be worked out from here .		others others others others others others others others others others others others
TinyX .		malware others
A version of PlugX sans the plug-in functionality that allows it to adopt new capabilities .		others others others malware others others others others others others others others others others others others
TinyX is bundled separately in spear-phishing emails .		malware others others others others attack_activity tool others
RedLeaves .		malware others
A second-stage backdoor that operates like the open-source and fileless remote access Trojan ( RAT ) Trochilus , which is known for enabling lateral movement in the infected systems .		others sub_activity sub_activity others others others others others others others others others malware others malware others malware others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
RedLeaves adopted capabilities from PlugX .		malware others others others malware others
In April , a RedLeaves variant named himawari ( Japanese for sunflower ) emerged capable of evading YARA rules released during that time .		others tool others others malware others others string others others others others others others others others sub_activity tool sub_activity others others others others others
APT 10/menuPass is a cyberespionage group whose specific campaign , Operation Cloud Hopper , attacked the intermediaries of their targets of interest—managed service providers ( MSPs ) .		threatActor_name others others others others others others others others others attack_activity attack_activity attack_activity others others others target_crowd target_crowd target_crowd target_crowd target_crowd others protocol protocol others protocol others others
Its notoriety stems from their prolific use of multifarious information-stealing backdoors and vulnerability exploits , along with the tenacity of its subterfuges , from spear-phishing emails to attack and infection chains .		others others others others others others others others sub_activity sub_activity malware others sub_activity sub_activity others others others others others others others others others others attack_activity tool others sub_activity sub_activity sub_activity sub_activity others
It also abused legitimate or open-source remote administration tools to steal data .		others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity others
If that sounded familiar , it ’s because ChessMaster and APT 10 appear to be playing the same cyberespionage game .		others others others others others others others others others attack_activity others threatActor_name threatActor_name others others others others others others others others others
We first saw ChChes set its sights on an organization that ’s long been a target of APT 10/menuPass .		others others others malware others others others others others others others others others others others others others others threatActor_name others others
As we caught and delved into more ChChes samples in the wild , however , we also saw how they followed the same pattern—exclusive packers , mutual targets , overlapping C&C infrastructure .		others others others others others others others malware others others others others others others others others others others others others others others others others sub_activity others sub_activity sub_activity others sub_activity tool tool tool sub_activity others
ChChes ’ packer , for instance , resembled the one used in menuPass ’ old PlugX samples .		malware others others others others others others others others others others others threatActor_aliases others others malware others others
DNS records also showed that some of their command and control ( C&C ) servers and domains resolved to the same IP address , or resided in the same subnet .		protocol others others others others others others others tool tool tool others tool tool tool others sub_activity others others others others others others encryption_algo others others others others others others others others others
Are they operated by the same actors?		others others others others others others others others
Their commonalities make it appear so .		others others others others others others others
It ’s also known to happen ; BlackTech ’s cyberespionage campaigns are a case in point .		others others others others others others others others threatActor_aliases others others others others others others others others others others
ChessMaster ’s ChChes also resembles another backdoor , Emdivi , which first made waves in 2014 .		attack_activity others others malware others others others others others malware others others others others others others time others
They have the same endgame .		others others others others others others
Both are second-stage payloads that use the system ’s Security Identifier ( SID ) as encryption key so they execute only in their target ’s machine .		others others sub_activity sub_activity others others others industry others others encryption_algo encryption_algo others encryption_algo others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Their difference lies in complexity—ChChes hides part of the decryption key and payload in registry keys to make it harder to reverse engineer .		others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others attack_activity attack_activity attack_activity attack_activity others
But that ’s just one dot in several we ’ve connected .		others others others others others others others others others others others others others others
In one instance , we detected PlugX and Emdivi on the same machine .		others others others others others others malware others malware others others others others others
This PlugX variant connected to an APT 10/menuPass-owned domain , but the packer is similar to that used by ChChes .		others malware others others others others threatActor_name others others others others others others others others others others others others malware others
While it ’s possible it was hit by two different campaigns , further analysis told a different story .		others others others others others others others others others others others others others others others others others others others others
Both were compiled on the same date , only several hours apart .		others others others others others time time others others time time time others
We detected and acquired the samples the next day , which means both backdoors were delivered to the victim a day after they were compiled .		others others others others others others others others others others others others others malware others others others others target_crowd time time time time time time others
Ultimately attacks like ChessMaster ’s make pawns out of the systems , networks , devices and their users , all of which hold the organization ’s crown jewels .		others others others attack_activity others others others others others others others industry others industry others target_crowd target_crowd target_crowd target_crowd others others others others others others others others others others others others
This is why enterprises need to be steps ahead of the game : prepare , respond , restore , and learn .		others others others industry others others others others others others others others others others others others others others others others others others
Plan ahead—what techniques will attackers use?		others others others others others others others
How can I defend against them?		others others others others others others others
Don’t just pull the plug—understand what happened to better assess and mitigate the damage .		others others others others others others others others others others others others others others others others others
Fine-tune your response—what worked , what didn’t , and what could ’ve been done better?		counter_measure counter_measure others others others others others others others others others others others others others others others others others
Defense in depth plays a crucial role especially for the IT/system administrators and information security professionals that watch over them .		counter_measure counter_measure counter_measure others others others others others others others target_crowd target_crowd others target_crowd target_crowd target_crowd others others others others others
The network , endpoints , servers , mobile devices , and web/email gateways are the bishops , knights , and rooks that underpin the enterprise ’s crown jewels , which is why securing them is important .		others industry others sub_activity others sub_activity others sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Reduce their attack surface .		counter_measure counter_measure counter_measure counter_measure others
Keep the systems updated and regularly patched , and enforce the principle of least privilege .		counter_measure counter_measure industry counter_measure counter_measure counter_measure counter_measure others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others
Employ behavior monitoring and application control .		counter_measure counter_measure counter_measure others counter_measure counter_measure others
Deploy firewalls as well intrusion detection and prevention systems .		counter_measure counter_measure others others counter_measure counter_measure counter_measure counter_measure industry others
Implement URL categorization , network segmentation , and data categorization .		others tool counter_measure others industry counter_measure others others counter_measure counter_measure others
ChessMaster ’s gambit is spear-phishing , so it ’s especially important to filter and safeguard the email gateway .		attack_activity others others others others attack_activity others others others others others others others others counter_measure counter_measure counter_measure counter_measure tool counter_measure others
Additionally , foster a cybersecurity-aware workforce .		others others counter_measure counter_measure counter_measure counter_measure others
Seemingly benign icons or decoy documents can still swindle the victim , for instance .		others others others others sub_activity sub_activity others others others others target_crowd others others others others
More importantly , develop proactive incident response and remediation strategies—threat intelligence helps enterprises prepare and mitigate attacks .		others others others counter_measure counter_measure counter_measure counter_measure counter_measure counter_measure others others others others others others others others others
Like in chess , the more you understand your enemy ’s moves , the more successful you can be at thwarting them .		others others others others others others others others others others others others others others others others others others others others others others others others
The Indicators of Compromise ( IoCs ) related to ChessMaster ’s campaigns is in this appendix .		others others others others others others others others others attack_activity others others others others others others others others
This has been presented in the RSA Conference 2017 Asia Pacific & Japan as “ ChessMaster : A New Campaign Targeting Japan Using the New ChChes Backdoor ” on July 27 , 2017 , in Marina Bay Sands , Singapore .		others others others others others others encryption_algo others time location location others location others others attack_activity others others others others others location others others others malware others others others time time time time others others location location location location location others