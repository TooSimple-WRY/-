Winnti (LEAD/APT17) Evolution - Going Open Source .		threatActor_name others others others others others others others others others
Release_Time : 2017-07-11 .		others others others others
Report_URL : https://401trg.com/winnti-evolution-going-open-source/ .		others others others others others others
11 July 2017 in analysis, winnti, LEAD  Tom "Hollywood" Hegel and Nate "Doomsday" Marx .		time time time others others others threatActor_name others threatActor_aliases person others person others person others person others person others person others
This post was originally published on July 11, 2017, in the offical ProtectWise.com blog .		reference_word reference_word others others others others time time time time others others others others domain others others
We have since moved it to this 401TRG blog and backdated appropriately .		others others others others others others others others others others others others others
Update #1: We have published a new post contining additional Winnti details .		others others others others others others others others others others others others threatActor_name others others
If you would like to automate the intake of these indicators, please see our GitHub Detections repo .		others others others others others others others others others others others others others others others company others others others
Update #2: To better document and share the details of this post with the community, we're going to change form referring to this group as "Winnti" to the more appropriate "LEAD" title .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others threatActor_name others others others others others others threatActor_aliases others others others
Winnti originated in 2009 as a single group but more current intelligence indicates that the original group can now be better defined as the Winnti umbrella, which LEAD and BARIUM are within .		threatActor_name others others time others others others others others others others others others others others others others others others others others others others others threatActor_aliases threatActor_aliases others others threatActor_aliases others threatActor_aliases others others others
ProtectWise recently observed a burst of activity and change of tactics from an advanced actor group commonly referred to as “Winnti”  The purpose of this post is to share details of the group’s recent activity in an effort to assist the public in searching for related activity in their networks and preventing future attacks .		security_team others others others others others others others others others others others others others others others others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
The Winnti group has been active since roughly 2009 .		others threatActor_name threatActor_name others others others others others time others
Significant previous research has been published on the group from a variety of sources, such as Kaspersky, Blue Coat, and TrendMicro .		others others others others others others others others others others others others others others others others others threatActor_name others threatActor_name threatActor_name others others threatActor_name others
As far back as 2009, the group was detected attacking multiple video game studios, including some in South Korea and Japan, likely attempting to steal various in-game currencies and to compromise developers’ certificates and source code .		others others others others time others reference_word reference_word others others others industry industry industry industry others others others others government government others government others others others others others attack_goal attack_goal attack_goal others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
The original Winnti group is now split into LEAD (APT17) and BARIUM.		others others threatActor_name threatActor_name others others others others threatActor_name others threatActor_aliases others others threatActor_name others
This activity is associated with LEAD .		others others others others others threatActor_name others
Theft of digital certificates  Use of stolen certificates to sign malware  Theft of gaming source code and infrastructure details .		others others attack_goal attack_goal others others others attack_goal others others malware others others attack_goal attack_goal attack_goal others attack_goal attack_goal others
Known Toolset: PIVY, Chopper, PlugX, ZxShell, Winnti  Phishing HR/recruiting emails for initial infection vector  CHM email file attachments containing malware  Use of GitHub for C2 communication .		others others others tool others tool others tool others tool others tool tool tool tool others others others others tool tool tool tool others malware others others tool others tool others others
Online video game organizations  Defense Sector  Internet Service Providers  Finance .		attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
Originating Location: China (high confidence)  Potential Aliases: Wicked Panda, APT17, Mana .		others others others location others others others others others others others threatActor_aliases threatActor_aliases others threatActor_aliases others threatActor_aliases others
Within the Winnti campaigns observed by ProtectWise, the use of open source tooling was common .		others others threatActor_name others others others security_team others others others others others others others others others others
Specifically, the group has been utilizing the Browser Exploitation Framework (BeEF) and Metasploit Meterpreter .		others others reference_word reference_word others others others others tool tool tool others others others others tool tool others
The use of open source tools by advanced actor groups has become increasingly common, as discussed by our colleagues in the industry .		others others others tool tool tool others others others others others others others others others others others others others others others others others others
To the best of our knowledge this is a new technique for the Winnti group and we expect it to be used in future attacks .		others others others others others others others others others others others others others threatActor_name threatActor_name others others others others others others others others others others others
Also noteworthy are attempts to deliver JAR files containing macOS applications which have meterpreter functionality .		others others others others others others tool tool others tool tool others others others others others
In addition, victims running Windows were delivered MSI files which were built using a free EXE to MSI converter (http://www.exetomsi.com/) .		others others others others others tool others others tool tool others others others others tool tool tool others tool others others domain domain domain others others
Delivery :  The Winnti campaign detailed in this post began with spear phishing emails aimed at a Japanese gaming studio’s staff .		others others others threatActor_name others others others others others others others attack_activity attack_activity attack_activity others others others location target_crowd target_crowd target_crowd target_crowd target_crowd others
At least one of these emails claimed it was from an applicant for a job posting who was listing their relevant experience, along with a link to their resume .		others others others others others attack_activity others others others others others others others others others others others others others others others others others others others others others others others others others
The approximate translation of the Winnti phishing email is as follows : “I saw your job posting.		others others others others others threatActor_name attack_activity attack_activity others others others others others others others others others others others
My main languages are Object-C, JAVA, and Swift, and I have 7 years experience with Ruby and 6 years experience with PHP .		others others others others program_language others program_language others others program_language others others others others others others others others program_language others others others others others program_language others
I have 5 years experience developing iOS apps, as well as Android apps, AWS, Jenkins, Microsoft Azure, ZendFramework, and smartphone application payment processing .		others others others others others others OS_name others others others others others OS_name others others OS_name others OS_name others OS_name OS_name others OS_name others others others others others others others
I also have 5 years experience with MSSQL, Mysql, Oracle, and PostgreSQL .		others others others others others others others tool others tool others tool others others tool others
Please see here: ” We observed Winnti using two different techniques when the link was clicked .		others others others others others others others threatActor_name others others others others others others others others others others
In the first technique, the user was directed to an HTML page which loaded a fake English resume .		others others others others others others others others others others others protocol others others others others others others others others
In the second technique, which we only observed a few times, the landing page directly downloaded a JAR file to the victim’s machine .		others others others others others others others others others others others others others others others others others others others malware malware others others others others others others others
Landing : In cases where the above resume is loaded, it is delivered as follows : Phishing Email Link}/?session={date}{ID} .		others others others others others others others others others others others others others others others others others attack_activity attack_activity attack_activity others others others others others others others others others others others
This page is an HTML file containing a simple iframe instruction to load real.html .		others others others others protocol others others others others function others others others malware others
real.html .		malware others
This is the HTML file containing the fake resIt contains a script which loads the BeEF hook script from a separate external host.		others others others protocol others others others others others others others others others others others tool tool others others others others others others others
The group’s infrastructure changes rapidly, occasionally allowing us to observe them modifying the hook page destination domain over the span of a few minutes.		others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Sometimes the same destination would be referred to by IP in one version of real .		others others others others others others others others others IP others others others others others others
html and by hostname in another.		others others others others others others others
Two additional files, resume_screen.css and mypic.jpg, are also loaded to make the resume look more realistic with improved formattingv .		others others others others sample_name others sample_name others others others others others others others others others others others others others others others
At this point, in cases where BeEF has been used, exploits are typically attempted on victim hosts with the help of BeEF modules.		others others others others others others others tool others others others others others others others others others others others others others others others tool tool others
A commonly used module was Jenkins_groovy_code_exec .		others others others others others sample_name others
Evasion Techniques : One of the Winnti group’s distinctive techniques is their particular style of DNS resolution for their C2 domains .		attack_activity attack_activity others others others others threatActor_name others others others others others others others others others others protocol others others others protocol others others
Choosing domain names which are similar to valid domains (for example, google-statics.com, a misspelling of Google statistics, instead of analytics.google.com), the group configures their DNS so that the root domain resolves to either nothing, or localhost (previous research has observed the root domain resolving to the valid domain it is imitating; we did not observe that in this campaign) .		others others others others others others others others others others others others others domain others others others others others others others others others domain others others others others others others protocol others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Then a subdomain resolves to an actual C2 server .		others others others others others others others others others others
For example, google-statics.com, one of the C2 domains observed in this campaign, has no resolutions at time of writing.		others others others domain others others others others others others others others others others others others others others others others others others others
css.google-statics.com, however, resolves to a real C2 IP .		tool others others others others others others others protocol protocol others
As observed in previous Winnti attacks, the group uses commonly accepted and poorly monitored protocols and ports for their C2 communication (ports 53, 80, 443) .		others others others others threatActor_name others others others others others others others others others others others others others others others tool tool others others others others others others others others others
With the addition of BeEF, the group has made use of TCP port 8000 as well .		others others others others tool others others others others others others others protocol others others others others others
Amusingly, the group's use of BeEF has been fairly rudimentary, not even taking advantage of the basic obfuscation features included in the program .		others others others others others others others tool others others others others others others others others others others others others others others others others others others others
We observed the group using GAGAHOOK instead of the default BEEFHOOK session name and BEEFSESSION session cookie name .		others others others others others tool others others others others tool others others others tool others others others others
As in previous Winnti campaigns, the group continues to use legitimate code signing certificates, stolen from online gaming organizations, to sign their malware .		others others others threatActor_name threatActor_name others others others others others others tool tool tool tool others others others target_crowd target_crowd target_crowd others others others others malware others
This technique can help to hide the malicious intent of the group’s code, allowing it to run in environments where execution is restricted to signed/trusted programs.		reference_word reference_word others others others others others others others others others others others others others others others others others others others others others others others others others others others others
While unconfirmed as of this writing, we believe the Winnti group is continuing to steal and use certificates from new organizations .		others others others others others others others others others others threatActor_name threatActor_name others others others others others others tool others others others others
Associated Indicators : Note : We are redacting the malware hashes while we work with the organization whose digital signature was used on the malware as a potential victim of the Winnti group .		others others others others others others others others others malware others others others others others others others others others others others others others others others others others others others others others threatActor_name threatActor_name others
job.yoyakuweb.technology ：resume.immigrantlol.com macos.exoticlol.com css.google-statics.com minami.cc vps2java.securitytactics.com 106.184.5.252 61.78.62.21 139.162.106.19 172.104.101.131 139.162.17.161 133.242.145.137 106.185.31.128 .		domain_evil others domain_evil domain_evil domain_evil domain_evil IP_evil IP_evil IP_evil IP_evil IP_evil IP_evil IP_evil others
Phishing email link destination : Phishing email link destination Likely phishing email link destination BeEF Landing and C2 Potential BeEF - Low confidence (Linode) Malware C2 Phishing email link destination Used in BeEF C2, reused Winnit Infra Linode - Used in BeEF C2 Linode - Malware C2 Linode - Used in BeEF C2 Linode - Used in BeEF C2 Linode - hosting BeEF landings .		attack_activity attack_activity attack_activity attack_activity others attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity others others attack_activity attack_activity others others others others attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity attack_activity others