Shedding Skin Turla’s Fresh Faces .		others others threatActor_name others others others others others
Release_Time :  2018-10-04 Report_URL :  https://securelist.com/shedding-skin-turlas-fresh-faces/88069/  Turla , also known as Venomous Bear , Waterbug , and Uroboros , may be best known for what was at the time an “ ultra complex ” snake rootkit focused on NATO-related targets , but their malware set and activity is much broader .		others others others others others others others others threatActor_name others others others others threatActor_aliases threatActor_aliases others threatActor_aliases others others threatActor_aliases others others others others others others others others others others others others others others others others malware malware others others others others others others others others others others others others others others others
Our current focus is on more recent and upcoming activity from this APT , which brings an interesting mix of old code , new code , and new speculations as to where they will strike next and what they will shed .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others others
Much of our 2018 research focused on Turla ’s KopiLuwak javascript backdoor , new variants of the Carbon framework and meterpreter delivery techniques .		others others others time others others others threatActor_name others others malware program_language malware others others others others others malware others others malware others others others
Also interesting was Mosquito ’s changing delivery techniques , customized PoshSec-Mod open-source powershell use , and borrowed injector code .		others others others malware others others others others others others malware malware malware tool others others others others others others others
We tied some of this activity together with infrastructure and data points from WhiteBear and Mosquito infrastructure and activity in 2017 and 2018 .		others others others others others others others others others others others others others malware others malware others others others others time others time others
For a first , our KopiLuwak research identified targets and delivery techniques , bringing more accuracy and reliability to the discussion .		others others others others others malware others others others others others others others others others others others others others others others others
Also interesting is a review of Turla scripting artefacts leading to newer efforts like KopiLuwak , tracing from older scripting in development efforts in WhiteAtlas and WhiteBear .		others others others others others others threatActor_name others others others others others others others malware others others others others others others others others others malware others malware others
And , we find 2018 KopiLuwak delivery techniques that unexpectedly matched Zebrocy spearphishing techniques for a first time as well .		others others others others time malware others others others others others malware attack_activity others others others others others others others others
Also highly interesting and unusual was the MiTM techniques delivering Mosquito backdoors .		others others others others others others others sub_activity others others malware malware others
In all likelihood , Turla delivered a physical presence of some sort within Wifi range of targets .		others others others others threatActor_name others others others others others others others others tool others others others others
Download sessions with Adobe ’s website were intercepted and injected to deliver Mosquito trojanized installers .		others others others company others others tool others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
This sort of hypothesis is supported by Mosquito installers ’ consistent wifi credential theft .		others others others others others others others malware others others others sample_function sample_function sample_function others
Meanwhile , injection and delivery techniques are undergoing changes in 2018 with reflective loaders and code enhancements .		others others others others others others others others others others others others others others others others others others
We expect to see more Mosquito activity into 2019 .		others others others others others malware others others time others
And finally , we discuss the Carbon framework , tying together the older , elegant , and functional codebase sometimes called “ Snake lite ” with ongoing efforts to selectively monitor high value targets .		others others others others others others malware others others others others others others others others others others others others others others others malware malware others others others others others others others others others others others
It appears that the backdoor is pushed with meterpreter now .		others others others others malware others others others malware others others
And , as we see code modifications and deployment in 2018 , we predict more development work on this matured codebase along with selective deployment to continue into 2019 .		others others others others others others others others others others time others others others others others others others others others others others others others others others others others time others
Essentially , we are discussing ongoing activity revolving around several malware families : KopiLuwak and IcedCoffeer , Carbon , Mosquito , WhiteBear .		others others others others others others others others others others others others others malware others malware others malware others malware others malware others
Since at least 2015 Turla has leveraged Javascript , powershell , and wsh in a number of ways , including in their malware dropper/installation operations as well as for implementing complete backdoors .		others others others time threatActor_name others others program_language others tool others others tool others others others others others others others others others others others others others others others others others others malware others
The White Atlas framework often utilized a small Javascript script to execute the malware dropper payload after it was decrypted by the VBA macro code , then to delete the dropper afterwards .		others malware malware others others others others others program_language tool others sample_function sample_function sample_function sample_function sample_function others others others others others others program_language tool tool others others others sub_activity sub_activity sub_activity sub_activity others
A much more advanced and highly obfuscated Javascript script was utilized in White Atlas samples that dropped a Firefox extension backdoor developed by Turla , but again the script was responsible for the simple tasks of writing out the extension.json configuration file for the extension and deleting itself for cleanup purposes .		others others others others others others others program_language tool others others others malware malware others others others others tool others malware others others threatActor_name others others others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others others sample_function sample_function sample_function sample_function sample_function others
Turla ’s first foray into full-fledged Javascript backdoors began with the usage of the IcedCoffee backdoor that we reported on in our private June 2016 “ Ice Turla ” report ( available to customers of Kaspersky APT Intelligence Services ) , which led later to their more fully functional and complex , recently deployed , KopiLuwak backdoor .		threatActor_name others others others others others others program_language malware others others others others others others malware malware others others others others others others others time time others sub_activity sub_activity others others others others others others others security_team tool tool tool others others others others md5 others others others others others others others others others others others malware malware others
IcedCoffee was initially dropped by exploit-laden RTF documents , then later by macro-enabled Office documents .		malware others others others others others tool tool others others others others others tool tool others
The macro code used to drop IcedCoffee was a slightly modified version of that found in White Atlas , which is consistent with the code sharing present in many Turla tools .		others tool tool others others others malware others others others others others others others others others malware malware others others others others others others others others others others others threatActor_name others others
A noteworthy change to the macro code was the addition of a simple web beacon that relayed basic information to Turla controlled servers upon execution of the macro , which not only helped profile the victim but also could be used to track the effectiveness of the attack .		others others others others others tool tool others others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others others sample_function sample_function sample_function others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others
IcedCoffee is a fairly basic backdoor which uses WMI to collect a variety of system and user information from the system , which is then encoded with base64 , encrypted with RC4 and submitted via HTTP POST to the C2 server .		malware others others others others malware others others tool others sample_function sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others others others others others others others others encryption_algo others others others encryption_algo others sub_activity sub_activity tool tool sub_activity sub_activity tool sub_activity others
IcedCoffee has no built-in command capability , instead it may receive javascript files from the C2 server , which are deobfuscated and executed in memory , leaving nothing behind on disk for forensic analysis .		malware others others others others others others others others others sub_activity program_language sub_activity sub_activity sub_activity tool sub_activity others others others sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
IcedCoffee was not widely deployed , rather it was targeted at diplomats , including Ambassadors , of European governments .		malware others others others others others others others others others others government others others government others others government government others
In November 2016 , Kaspersky Lab observed a new round of weaponized macro documents that dropped a new , heavily obfuscated Javascript payload that we named KopiLuwak ( one of the rarest and most expensive types of coffee in the world ) .		others time time others security_team security_team others others others others others tool tool tool others others others others others others others program_language others others others others malware others others others others others others others others others others others others others others others others
The targeting for this new malware was consistent with earlier Turla operations , focusing on European governments , but it was even more selectively deployed than IcedCoffee .		others others others reference_word reference_word reference_word others others others others threatActor_name others others others others government government others others others others others others others others others malware others
The KopiLuwak script is decoded by macro code very similar to that previously seen with IcedCoffee , but the resulting script is not the final step .		others malware others others others others tool tool others others others others others others others malware others others others others others others others others others others others
This script is executed with a parameter used as a key to RC4 decrypt an additional layer of javascript that contains the system information collection and command and control beaconing functionality .		reference_word reference_word others others others others others others others others others others encryption_algo sample_function sample_function sample_function sample_function sample_function program_language others others others sample_function sample_function sample_function others tool tool tool others others others
KopiLuwak performs a more comprehensive system and network reconnaissance collection , and like IcedCoffee leaves very little on disk for investigators to discover other than the base script .		malware others others others sub_activity sub_activity others sub_activity sub_activity sub_activity others others others malware others others others others others others others others others others others others others others others
Unlike IcedCoffee , KopiLuwak contains a basic set of command functionality , including the ability to run arbitrary system commands and uninstall itself .		others malware others malware others others others others others tool tool others others others others others sample_function sample_function sample_function sample_function others sample_function sample_function others
In mid-2017 a new version was discovered in which this command set had been further enhanced to include file download and data exfiltration capabilities .		others time others others others others others others others others others others others others others others others others sample_function sample_function others sample_function sample_function others others
The most recent evolution in the KopiLuwak life cycle was observed in mid-2018 when we observed a very small set of systems in Syria and Afghanistan being targeted with a new delivery vector .		others others others others others others malware others others others others others time others others others others others others others others others others location others location others others others others others others others others
In this campaign the KopiLuwak backdoor was encoded and delivered in a Windows shortcut ( .lnk ) file .		others others others others malware malware others others others others others others OS_name others others tool others others others
The lnk files were an especially interesting development because the powershell code they contain for decoding and dropping the payload is nearly identical to that utilized by the Zebrocy threat actor a month earlier .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others others others others others others
Carbon continues to be deployed against government and foreign affairs related organizations in Central Asia .		malware others others others others others government others government government government government others location location others
Carbon targeting in this region has shifted across a few countries since 2014 .		malware others others others others others others others others others others others time others
Here , we find a new orchestrator v3.8.2 and a new injected transport library v4.0.8 deployed to multiple systems .		others others others others others others tool string others others others others tool tool string others others others others others
And while we cannot identify a concrete delivery event for the dropper , its appearance coincides with the presence of meterpreter .		others others others others others others others others others others others others others others others others others others others others others malware others
This meterpreter reliance also coincides with wider Turla use of open source tools that we documented towards the end of 2017 and beginning of 2018 .		others malware others others others others others threatActor_name others others others others others others others others others others time time time others time time time others
The Epic Turla operation reported in 2014 involved highly selective Carbon delivery and was a long term global operation that affected hundreds of victims .		others attack_activity threatActor_name others others others time others others others malware others others others others others others others others others others others others others others
Only a small portion of these systems were upgraded to a malware set known as “ the Carbon framework ” , and even fewer received the Snake rootkit for “ extreme persistence ” .		others others others others others others others others others others others others others others others others malware malware malware others others others others others others others malware malware others others sample_function sample_function others others
So , Carbon is known to be a sophisticated codebase with a long history and very selective delivery , and coincides with Snake rootkit development and deployment .		others others malware others others others others others others others others others others others others others others others others others others others malware malware others others others others
In light of its age , it ’s interesting that this codebase is currently being modified , with additional variants deployed to targets in 2018 .		others others others others others others others others others others others others others others others others others others others others others others others others others time others
We expect Carbon framework code modifications and predict selective deployment of this matured codebase to continue into 2019 within Central Asia and related remote locations .		others others malware others others others others others others others others others others others others others others time others location location others others others others others
A complex module like this one must require some effort and investment , and while corresponding loader/injector and lateral movement malware moves to open source , this backdoor package and its infrastructure is likely not going to be replaced altogether in the short term .		others others others others others others others others others others others others others others others others others others others others others others others others others others others malware others others others others others others others others others others others others others others others others others
We introduced WhiteBear actionable data to our private customers early 2017 , and similar analysis to that report was publicly shared eight months later .		others others malware others others others others others others others time others others others others others others others others others others others others others others
Again , it was a cluster of activity that continued to grow past expectations .		others others others others others others others others others others others others others others others
It is interesting because WhiteBear shared known compromised infrastructure with KopiLuwak : soligro[.		others others others others malware others others others others others malware others others others others
]com .		others others others
WhiteBear scripted spearphish attachments also follows up on initial WhiteAtlas scripting development and deployment efforts .		malware others attack_activity others others others others others others malware others others others others others others
In March 2018 , our private report customers received actionable data on Mosquito ’s inclusion of fileless and customized Posh-SecMod metasploit components .		others time time others others others others others sub_activity sub_activity sub_activity sub_activity malware others others others others sub_activity others tool tool tool tool others
When discussion of the group ’s metasploit use was made public , their tactics began to change .		others others others others others others others tool others others others others others others others others others others others
The “ DllForUserFileLessInstaller ” injector module maintained a compilation date of November 22 , 2017 , and was starting to be used by Mosquito to inject ComRAT modules into memory around January 2018 .		others others malware others others others others others others others others time time time time others others others others others others others others malware others sub_activity sub_activity sub_activity sub_activity sub_activity others time time others
It is a small piece of metasploit injector code that accounts for issues with Wow64 .		others others others others others others tool others others others others others others others OS_name others
Also , related open source powershell registry loader code oddly was modified to avoid AES use , and opt for 3DES encryption instead .		others others others others others tool tool tool tool others others others others others encryption_algo others others others others others encryption_algo others others others
We expect to see more open-source based or inspired fileless components and memory loaders from Mosquito throughout 2018 .		others others others others others others others others others others others others others others others malware others time others
Perhaps this malware enhancement indicates that they are more interested in maintaining current access to victim organizations than developing offensive technologies .		others others others others others others others others others others others others others others others others others others others others others others
We delivered actionable data on Mosquito to our private intel customers in early 2017 .		others others others others others malware others others others others others others time time others
Our initial findings included data around an unusual and legitimate download URL for trojanized installers : http://admdownload.adobe.com/bin/live/flashplayer23ax_ra_install.exe .		others others others others others others others others others others others others others malware malware others url_evil url_evil url_evil others
While we could not identify the MiTM techniques with accuracy at the time , it is possible either WiFi MiTM or router compromise was used in relation to these incidents .		others others others others others others attack_activity others others others others others others others others others others others tool attack_activity others sub_activity sub_activity others others others others others others others others
It is unlikely , but possible , that ISP-level FinFisher MiTM was used , considering multiple remote locations across the globe were targeted .		others others others others others others others others tool tool tool others others others others others others others others others others others others others
But there is more incident data that should be elaborated on .		others others others others others others others others others others others others
In some cases , two “ .js ” files were written to disk and the infected system configured to run them at startup .		others others others others others others tool others others others others others others others others sample_function sample_function sample_function sample_function sample_function sample_function others others others
Their naming provides insight into the intention of this functionality , which is to keep the malware remotely updated via google application , and maintain local settings updates by loading and running “ 1.txt ” at every startup .		others others others others others others others others others others others others others others others others others sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
In a way , this staged script loading technique seems to be shared with the IcedCoffee javascript loading techniques observed in past Turla incidents focused on European government organizations .		others others others others others others others others others others others others others others others malware program_language tool tool others others others threatActor_name others others others government government government others
Updates are provided from the server-side , leading to fewer malware set findings : google_update_checker.js , local_update_checker.js .		others others others others others others others others others others others others others others sample_name others sample_name others
So , we should consider the wifi data collection that Mosquito Turla performed during these updates , as it hasn’t been documented publicly .		others others others others others others others others others others malware threatActor_name others others others others others others others others others others others others others others
One of the first steps that several Mosquito installer packages performed after writing and running this local_update js file was to export all local host ’s WiFi profiles ( settings and passwords ) to %APPDATA%\<profile>.xml with a command line call : cmd.exe /c netsh wlan export profile key=clear folder="%APPDATA%" .		others others others others others others others malware others others others others sample_function sample_function sample_function sample_function sample_function sample_function sample_function others others sample_function sample_function sample_function sample_function sample_function sample_function tool sample_function others others others others others others string string string string string string string string others others others others others others string string string string string string string string others string string string others string
They then gather more network information with a call to ipconfig and arp -a .		others others sub_activity sub_activity sub_activity sub_activity others others others others string others string string others
Maintaining ongoing host-based collection of wifi credentials for target networks makes it far easier to possess ongoing access to wifi networks for spoofing and MiTM , as brute-forcing or otherwise cracking weakly secured WiFi networks becomes unnecessary .		sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others others others others others others sub_activity others attack_activity others others others others others others others others tool others others others others
Perhaps this particular method of location-dependent intrusion and access is on the decline for Mosquito Turla , as we haven’t identified new URLs delivering trojanized code .		others others others others others others others others others others others others others others malware threatActor_name others others others others others others others others others others others others others
It ’s very interesting to see ongoing targeting overlap , or the lack of overlap , with other APT activity .		others others others others others others others others others others others others others others others others others others others others others others
Noting that Turla was absent from the milestone DNC hack event where Sofacy and CozyDuke were both present , but Turla was quietly active around the globe on other projects , provides some insight as to ongoing motivations and ambitions of this group .		others others threatActor_name others others others others others sub_activity sub_activity others others threatActor_name others threatActor_name others others others others others threatActor_name others others others others others others others others others others others others others others others others others others others others others others others
It is interesting that data related to these organizations has not been weaponized and found online while this Turla activity quietly carries on .		others others others others others others others others others others others others others others others others others others threatActor_name others others others others others
Both Turla ’s Mosquito and Carbon projects focus mainly on diplomatic and foreign affairs targets .		others threatActor_name others others malware others malware others others others others industry others industry industry others others
While WhiteAtlas and WhiteBear activity stretched across the globe to include foreign affairs related organizations , not all targeting consistently followed this profile .		others malware others malware others others others others others others others industry industry others others others others others others others others others others others
Scientific and technical centers were also targeted , and organizations outside of the political arena came under focus as well .		industry others industry others others others others others others others others others others others others others others others others others others
Turla ’s KopiLuwak activity does not necessarily focus on diplomatic/foreign affairs , and also winds down a different path .		threatActor_name others others malware sub_activity others others others others others others industry others others others others others others others others others
Instead , 2018 activity targeted government related scientific and energy research organizations , and a government related communications organization in Afghanistan .		others others time others others others others industry others industry industry others others others others others others industry others others location others
This highly selective but wider targeting set most likely will continue into 2019 .		others others others others others others others others others others others others time others
From the targeting perspective , we see closer ties between the KopiLuwak and WhiteBear activity , and closer alignments between Mosquito and Carbon activity .		others others others others others others others others others others others malware others malware others others others others others others malware others malware others others
And WhiteBear and KopiLuwak shared infrastructure while deploying unusual .js scripting .		others others others malware others others others others others tool others others
Perhaps open source offensive malware will become much more present in Mosquito and Carbon attacks as we see more meterpreter and injector code , and more uniquely innovative complex malware will continue to be distributed with KopiLuwak and a possible return of WhiteBear .		others others others others others others others others others others others malware others malware others others others others others malware others others others others others others others others others others others others others others others others malware others others others others others malware others
And as we see with borrowed techniques from the previous zebrocy spearphishing , techniques are sometimes passed around and duplicated .		others others others others others others others others others others malware attack_activity others others others others others others others others others