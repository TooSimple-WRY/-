Lazarus on the hunt for big game Release_Time : 2020-07-28 .		threatActor_name others others others others others others others others others others
Report_URL : https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/ .		others others others others others others
Criminals piggyback on widespread botnet infections ( for instance , the infamous Emotet and Trickbot malware families ) to spread into the network of promising victims and license ransomware “ products ” from third-party developers .		person others others others malware others others others others others others others malware others malware others others others others others others others others others others person others others malware others others others others person person others
When the attackers have a good understanding of the target ’s finances and IT processes , they deploy the ransomware on all the company ’s assets and enter the negotiation phase .		others others person others others others others others others others others others sub_activity others sub_activity sub_activity others others others others malware others others others others others others others others others others others others others
This ecosystem operates in independent , highly specialized clusters , which in most cases have no links to each other beyond their business ties .		others others others others others others others others others others others others others others others others others others others others others others others others others
This is why the concept of threat actors gets fuzzy : the group responsible for the initial breach is unlikely to be the party that compromised the victim ’s Active Directory server , which in turn is not the one that wrote the actual ransomware code used during the incident .		others others others others others others person person others others others others others others others others others others others others others others others others others others others person others others tool tool others others others others others others others others others others others others others malware others others others others others others
What ’s more , over the course of two incidents , the same criminals may switch business partners and could be leveraging different botnet and/or ransomware families altogether .		others others others others others others others others others others others others others others person others others others person others others others others others malware others malware others others others
But of course , no complex ecosystem could ever be described by a single , rigid set of rules and this one is no exception .		others others others others others others others others others others others others others others others others others others others others others others others others others others
In this blog post , we describe one of these outliers over two separate investigations that occurred between March and May 2020 .		others others others others others others others others others others others others others others others others others others time others time time others
This first incident occurred in Europe and caught our attention for two reasons : it features a ransomware family we were unaware of , and involved a spreading technique reminiscent of APT groups ( see the “ spreading utility ” details below ) .		others others others others others location others others others others others others others others others others others malware others others others others others others others others others others others others others threatActor_name threatActor_name others others others others others others others others others others others
The ransomware itself is nothing special : it ’s written in C++ and crawls all connected disks to encrypt files and delete any folder called “ System Volume Information ” ( which are linked to Windows ’ restore point feature ) .		others malware others others others others others others others others others others program_language others others others others others others others others others others others others others others others others others others others others others others others OS_name others others others others others others
The program also stops processes that could be locking important files , such as Microsoft Exchange and SQL Server .		reference_word reference_word others others others others others others others others others others others others tool tool others tool tool others
Files are encrypted with a combination of AES-256 in ECB mode and RSA-2048 .		others others others others others others others encryption_algo others encryption_algo others others encryption_algo others
In our initial report published at the time we noted two peculiarities with this program ’s implementation :  The ransomware uses Mersenne Twister as a source of randomness , but unfortunately for the victims the RNG is reseeded every time new data is consumed .		others others others others others others others others others others others others others others others others others others others others malware others tool tool others others others others others others others others others others others others tool others others others others others others others others others
Still , this is unorthodox cryptography , as is the decision to use the “ electronic codebook ” ( ECB ) mode for the AES algorithm .		others others others others others others others others others others others others others others others encryption_algo encryption_algo others others encryption_algo others others others others encryption_algo others others
The combination of ECB and AES is not semantically secure , which means the patterns of the original clear data are preserved upon encryption .		others others others encryption_algo others encryption_algo others others others others others others others others others others others others others others others others others others others
This was reiterated by cybersecurity researchers who analyzed Zoom security in April 2020 .		others others others others person person others others company others others time time others
VHD implements a mechanism to resume operations if the encryption process is interrupted .		string others others others others others others others others others others others others others
For files larger than 16MB , the ransomware stores the current cryptographic materials on the hard drive , in clear text .		others others others others others others others malware others others others others others others others others others others others others others others
This information is not deleted securely afterwards , which implies there may be a chance to recover some of the files .		others others others others others others others others others others others others others others others others others others others others others others
The Mersenne Twister RNG is reseeded every time it is called .		others tool tool tool others others others others others others others others
To the best of our knowledge , this malware family was first discussed publicly in this blog post .		others others others others others others others others others others others others others others others others others others others
A spreading utility , discovered along the ransomware , propagated the program inside the network .		others others others others others others others malware others others others others others others others others
It contained a list of administrative credentials and IP addresses specific to the victim , and leveraged them to brute-force the SMB service on every discovered machine .		reference_word others others others others sub_activity sub_activity others sub_activity sub_activity others others others person others others others reference_word others others others protocol sub_activity others others others others others
Whenever a successful connection was made , a network share was mounted , and the VHD ransomware was copied and executed through WMI calls .		others others others others others others others others others others others others others others others malware malware others others others others others tool others others
This stood out to us as an uncharacteristic technique for cybercrime groups ; instead , it reminded us of the APT campaigns Sony SPE , Shamoon and OlympicDestroyer , three previous wipers with worming capabilities .		others others others others others others others others others others person person others others others reference_word others others others others threatActor_name others company company others malware others malware others others others others others others others others
We were left with more questions than answers .		others others others others others others others others others
We felt that this attack did not fit the usual modus operandi of known big-game hunting groups .		others others others others others others others others others others others others others others others others others others
In addition , we were only able to find a very limited number of VHD ransomware samples in our telemetry , and a few public references .		others others others others others others others others others others others others others others malware malware others others others others others others others others others others others
This indicated that this ransomware family might not be traded widely on dark market forums , as would usually be the case .		others others others others malware others others others others others others others others others others others others others others others others others others
A second incident , two months later , was handled by Kaspersky ’s Incident Response team ( GERT ) .		others others others others time time time others others others others security_team security_team security_team security_team security_team security_team others security_team others others
That meant we were able to get a complete picture of the infection chain leading to the installation of the VHD ransomware .		others others others others others others others others others others others others others others others others others others others others string malware others
In this instance , we believe initial access was achieved through opportunistic exploitation of a vulnerable VPN gateway .		others others others others others others others others others others others others others others others others tool others others
After that , the attackers obtained administrative privileges , deployed a backdoor on the compromised system and were able to take over the Active Directory server .		others others others others person others others others others others others malware others others others others others others others others others others others tool tool tool others
They then deployed the VHD ransomware to all the machines in the network .		reference_word others others others malware malware others others others others others others others others
In this instance , there was no spreading utility , but the ransomware was staged through a downloader written in Python that we still believe to be in development .		others others others others others others others others others others others others malware others others others others others others others program_language others others others others others others others others others
The whole infection took place over the course of 10 hours .		others others others others others others others others others time time others
A more relevant piece of information is that the backdoor used during this incident is an instance of a multiplatform framework we call MATA ( some vendors also call it Dacls ) .		others others others others others others others others others malware others others others others others others others others others others others others others malware others others others others others others malware others others
On July 22 , we published a blog article dedicated to this framework .		time time time others others others others sub_activity sub_activity others others others others others
In it , we provide an in-depth description of its capabilities and provide evidence of its links to the Lazarus group .		others reference_word others others others others others others others reference_word others others others others others reference_word others others others threatActor_name others others
Other members of the industry independently reached similar conclusions .		others others others others others others others others others others
The forensics evidence gathered during the incident response process is strong enough that we feel comfortable stating with a high degree of confidence that there was only a single threat actor in the victim ’s network during the time of the incident .		others others others others others others others others others others others others others others others others others others others others others others others others others others others others others person person others others person others others others others others others others others others others
The data we have at our disposal tends to indicate that the VHD ransomware is not a commercial off-the-shelf product ; and as far as we know , the Lazarus group is the sole owner of the MATA framework .		others others others others others others others others others others others others malware malware others others others others others others others others others others others others others others others threatActor_name others others others others others others others malware others others
Hence , we conclude that the VHD ransomware is also owned and operated by Lazarus .		others others others others others others malware malware others others others others others others threatActor_name others
Circling back to our introduction , this observation is at odds with what we know about the cybercrime ecosystem .		others others others others others others others others others others others others others others others others others others others others
Lazarus has always existed at a special crossroads between APT and financial crime , and there have long been rumors in the threat intelligence community that the group was a client of various botnet services .		threatActor_name others others others others others others others others threatActor_name others sub_activity sub_activity others others others others others others others others others others others others others others others others others others others others malware others others
We can only speculate about the reason why they are now running solo ops : maybe they find it difficult to interact with the cybercrime underworld , or maybe they felt they could no longer afford to share their profits with third parties .		others others others others others others others others reference_word others others others others others others others others others others others others others others others others others others others others others others reference_word others others others others others others others others others others others others
It ’s obvious the group cannot match the efficiency of other cybercrime gangs with their hit-and-run approach to targeted ransomware .		others others others others reference_word reference_word others others others others others others others others others others others others others others others others others
Could they really set an adequate ransom price for their victim during the 10 hours it took to deploy the ransomware?		others others others others others others others others others others others others others time time others others others others others malware others
Were they even able to figure out where the backups were located?		others others others others others others others others others others others others others
In the end , the only thing that matters is whether these operations turned a profit for Lazarus .		others others others others others others others others others others others others others others others others others threatActor_name others
Only time will tell whether they jump into hunting big game full time , or scrap it as a failed experiment .		others others others others others others others others others others others others others others others others others others others others others others
The spreader utility contains a list of administrative credentials and IP addresses specific to the victim , which is why it ’s not listed in the IoC section .		others sub_activity sub_activity others others others others sub_activity sub_activity others protocol sub_activity others others others person others others others others others others others others others others others string others others
As the instance of the MATA framework was extracted from memory , no relevant hashes can be provided for it in the IoC section .		others others others others others malware others others others others others others others others others others others others others others others others string others others
VHD ransomware : 6D12547772B57A6DA2B25D2188451983 .		malware malware others sha1 others
VHD ransomware : D0806C9D8BCEA0BD47D80FA004744D7D .		malware malware others sha1 others
VHD ransomware : DD00A8610BB84B54E99AE8099DB1FC20 .		malware malware others sha1 others
VHD ransomware : CCC6026ACF7EADADA9ADACCAB70CA4D6 .		malware malware others sha1 others
VHD ransomware : EFD4A87E7C5DCBB64B7313A13B4B1012 .		malware malware others sha1 others
Domains and IPs 172.93.184.62 MATA C2 .		others others others IP_evil malware tool others
23.227.199.69 MATA C2 .		IP_evil malware tool others
104.232.71.7 MATA C2 .		IP_evil malware tool others
mnmski.cafe24.com : Staging endpoint for the ransomware ( personal web space hosted at a legit web service and used as a redirection to another compromised legit website ) .		domain_evil others others others others others malware others others others others others others others others others others others others others others others others others others others others others others